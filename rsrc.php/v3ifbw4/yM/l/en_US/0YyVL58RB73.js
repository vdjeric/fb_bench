if (self.CavalryLogger) { CavalryLogger.start_js(["7YXxw"]); }

__d('ReactComposerFormattedTextActionType',['keyMirrorRecursive'],(function a(b,c,d,e,f,g){'use strict';f.exports=c('keyMirrorRecursive')({SET_SELECTED_INDEX:null,SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX:null,SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING:null,SET_SHOULD_FADE_IN_PICKER:null},'ReactComposerFormattedTextActionType');}),null);
__d('ReactComposerFormattedTextStore',['ReactComposerFormattedTextActionType','ReactComposerStoreBase'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ReactComposerStoreBase'));i=h&&h.prototype;function j(){i.constructor.call(this,function(){return {selectedIndex:-1,prevSelectedIndex:-1,shouldAutoOpenWhenUserStartsTyping:false,shouldFadeInPicker:false};},function(k){switch(k.type){case c('ReactComposerFormattedTextActionType').SET_SELECTED_INDEX:this&&this.$ReactComposerFormattedTextStore1(k);break;case c('ReactComposerFormattedTextActionType').SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX:this&&this.$ReactComposerFormattedTextStore2(k);break;case c('ReactComposerFormattedTextActionType').SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING:this&&this.$ReactComposerFormattedTextStore3(k);break;case c('ReactComposerFormattedTextActionType').SET_SHOULD_FADE_IN_PICKER:this&&this.$ReactComposerFormattedTextStore4(k);break;}}.bind(this));}j.prototype.getTextFormatPresetID=function(k){return this.getComposerData(k).textFormatPresetID;};j.prototype.getSelectedIndex=function(k){return this.getComposerData(k).selectedIndex;};j.prototype.getPrevSelectedIndex=function(k){return this.getComposerData(k).prevSelectedIndex;};j.prototype.getShouldAutoOpenWhenUserStartsTyping=function(k){return this.getComposerData(k).shouldAutoOpenWhenUserStartsTyping;};j.prototype.getShouldFadeInPicker=function(k){return this.getComposerData(k).shouldFadeInPicker;};j.prototype.$ReactComposerFormattedTextStore1=function(k){var l=this.validateAction(k,['composerID','selectedIndex','textFormats']),m=l[0],n=l[1],o=l[2],p=this.getComposerData(m);p.textFormatPresetID=this.$ReactComposerFormattedTextStore5(n,o);p.selectedIndex=n;p.prevSelectedIndex=n;this.emitChange(m);};j.prototype.$ReactComposerFormattedTextStore2=function(k){var l=this.validateAction(k,['composerID','selectedIndex','textFormats']),m=l[0],n=l[1],o=l[2],p=this.getComposerData(m);p.textFormatPresetID=this.$ReactComposerFormattedTextStore5(n,o);p.selectedIndex=n;this.emitChange(m);};j.prototype.$ReactComposerFormattedTextStore3=function(k){var l=this.validateAction(k,['composerID','shouldAutoOpenWhenUserStartsTyping']),m=l[0],n=l[1],o=this.getComposerData(m);o.shouldAutoOpenWhenUserStartsTyping=n;this.emitChange(m);};j.prototype.$ReactComposerFormattedTextStore4=function(k){var l=this.validateAction(k,['composerID','shouldFadeInPicker']),m=l[0],n=l[1],o=this.getComposerData(m);o.shouldFadeInPicker=n;this.emitChange(m);};j.prototype.$ReactComposerFormattedTextStore5=function(k,l){var m=null;if(k!=null&&k!==-1){var n=l&&Object.prototype.hasOwnProperty.call(l,k)?l[k]:null;if(n&&n.presetID)m=n.presetID;}return m;};f.exports=new j();}),null);
__d('ReactComposerFormattedTextActions',['ReactComposerDispatcher','ReactComposerFormattedTextActionType','ReactComposerFormattedTextStore'],(function a(b,c,d,e,f,g){'use strict';c('ReactComposerFormattedTextStore');h.prototype.setSelectedIndex=function(i,j,k){c('ReactComposerDispatcher').dispatch({composerID:i,type:c('ReactComposerFormattedTextActionType').SET_SELECTED_INDEX,selectedIndex:j,textFormats:k});};h.prototype.setSelectedIndexButNotPrevSelectedIndex=function(i,j,k){c('ReactComposerDispatcher').dispatch({composerID:i,type:c('ReactComposerFormattedTextActionType').SET_SELECTED_INDEX_BUT_NOT_PREV_SELECTED_INDEX,selectedIndex:j,textFormats:k});};h.prototype.setShouldAutoOpenWhenUserStartsTyping=function(i,j){c('ReactComposerDispatcher').dispatch({composerID:i,type:c('ReactComposerFormattedTextActionType').SET_SHOULD_AUTO_OPEN_WHEN_USER_STARTS_TYPING,shouldAutoOpenWhenUserStartsTyping:j});};h.prototype.setShouldFadeInPicker=function(i,j){c('ReactComposerDispatcher').dispatch({composerID:i,type:c('ReactComposerFormattedTextActionType').SET_SHOULD_FADE_IN_PICKER,shouldFadeInPicker:j});};function h(){}f.exports=new h();}),null);
__d('ReactComposerFormattedTextPickerComponent.react',['cx','Grid.react','Link.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('Grid.react').GridItem,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.$ReactComposerFormattedTextPickerComponent1=function(n){this.props.onSelect&&this.props.onSelect(n);};m.prototype.$ReactComposerFormattedTextPickerComponent2=function(){var n=[];for(var o=m.NO_BG_COLOR;o<this.props.textFormats.length;o++){var p=c('React').createElement(k,{key:o},c('React').createElement('div',{className:o===this.props.selected?"_9sg":''},c('React').createElement(c('Link.react'),{href:'#',onClick:o===this.props.selected?null:this.$ReactComposerFormattedTextPickerComponent1.bind(this,o)},c('React').createElement('div',{className:"_23jq"+(this.props.shouldUseNewComposerPickerDesign?' '+"_3oi9":'')+(o===this.props.selected?' '+"_23jt":'')+(o===m.NO_BG_COLOR?' '+"_23ju":''),style:o===m.NO_BG_COLOR?null:this.props.textFormats[o].pickerCircleStyle}))));n.push(p);}return n;};m.prototype.render=function(){var n=this.$ReactComposerFormattedTextPickerComponent2();return (c('React').createElement(c('Grid.react'),{cols:n.length,role:'presentation',className:"_23jv"+(this.props.suppressTransition?' '+"_3oia":'')+(this.props.shouldUseNewComposerPickerDesign?' '+"_3oi9":'')+(this.props.hidden?' '+"_akr":'')},n));};function m(){i.apply(this,arguments);}m.NO_BG_COLOR=-1;m.propTypes={hidden:l.bool,onSelect:l.func.isRequired,selected:l.number,suppressTransition:l.bool,textFormats:l.arrayOf(l.object).isRequired,shouldUseNewComposerPickerDesign:l.bool};f.exports=m;}),null);
__d("XStickyFormattedTextController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/sticky_formatted_text\/",{preset_id:{type:"Int"},is_set:{type:"Bool",defaultValue:false}});}),null);
__d('ReactComposerFormattedTextPickerContainerMixin',['invariant','ReactComposerAttachmentStore','ReactComposerEvents','ReactComposerFormattedTextActions','ReactComposerFormattedTextStore','ReactComposerFormattedTextPickerComponent.react','ReactComposerMediaUploadStore','ReactComposerMinutiaeAttachmentStore','ReactComposerPrefillStore','ReactComposerPropsAndStoreBasedStateMixin','ReactComposerScrapedAttachmentStore','ReactComposerStatusStore','ReactComposerTaggerActions','ReactComposerTaggerStore','Arbiter','AsyncRequest','XStickyFormattedTextController','bind'],(function a(b,c,d,e,f,g,h){'use strict';var i=true,j={_prefillSubscription:undefined,mixins:[c('ReactComposerPropsAndStoreBasedStateMixin')(c('ReactComposerTaggerStore'),c('ReactComposerMediaUploadStore'),c('ReactComposerScrapedAttachmentStore'),c('ReactComposerFormattedTextStore'),c('ReactComposerMinutiaeAttachmentStore'),c('ReactComposerAttachmentStore'),c('ReactComposerStatusStore'))],statics:{beforeCalculateInitialState:function k(l,m){if(i){c('ReactComposerFormattedTextActions').setSelectedIndex(l,m.defaultFormat!=null?m.defaultFormat:c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR,m.textFormats);if(m.shouldAutoOpenWhenUserStartsTyping)c('ReactComposerFormattedTextActions').setShouldAutoOpenWhenUserStartsTyping(l,m.shouldAutoOpenWhenUserStartsTyping);}if(m.stickyStylesEnabled&&!i){var n=c('XStickyFormattedTextController').getURIBuilder().setBool('is_set',false).getURI();new (c('AsyncRequest'))().setURI(n).setHandler(c('bind')(this,function(o){if(o&&o.payload&&o.payload.index!=null){var p=o.payload.index;if(p===c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR&&!o.payload.hasUserUnformattedText)p=m.defaultFormat!=null?m.defaultFormat:c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR;c('ReactComposerFormattedTextActions').setSelectedIndex(l,p,m.textFormats);}})).send();}},calculateState:function k(l,m){var n=c('ReactComposerStatusStore').getMessageText(l).match(/\n/g),o=n?n.length>m.maxNewlines:false,p=true;if(c('ReactComposerScrapedAttachmentStore').hasAttachment(l)||c('ReactComposerMediaUploadStore').getUploadsCount(l)!==0||c('ReactComposerTaggerStore').hasExplicitLocation(l)||c('ReactComposerMinutiaeAttachmentStore').getMarkup(l)!=null||c('ReactComposerStatusStore').getTextLength(l)>m.textLengthLimit||o)p=false;var q=c('ReactComposerTaggerStore').getSelectedTagger(l)===this.taggerID;return {isSelected:q,canUseFormattedText:p,shouldDisplay:q&&p,autoFocus:c('ReactComposerTaggerStore').getAutoFocusOnSelectedTagger(l),taggerData:c('ReactComposerTaggerStore').getTaggerData(l,this.taggerID),taggerSource:c('ReactComposerTaggerStore').getTaggerSource(l,this.taggerID),selectedIndex:c('ReactComposerFormattedTextStore').getSelectedIndex(l),prevSelectedIndex:c('ReactComposerFormattedTextStore').getPrevSelectedIndex(l),shouldAutoOpenWhenUserStartsTyping:c('ReactComposerFormattedTextStore').getShouldAutoOpenWhenUserStartsTyping(l),fadingInPicker:c('ReactComposerFormattedTextStore').getShouldFadeInPicker(l)};}},handleSaveStickyPreset:function k(l){if(!this.props.stickyStylesEnabled)return;var m=c('XStickyFormattedTextController').getURIBuilder().setInt('preset_id',l===c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR?0:c('ReactComposerFormattedTextStore').getTextFormatPresetID(this.context.composerID)).setBool('is_set',true).getURI();new (c('AsyncRequest'))().setMethod('POST').setURI(m).send();},componentWillMount:function k(){this._prefillSubscription=c('Arbiter').subscribe(c('ReactComposerEvents').SET_PREFILL_DATA+this.context.composerID,this._handlePrefill);this.constructor.taggerID||h(0);},componentDidMount:function k(){if(i){if(this.props.autoOpen)setTimeout(function(){c('ReactComposerFormattedTextActions').setShouldFadeInPicker(this.context.composerID,true);c('ReactComposerTaggerActions').selectTagger(this.context.composerID,this.constructor.loggingName,this.constructor.taggerID);}.bind(this),0);i=false;}},componentWillUnmount:function k(){this._prefillSubscription&&this._prefillSubscription.unsubscribe();this._prefillSubscription=null;},_handlePrefill:function k(){var l=c('ReactComposerPrefillStore').getAndEraseNestedField(this.context.composerID,['taggersData',this.constructor.taggerID]);if(l)c('ReactComposerTaggerActions').setTaggerDataWithoutLogging(this.context.composerID,this.constructor.taggerID,l);}};f.exports=j;}),null);
__d('ReactComposerFormattedTextPickerButton.react',['cx','fbt','ReactComposerLoggingName','ReactComposerTaggerButtonMixin','ReactComposerTaggerType','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').createClass({displayName:'ReactComposerFormattedTextPickerButton',mixins:[c('ReactComposerTaggerButtonMixin')],statics:{taggerID:c('ReactComposerTaggerType').FORMATTED_TEXT,loggingName:c('ReactComposerLoggingName').FORMATTED_TEXT_BUTTON},getTitle:function k(){return i._("Add a background color to your post");},getTooltip:function k(){return i._("Add a background color to your post");},getClassName:function k(){return "_cod";}});f.exports=j;}),null);
__d('ReactComposerFormattedTextPickerContainer.react',['cx','csx','ReactComposerEvents','ReactComposerFormattedTextPickerComponent.react','ReactComposerFormattedTextPickerContainerMixin','ReactComposerLoggingName','ReactComposerTaggerActions','ReactComposerTaggerType','ReactComposerFormattedTextActions','Arbiter','CSS','DOM','DOMQuery','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').PropTypes,k=c('React').createClass({displayName:'ReactComposerFormattedTextPickerContainer',_suppressTransition:false,mixins:[c('ReactComposerFormattedTextPickerContainerMixin')],propTypes:{textFormats:j.arrayOf(j.object).isRequired,defaultFormat:j.number,textLengthLimit:j.number,autoOpen:j.bool,maxNewlines:j.number,stickyStylesEnabled:j.bool,shouldUseNewComposerPickerDesign:j.bool},statics:{taggerID:c('ReactComposerTaggerType').FORMATTED_TEXT,loggingName:c('ReactComposerLoggingName').FORMATTED_TEXT_TAGGER},render:function l(){this._updateBackground(this.state.selectedIndex);if(!this.state.shouldDisplay)return null;return c('React').createElement(c('ReactComposerFormattedTextPickerComponent.react'),{textFormats:this.props.textFormats,onSelect:this._onSelect,selected:this.state.selectedIndex,hidden:this.state.fadingInPicker,suppressTransition:this._suppressTransition,shouldUseNewComposerPickerDesign:this.props.shouldUseNewComposerPickerDesign});},componentWillMount:function l(){if(!this.state.canUseFormattedText){c('ReactComposerTaggerActions').setShouldHideTaggerButton(this.context.composerID,c('ReactComposerTaggerType').FORMATTED_TEXT,true);}else c('ReactComposerTaggerActions').setShouldHideTaggerButton(this.context.composerID,c('ReactComposerTaggerType').FORMATTED_TEXT,false);},componentWillUpdate:function l(m,n){if(this.props.shouldUseNewComposerPickerDesign&&this.state.selectedIndex!==n.selectedIndex&&(this.state.selectedIndex===c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR||n.selectedIndex===c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR))this._suppressTransition=true;},componentDidUpdate:function l(m,n){if(!n.isSelected&&this.state.isSelected){c('Arbiter').inform(c('ReactComposerEvents').ACTIVATE_ATTACHMENT+this.context.composerID);if(this.props.shouldUseNewComposerPickerDesign){var o=this.state.selectedIndex!==c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR;this._onPickerOpened(o);}}else if(n.isSelected&&!this.state.isSelected){this._onPickerClosed();}else if(!n.canUseFormattedText&&this.state.canUseFormattedText){c('ReactComposerTaggerActions').setShouldHideTaggerButton(this.context.composerID,c('ReactComposerTaggerType').FORMATTED_TEXT,false);if(this.state.prevSelectedIndex!=null)c('ReactComposerFormattedTextActions').setSelectedIndex(this.context.composerID,this.state.prevSelectedIndex,this.props.textFormats);}else if(n.canUseFormattedText&&!this.state.canUseFormattedText){c('ReactComposerTaggerActions').setShouldHideTaggerButton(this.context.composerID,c('ReactComposerTaggerType').FORMATTED_TEXT,true);var p=this.state.selectedIndex!==c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR;if(p)c('ReactComposerFormattedTextActions').setSelectedIndexButNotPrevSelectedIndex(this.context.composerID,c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR,this.props.textFormats);}if(n.selectedIndex!==this.state.selectedIndex){var q=this.state.selectedIndex!==c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR;if(this.props.shouldUseNewComposerPickerDesign)this._setShouldHideTaggersDiv(q);c('ReactComposerTaggerActions').setTaggerData(this.context.composerID,this.constructor.loggingName,c('ReactComposerTaggerType').FORMATTED_TEXT,{formatActive:q});}if(n.shouldAutoOpenWhenUserStartsTyping&&this.state.shouldDisplay)c('ReactComposerFormattedTextActions').setShouldAutoOpenWhenUserStartsTyping(this.context.composerID,false);if(this.state.fadingInPicker&&this.state.shouldDisplay)c('ReactComposerFormattedTextActions').setShouldFadeInPicker(this.context.composerID,false);},_onPickerOpened:function l(m){var n=this._getComposerRoot();if(n)c('CSS').removeClass(n,"_10m_");this._setShouldHideTaggersDiv(m);},_onPickerClosed:function l(){var m=this._getComposerRoot();if(m)c('CSS').addClass(m,"_10m_");this._setShouldHideTaggersDiv(false);},_setShouldHideTaggersDiv:function l(m){var n=this._getComposerTaggerDiv();if(!n)return;if(m){c('CSS').addClass(n,"_10n0");}else c('CSS').removeClass(n,"_10n0");},_getComposerTaggerDiv:function l(){var m=c('DOMQuery').scry(c('DOM').getRootElement(),"._1idc");if(!m||m.length===0)return null;return m[m.length-1];},_getComposerRoot:function l(){var m=c('DOMQuery').scry(c('DOM').getRootElement(),"._36bx");if(!m||m.length===0)return null;return m[m.length-1];},_updateBackground:function l(m){var n=c('DOMQuery').scry(c('DOM').getRootElement(),"._36bx");if(!n||n.length===0)return;var o=n[n.length-1],p=c('DOMQuery').scry(o,"._i-o");if(!p||p.length===0)return;var q=p[p.length-1],r=this._getStyles(m);c('DOM').setAttributes(q,{style:r.bodyStyle});c('CSS').addClass(q,"_4xe1");if(m!==c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR){c('CSS').addClass(o,"_5zno");c('CSS').addClass(o,"_1mjk");c('CSS').addClass(q,"_2ihx");}else{c('CSS').removeClass(o,"_5zno");c('CSS').removeClass(o,"_1mjk");c('CSS').removeClass(q,"_2ihx");}var s=c('DOMQuery').scry(c('DOM').getRootElement(),"._395");if(!s||s.length===0)return;s=s[s.length-1];c('DOM').setAttributes(s,{style:r.textInputStyle});},_onSelect:function l(m){if(this.state.canUseFormattedText){c('ReactComposerFormattedTextActions').setSelectedIndex(this.context.composerID,m,this.props.textFormats);this.handleSaveStickyPreset(m);c('Arbiter').inform(c('ReactComposerEvents').ACTIVATE_ATTACHMENT+this.context.composerID);}},_getStyles:function l(m){var n='',o='';if(m!=null&&m!==c('ReactComposerFormattedTextPickerComponent.react').NO_BG_COLOR){var p=this.props.textFormats&&Object.prototype.hasOwnProperty.call(this.props.textFormats,m)?this.props.textFormats[m]:null;if(p&&p.bodyStyle&&p.textInputStyle){n=p.bodyStyle;o=p.textInputStyle;}}return {bodyStyle:n,textInputStyle:o};}});f.exports=k;}),null);
__d('ReactComposerFormattedTextSproutContainer.react',['ReactComposerSproutsDefaultUIConfig','ReactComposerSproutType','ReactComposerSproutUIConfig','ReactComposerTaggerSproutContainer.react','ReactComposerTaggerType','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').PureComponent);i=h&&h.prototype;j.prototype.render=function(){return (c('React').createElement(c('ReactComposerTaggerSproutContainer.react'),{uiConfig:this.props.uiConfig,taggerID:c('ReactComposerTaggerType').FORMATTED_TEXT}));};function j(){h.apply(this,arguments);}j.propTypes={uiConfig:c('ReactComposerSproutUIConfig')};j.defaultProps={uiConfig:c('ReactComposerSproutsDefaultUIConfig')[c('ReactComposerSproutType').FORMATTED_TEXT]};f.exports=j;}),null);