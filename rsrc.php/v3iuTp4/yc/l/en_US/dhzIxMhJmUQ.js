if (self.CavalryLogger) { CavalryLogger.start_js(["mSMV9"]); }

__d('DOMP2PTrigger',['cx','MessengerEnvironment','JSXDOM','P2PAmountUtils','P2PTriggersUtils','TransformTextToDOMMixin'],(function a(b,c,d,e,f,g,h){var i={MAX_ITEMS:40,match:function j(k){var l=c('P2PTriggersUtils').getMatches(k);if(!l||!l.length)return false;var m=l[0];if(!c('P2PAmountUtils').isValidSendAmount(m))return false;var n=l.index;return {startIndex:n,endIndex:n+m.length,element:this._element(m)};},_element:function j(k){return (c('JSXDOM').a({href:"#",className:"_35i0"+(!c('MessengerEnvironment').messengerui?' '+"_4g4e":''),"data-p2p-trigger":k},k));}};f.exports=Object.assign(i,c('TransformTextToDOMMixin'));}),null);
__d('p2pTriggerJSXDOMToString',['DOMEmoji','DOMEmote','DOMP2PTrigger','JSXDOM','transformTextToDOM'],(function a(b,c,d,e,f,g){var h=function i(j,k,l,m,n,o){var p=[];if(m)p.push(c('DOMP2PTrigger'));if(k)n?p.push(c('DOMEmoji').params({isSupportedEmoji:n})):p.push(c('DOMEmoji'));if(l)o?p.push(c('DOMEmote').params({getMessengerEmote:o})):p.push(c('DOMEmote'));return (c('JSXDOM').span(null,c('transformTextToDOM')(j,p)).innerHTML);};f.exports=h;}),null);
__d('P2PTriggers.react',['DOM','Event','MercuryIDs','P2PActions','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PUserEligibilityStore','StoreAndPropBasedStateMixin','React','ReactDOM','nullthrows','p2pTriggerJSXDOMToString'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').PropTypes,i=c('React').createClass({displayName:'P2PTriggers',mixins:[c('StoreAndPropBasedStateMixin')(c('P2PUserEligibilityStore'))],propTypes:{getMessengerEmote:h.func,isSupportedEmoji:h.func,renderEmoji:h.bool,renderEmoticons:h.bool,text:h.string.isRequired,threadID:h.string.isRequired},getInitialState:function j(){return {amount:''};},statics:{calculateState:function j(k){var l=c('MercuryIDs').isGroupChat(k.threadID)||c('P2PUserEligibilityStore').getEligibilityByThreadID(k.threadID);return {isThreadEligible:l,otherUserID:c('MercuryIDs').getUserIDFromThreadID(k.threadID)};}},_clickListeners:null,componentDidMount:function j(){this._clickListeners=[];this.bindClickListeners();},componentWillUnmount:function j(){this.unbindClickListeners();},log:function j(k,l){c('P2PLogger').log(k,babelHelpers['extends']({www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SEND,object_id:this.state.otherUserID},l));},bindClickListeners:function j(){var k=c('nullthrows')(this._clickListeners);if(!k.length){var l=c('DOM').scry(c('ReactDOM').findDOMNode(this),'[data-p2p-trigger]');for(var m=0,n=l.length;m<n;m++)k.push(c('Event').listen(l[m],'click',this.handleTriggerClick));}},unbindClickListeners:function j(){var k=void 0;if(this._clickListeners){for(var l=0,m=this._clickListeners.length;l<m;l++){k=this._clickListeners[l];if(k)k.remove();}this._clickListeners=[];}},componentDidUpdate:function j(k,l){if(!l.isThreadEligible&&this.state.isThreadEligible)this.bindClickListeners();},getAmountFromTriggerClickEvent:function j(k){var l=k.target.getAttribute('data-p2p-trigger')||'';return l.replace(/[^0-9\.]+/g,'');},handleTriggerClick:function j(k){k.preventDefault();var l=this.getAmountFromTriggerClickEvent(k);this.setState({amount:l});this.openSendView();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_SEND_TRIGGER,{raw_amount:this.state.amount,currency:'USD'});},openSendView:function j(){c('P2PActions').chatSendViewOpened({threadID:this.props.threadID,amount:this.state.amount});},render:function j(){var k=c('p2pTriggerJSXDOMToString')(this.props.text,this.props.renderEmoji,this.props.renderEmoticons,this.state.isThreadEligible,this.props.isSupportedEmoji,this.props.getMessengerEmote);return (c('React').createElement('span',{dangerouslySetInnerHTML:{__html:k}}));}});f.exports=i;}),null);
__d('TextWithEntitiesAndP2P.react',['BaseTextWithEntities.react','Link.react','P2PTriggers.react','React'],(function a(b,c,d,e,f,g){'use strict';var h=c('React').createClass({displayName:'TextWithEntitiesAndP2P',_renderText:function i(j){return (c('React').createElement(c('P2PTriggers.react'),{getMessengerEmote:this.props.getMessengerEmote,isSupportedEmoji:this.props.isSupportedEmoji,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji,text:j,threadID:this.props.threadID}));},_renderRange:function i(j,k){if(this.props.interpolator){return this.props.interpolator(j,k);}else return (c('React').createElement(c('Link.react'),{href:k.entity},j));},render:function i(){return (c('React').createElement(c('BaseTextWithEntities.react'),babelHelpers['extends']({},this.props,{textRenderer:this._renderText,rangeRenderer:this._renderRange,ranges:this.props.ranges,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:this.props.text})));}});f.exports=h;}),null);
__d('P2PAddCreditCardDialog.react',['cx','fbt','MessengerEnvironment','Link.react','MessengerPaymentProductType','P2PAPI','P2PAPIUtils','P2PCreditCardStore','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PLinkConstants','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','emptyFunction','getObjectValues'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m='fbP2PAddCreditCardDialog_learnMoreSentenceID';j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=k.constructor).call.apply(o,[this].concat(r)),this.state={isValid:false,formData:{},loading:false,requestID:'',saveErrors:null},this.onCreditCardStoreChange=function(){var t=c('P2PCreditCardStore').getAsyncRequestState(),u=t[this.state.requestID];this.setState({asyncRequestState:t});if(u){this.setState({requestID:''});if(u.error){this.handleOnSaveError(u.error);}else this.handleOnSaveSuccess(u);}}.bind(this),this.log=function(t,u){c('P2PLogger').log(t,babelHelpers['extends']({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,u));}.bind(this),this.onSaveClick=function(){var t=c('P2PAPIUtils').genRequestID();this.setState({loading:true,requestID:t,saveErrors:null});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CONFIRM_CARD_DETAILS);c('P2PAPI').addCreditCard(babelHelpers['extends']({requestID:t,product_type:this.props.productType},this.state.formData));}.bind(this),this.handleOnSaveSuccess=function(t){this.props.onSuccess(t);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_SUCCESS);}.bind(this),this.handleOnSaveError=function(t){this.setState({loading:false,saveErrors:t});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_FAIL,{message:t&&t.general?t.general.message:''});}.bind(this),this.handleValidation=function(t,u){this.setState({isValid:t,formData:u});}.bind(this),this.isSaveButtonDisabled=function(){return this.state.loading||!this.state.isValid;}.bind(this),this.onToggle=function(t){if(!t){this.props.onCancel();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CANCEL_ADD_CARD);}}.bind(this),this.onCancelClicked=function(){this.onToggle(false);}.bind(this),this.renderAddCardForm=function(){var t=void 0,u=this.props.title;if(this.props.showCancelButton)t=c('React').createElement(c('P2PButton.react'),{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return (c('React').createElement('div',null,c('React').createElement(c('P2PDialogTitle.react'),null,u),c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement(c('P2PText.react'),{type:'primary',className:"_3-96"},this.props.text),c('React').createElement(c('P2PCreditCardForm.react'),{asyncRequestState:this.state.asyncRequestState,compactMode:true,onValidation:this.handleValidation,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:false,showLabels:true,showPlaceholderOnFocus:true,showSecondaryIcons:true,useGutters:true}),c('React').createElement(c('P2PText.react'),{className:"_3-8y",id:m,type:'secondary'},i._("Your payment info is stored securely."),c('React').createElement('div',null,c('React').createElement(c('Link.react'),{'aria-describedby':m,href:c('P2PLinkConstants').addDebitCardHelpURI,target:'_blank'},i._("Learn More"))))),c('React').createElement(c('P2PDialogFooter.react'),{leftContent:this.props.leftContent},t,c('React').createElement(c('P2PButton.react'),{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));}.bind(this),p;}n.prototype.componentDidMount=function(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=c('P2PCreditCardStore').addListener('change',this.onCreditCardStoreChange);};n.prototype.componentWillUnmount=function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}};n.prototype.render=function(){return (c('React').createElement(c('P2PDialog.react'),{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:'dialog',onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.state.loading})));};n.propTypes={cancelButtonText:l.string,eventFlow:l.string.isRequired,loggingData:l.object,loggingObjectID:l.string,onCancel:l.func,onSuccess:l.func,productType:l.oneOf(c('getObjectValues')(c('MessengerPaymentProductType'))),saveButtonText:l.string,showCancelButton:l.bool,text:l.string,title:l.string};n.defaultProps=function(){var o=void 0;if(c('MessengerEnvironment').messengerui){o=480;}else o=430;return {cancelButtonText:i._("Cancel"),loggingData:{},onCancel:c('emptyFunction'),onSuccess:c('emptyFunction'),productType:c('MessengerPaymentProductType').P2P,saveButtonText:i._("Save"),showCancelButton:true,text:i._("Please enter a Visa or MasterCard debit card. Credit cards can't be used."),title:i._("Add Debit Card"),width:o};}();f.exports=n;}),null);