if (self.CavalryLogger) { CavalryLogger.start_js(["GjAsk"]); }

__d("NotificationClassification",[],(function a(b,c,d,e,f,g){f.exports={CONVERSATIONS:"conversations",MULTI_COMPANY_GROUPS:"multi_company_groups"};}),null);
__d('NotificationHiddenState',['NotificationUpdates','NotificationConstants','isEmpty'],(function a(b,c,d,e,f,g){var h={};c('NotificationUpdates').subscribe('update-notifications',function(j,k){var l=k.nodes,m=k.payloadsource;if(m===c('NotificationConstants').PayloadSourceType.LIVE_SEND&&l&&l.length){var n={};l.forEach(function(o){var p=o.alert_id;if(h[p])n[p]=false;});if(!c('isEmpty')(n)){h=Object.assign(h,n);c('NotificationUpdates').didUpdateHiddenState(Object.keys(n));}}});c('NotificationUpdates').subscribe('update-hidden',function(j,k){if(k.hiddenState){h=Object.assign(h,k.hiddenState);c('NotificationUpdates').didUpdateHiddenState(Object.keys(k.hiddenState));}});var i={isHidden:function j(k){if(h[k])return h[k];return false;}};f.exports=i;}),null);
__d('NotificationVPVs',['getElementRect','MarauderLogger','Set'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('Set'))();function i(o){if(j(o))return;c('MarauderLogger').log('notifications_vpv',undefined,null,'notification',o);h.add(o);}function j(o){return h.has(o);}function k(){h.clear();}function l(o,p){if(!o||!p)return false;return !(o.bottom<p.top||o.top>p.bottom||o.right<p.left||o.left>p.right);}function m(o){var p=c('getElementRect')(o);if(!p||p.top==0&&p.bottom==0&&p.left==0&&p.right==0)return null;return p;}var n={logImpression:i,clearImpressions:k,hasLoggedImpression:j,getValidatedRectangle:m,areRectsOverlapping:l};f.exports=n;}),null);
__d('NotificationList.react',['NotificationClassification','NotificationConstants','NotificationHiddenState','NotificationSeenState','NotificationStore','NotificationUpdates','NotificationUserActions','NotificationVPVs','FunnelLogger','NotificationJewelFunnelLoggingConstants','React','SubscriptionsHandler','getObjectValues','isEmpty','mapObject'],(function a(b,c,d,e,f,g){var h,i,j=c('NotificationJewelFunnelLoggingConstants').FUNNEL_LOGGING_NAME,k=c('NotificationJewelFunnelLoggingConstants').FUNNEL_LOGGING_EVENT,l=c('React').PropTypes,m=c('NotificationConstants').PayloadSourceType.LIVE_SEND;h=babelHelpers.inherits(n,c('React').Component);i=h&&h.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return p=(o=i.constructor).call.apply(o,[this].concat(r)),this.state={canFetchMore:true,notifs:{},hiddenState:{},readState:{},showingChevron:false,readWhilePausedOrNavigating:{}},this.$NotificationList1=false,this.$NotificationList2={},this.$NotificationList3=false,this.$NotificationList8=function(){var t={};Object.keys(this.$NotificationList2).forEach(function(u){var v=c('NotificationHiddenState').isHidden(u);if(v!=this.state.hiddenState[u])t[u]=v;}.bind(this));if(!c('isEmpty')(t))this.setState({hiddenState:babelHelpers['extends']({},this.state.hiddenState,t)});this.$NotificationList2={};this.$NotificationList5(c('NotificationStore').getCount(this.props.endpoint,this.props.filter,this.props.classification));}.bind(this),this.$NotificationList10=function(t,u,v){if(this.$NotificationList1||!this.state.canFetchMore)return;if(t){c('FunnelLogger').appendAction(j,k.FETCH_NEXT_SET);this.$NotificationList9();}this.$NotificationList11(u,v);}.bind(this),this.$NotificationList12=function(){this.setState({showingChevron:true});}.bind(this),this.$NotificationList13=function(){this.setState({showingChevron:false});}.bind(this),this.$NotificationList16=function(t){if(this.props.paused&&this.props.filter==='unread'){var u=babelHelpers['extends']({},this.state.readWhilePausedOrNavigating);u[t]=true;this.setState({readWhilePausedOrNavigating:u});}}.bind(this),p;}n.prototype.componentWillMount=function(){'use strict';c('NotificationStore').registerEndpoint(this.props.endpoint,this.props.filter);if(this.props.businessID)c('NotificationStore').setBusinessID(this.props.businessID);c('FunnelLogger').appendAction(j,k.FETCH_NOTIFICATIONS);this.$NotificationList4=new (c('SubscriptionsHandler'))();this.$NotificationList4.addSubscriptions(c('NotificationUpdates').subscribe('notifications-updated',function(o,p){if(p.source==m&&!c('isEmpty')(p.updates)){this.$NotificationList3=true;if(this.props.paused!==false)this.$NotificationList2=babelHelpers['extends']({},this.$NotificationList2,p.updates);return;}this.$NotificationList5(c('NotificationStore').getCount(this.props.endpoint,this.props.filter,this.props.classification));}.bind(this)),c('NotificationUpdates').subscribe(['hidden-state-updated','read-state-updated'],function(o,p){if(o=='hidden-state-updated'){if(p.source!==m||!this.props.paused){var q=c('mapObject')(p.updates,function(s,t){return c('NotificationHiddenState').isHidden(t);});this.setState({hiddenState:babelHelpers['extends']({},this.state.hiddenState,q)});}}else{var r=c('mapObject')(p.updates,function(s,t){return c('NotificationSeenState').isRead(t);});this.setState({readState:babelHelpers['extends']({},this.state.readState,r)});}}.bind(this)));};n.prototype.componentWillUnmount=function(){'use strict';if(this.$NotificationList4){this.$NotificationList4.release();this.$NotificationList4=null;}};n.prototype.componentWillReceiveProps=function(o){'use strict';if(this.$NotificationList6(o)||!o.paused)this.setState({readWhilePausedOrNavigating:{}});};n.prototype.$NotificationList6=function(o){'use strict';return o.filter!==this.props.filter||o.classification!==this.props.classification;};n.prototype.$NotificationList7=function(o){'use strict';var p=Object.keys(this.state.notifs),q=Object.keys(o).filter(function(s){return !this.state.notifs[s];}.bind(this));p=p.concat(q);var r={};p.forEach(function(s){if(this.$NotificationList2[s]){if(this.state.notifs[s])r[s]=this.state.notifs[s];}else r[s]=o[s];}.bind(this));return r;};n.prototype.$NotificationList5=function(o){'use strict';var p=this.props,q=p.endpoint,r=p.filter,s=p.classification;this.$NotificationList1=true;c('NotificationStore').getNotifications(o,function(t){var u=c('isEmpty')(this.$NotificationList2)?t:this.$NotificationList7(t),v={},w={};c('getObjectValues')(u).forEach(function(x){var y=x.alert_id;v[y]=c('NotificationSeenState').isRead(y);w[y]=c('NotificationHiddenState').isHidden(y);});this.$NotificationList1=false;this.setState({notifs:u,canFetchMore:c('NotificationStore').canFetchMore(q,r,s)||c('NotificationStore').getCount(q,r,s)!==Object.keys(u).length,readState:babelHelpers['extends']({},this.state.readState,v),hiddenState:babelHelpers['extends']({},this.state.hiddenState,w)});}.bind(this),q,r,s);};n.prototype.$NotificationList9=function(){'use strict';if(!this.$NotificationList1){var o=Object.keys(this.state.notifs).length;this.$NotificationList5(o+this.props.numPerPage);}};n.prototype.$NotificationList11=function(o,p){'use strict';if(!o||!p)return;for(var q=0,r=o.children.length;q<r;q++){var s=o.children[q];if(s){var t=s.getAttribute('data-alert-id');if(t&&!c('NotificationVPVs').hasLoggedImpression(t)){var u=c('NotificationVPVs').getValidatedRectangle(s);if(u&&c('NotificationVPVs').areRectsOverlapping(p,u))c('NotificationVPVs').logImpression(t);}}}};n.prototype.$NotificationList14=function(o){'use strict';if(o.length>this.props.numPerPage){this.$NotificationList5(o.length);}else this.$NotificationList9();return;};n.prototype.$NotificationList15=function(o){'use strict';var p=c('NotificationSeenState').getUnseenIDs();if(!c('isEmpty')(this.$NotificationList2))p=p.filter(function(q){return !this.$NotificationList2[q];}.bind(this));if(p.length&&this.props.paused)c('NotificationUserActions').markNotificationsAsSeen(p);if(this.props.hasEverBeenOpened)if(!o||!o.hasEverBeenOpened)this.$NotificationList14(p);};n.prototype.componentDidUpdate=function(o){'use strict';this.$NotificationList15(o);if(o.paused&&!this.props.paused){this.$NotificationList3=false;setTimeout(this.$NotificationList8,0);return;}if(this.props.paused&&this.$NotificationList6(o)){setTimeout(this.$NotificationList8,0);return;}};n.prototype.componentDidMount=function(){'use strict';this.$NotificationList15();};n.prototype.render=function(){'use strict';var o=this.props.listRenderer,p=this.state,q=p.notifs,r=p.readState,s=p.readWhilePausedOrNavigating,t={};if(this.props.filter==null){t=q;}else Object.keys(q).forEach(function(u){var v=q[u],w=v.alert_id,x=r[w];if(this.props.filter==='unread')x=!x||Object.prototype.hasOwnProperty.call(s,w);if(x)t[w]=v;}.bind(this));if(this.props.classification)Object.keys(q).forEach(function(u){var v=q[u];if(v.classification!==this.props.classification)delete t[v.alert_id];}.bind(this));return (c('React').createElement(o,{paused:this.props.paused,tracking:this.props.tracking,negativeTracking:this.props.negativeTracking,shortenTimestamp:this.props.shortenTimestamp,businessID:this.props.businessID,maxHeight:this.props.maxHeight,useChevron:this.props.useChevron,chevronType:this.props.chevronType,notifs:t,afterScroll:this.$NotificationList10,onChevronShow:this.$NotificationList12,onChevronHide:this.$NotificationList13,canFetchMore:this.state.canFetchMore,hiddenState:this.state.hiddenState,readState:this.state.readState,showingChevron:this.state.showingChevron,shouldScroll:this.$NotificationList3,upsell:this.props.upsell||null,isRHC:this.props.isRHC,enableHubView:this.props.enableHubView,onRead:this.$NotificationList16}));};n.propTypes={businessID:l.string,hasEverBeenOpened:l.bool,enableHubView:l.bool,maxHeight:l.number,negativeTracking:l.object,paused:l.bool,tracking:l.string,useChevron:l.bool,chevronType:l.string,numPerPage:l.number.isRequired,listRenderer:l.func.isRequired,upsell:l.object,endpoint:l.string,filter:l.string,classification:l.oneOf(c('getObjectValues')(c('NotificationClassification')))};f.exports=n;}),null);