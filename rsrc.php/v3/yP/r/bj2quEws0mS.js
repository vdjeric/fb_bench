if (self.CavalryLogger) { CavalryLogger.start_js(["i7QZL"]); }

__d('ComposerCitySharer',['Arbiter','ArbiterMixin','AsyncRequest','CSS','DOM','Event','Parent','mixin'],(function a(b,c,d,e,f,g){var h,i,j={};h=babelHelpers.inherits(k,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function k(l){'use strict';i.constructor.call(this);this.root=l;}k.prototype.init=function(l,m,n,o,p){'use strict';this.cityLink=l;this.closeButton=m;this.input=n;this.disableShareInput=o;this._options=p;this.cityName=c('DOM').find(this.cityLink,'.cityName');this.data={};c('Event').listen(this.closeButton,'click',function(){this.clearCity();this.disableShareInput.value='true';}.bind(this));j[this.root]=this;this.inform('init',null,c('Arbiter').BEHAVIOR_PERSISTENT);};k.prototype.changeCity=function(l,m,n){'use strict';this.setCityId(l,m,n);this.toggleLocationSharing(l,m,n,false);};k.prototype.setCityId=function(l,m,n){'use strict';if(m){this.data={city_name:l,city_page_id:m,city_id:n};this.input.value=m;var o=l.lastIndexOf(',');if(o!=-1)l=l.substring(0,o);var p=l;c('DOM').setContent(this.cityName,p);c('CSS').addClass(this.root,'ComposerCitySharerCitySelected');c('CSS').conditionShow(this.closeButton,!this._placeSelected);this.inform('change',this.data,c('Arbiter').BEHAVIOR_PERSISTENT);}};k.prototype.toggleLocationSharing=function(l,m,n,o){'use strict';if(m)new (c('AsyncRequest'))().setURI('/ajax/places/toggle_location_sharing').setData({city_id:n,city_page_id:m,city_name:l,is_default:o,session_id:this._options.session_id}).send();};k.prototype.setDefaultCity=function(l,m,n){'use strict';this._defaultCityData=[l,m,n];};k.prototype.useDefaultCity=function(){'use strict';if(this._defaultCityData){var l=this._defaultCityData[0],m=this._defaultCityData[1],n=this._defaultCityData[2];this.setCityId(l,m,n);this.toggleLocationSharing(l,m,n,true);}};k.prototype.addPlace=function(l){'use strict';if(l.city_id){this.changeCity(l.city_name,l.city_page_id,l.city_id);}else this.clearCity();this._placeSelected=true;c('CSS').addClass(this.cityLink,'placeIconSelected');c('CSS').hide(this.closeButton);};k.prototype.clearPlace=function(l){'use strict';this._placeSelected=false;c('CSS').removeClass(this.cityLink,'placeIconSelected');c('CSS').conditionShow(this.closeButton,this.getValue());};k.prototype.clearCity=function(){'use strict';this.data={};this.input.value='';c('DOM').setContent(this.cityName,'');c('CSS').removeClass(this.root,'ComposerCitySharerCitySelected');c('CSS').hide(this.closeButton);this.inform('change',null,c('Arbiter').BEHAVIOR_PERSISTENT);};k.prototype.getIcon=function(){'use strict';return this.root;};k.prototype.getValue=function(){'use strict';return this.input.value;};k.getInstance=function(l){'use strict';var m=c('Parent').byClass(l,'ComposerCitySharer');return m&&j[m];};f.exports=k;}),null);
__d('ContextualBlind',['cx','Event','Animation','Arbiter','DOM','Rect','Vector','$','shield'],(function a(b,c,d,e,f,g,h){var i=0,j=1,k=.8,l=500;m.prototype.$ContextualBlind6=function(){'use strict';this.$ContextualBlind1&&c('Arbiter').unsubscribe(this.$ContextualBlind1);this.$ContextualBlind1=null;this.$ContextualBlind2=[];this.$ContextualBlind3&&this.$ContextualBlind3.remove();this.$ContextualBlind3=null;this.$ContextualBlind4&&c('DOM').remove(this.$ContextualBlind4);this.$ContextualBlind5=false;};m.prototype.show=function(n,o,p,q,r,s,t,u,v){'use strict';if(t==null)t=k;u=u||i;this.hide();var w=u===i?"_2xgb":"_2xgc";for(var x=0;x<4;x++)this.$ContextualBlind2.push(c('DOM').create('div',{className:w,style:'opacity:'+t}));c('DOM').appendContent(document.body,this.$ContextualBlind2);if(s!==false){w=u===i?"_2xgd":"_2xge";this.$ContextualBlind4=c('DOM').create('div',{className:w});c('DOM').appendContent(document.body,this.$ContextualBlind4);}var y=c('shield')(this.updatePosition,this,n,o,p,q,r,v);y();this.$ContextualBlind1=c('Arbiter').subscribe('reflow',y);this.$ContextualBlind3=c('Event').listen(window,'resize',y);this.$ContextualBlind5=true;};m.prototype.fadeIn=function(n,o,p,q,r,s,t,u,v,w){'use strict';u=u||l;if(t==null)t=k;this.show(n,o,p,q,r,s,0,v==null?i:v,w);for(var x=0;x<this.$ContextualBlind2.length;x++){var y=this.$ContextualBlind2[x];new (c('Animation'))(y).duration(u).from('opacity',0).to('opacity',t).go();}};m.prototype.hide=function(){'use strict';this.$ContextualBlind2&&this.$ContextualBlind2.forEach(c('DOM').remove);this.$ContextualBlind6();};m.prototype.fadeOut=function(n){var o=arguments.length<=1||arguments[1]===undefined?l:arguments[1];'use strict';if(!this.$ContextualBlind2)return;if(n==null)n=k;for(var p=0;p<this.$ContextualBlind2.length;p++){var q=this.$ContextualBlind2[p];new (c('Animation'))(q).duration(o).from('opacity',n).to('opacity',0).ondone(c('DOM').remove.bind(null,q)).go();}this.$ContextualBlind6();};m.prototype.$ContextualBlind7=function(n,o){'use strict';o.getPositionVector().setElementPosition(n);o.getDimensionVector().setElementDimensions(n);};m.prototype.updatePosition=function(n,o,p,q,r,s){'use strict';var t=c('Vector').getDocumentDimensions().y,u=c('Rect').getElementBounds(c('$')(n));u=new (c('Rect'))(u.t-(o||0),u.r+(p||0),u.b+(q||0),u.l-(r||0),u.domain);var v=document,w=v&&v.documentElement&&v.documentElement.scrollWidth||v&&v.body&&v.body.scrollWidth||0;this.$ContextualBlind7(this.$ContextualBlind2[0],new (c('Rect'))(s?s+window.scrollY:0,w,u.t,0,'document'));this.$ContextualBlind7(this.$ContextualBlind2[1],new (c('Rect'))(u.t,w,u.b,u.r,'document'));this.$ContextualBlind7(this.$ContextualBlind2[2],new (c('Rect'))(u.b,w,t,0,'document'));this.$ContextualBlind7(this.$ContextualBlind2[3],new (c('Rect'))(u.t,u.l,u.b,0,'document'));if(this.$ContextualBlind4)this.$ContextualBlind7(this.$ContextualBlind4,u);};function m(){'use strict';}m.STYLE_LIGHT=i;m.STYLE_DARK=j;f.exports=m;}),null);
__d('ContextualBlindSingleton',['ContextualBlind'],(function a(b,c,d,e,f,g){f.exports=new (c('ContextualBlind'))();}),null);
__d('TourAutoPilot',['ContextualBlindSingleton','DOMScroll','Tour'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('Tour'));i=h&&h.prototype;j.prototype.registerStep=function(k,l){'use strict';k.subscribe('tour-dialog-show',this.handleShowDialog.bind(this,k,l));i.registerStep.call(this,k,l);};j.prototype.handleLeavePage=function(){'use strict';this.openDialog&&this.openDialog.destroy();this.hideContextualBlind();i.handleLeavePage.call(this);};j.prototype.handleShowDialog=function(k,l){'use strict';var m=k.getContext();this.showContextualBlind(m,true);c('DOMScroll').scrollTo(m,true,true,0);};j.prototype.handleTourStop=function(){'use strict';this.hideContextualBlind(true);i.handleTourStop.call(this);};j.prototype.showContextualBlind=function(k,l){'use strict';if(this.blindShowing){c('ContextualBlindSingleton').show(k,0,0,0,0,l,this.opacity);}else c('ContextualBlindSingleton').fadeIn(k,0,0,0,0,l,this.opacity);this.blindShowing=true;};j.prototype.hideContextualBlind=function(k){'use strict';if(k){c('ContextualBlindSingleton').fadeOut();}else c('ContextualBlindSingleton').hide();this.blindShowing=false;};function j(){'use strict';h.apply(this,arguments);}Object.assign(j.prototype,{blindShowing:false,opacity:null});g.TourAutoPilot=j;}),null);
__d('ComposerTour',['Arbiter','AsyncRequest','ComposerCitySharer','CSS','DOM','Parent','Tour','URI','$','TourAutoPilot'],(function a(b,c,d,e,f,g){var h,i,j=c('TourAutoPilot').TourAutoPilot;h=babelHelpers.inherits(k,j);i=h&&h.prototype;k.prototype.handleShowDialog=function(l,m){'use strict';var n=c('Parent').byClass(c('$')('composerTourStart'),'uiComposer');if(m!='start'){i.handleShowDialog.call(this,l,m);this.showContextualBlind(n);}};k.prototype.showContextualBlind=function(l){'use strict';c('CSS').addClass(document.body,'composerTourInProgress');i.showContextualBlind.call(this,l);};k.prototype.hideContextualBlind=function(l){'use strict';i.hideContextualBlind.call(this,l);c('CSS').removeClass(document.body,'composerTourInProgress');};k.openComposer=function(){'use strict';var l=c('Parent').byClass(c('$')('composerTourStart'),'uiComposerAttachment'),m=c('Parent').byTag(l,'form');m.action=l.getAttribute('data-endpoint');m.xhpc.value=l.id;m.xhpc.click();};k.closeOnComposerReset=function(){'use strict';c('Arbiter').subscribe('composer/reset',function(){c('Tour').getInstance().setTourStop();});};k.sendLocationOption=function(l,m){'use strict';var n=new (c('URI'))(m).addQueryData({use_location:l});new (c('AsyncRequest'))(n.toString()).send();};k.addCity=function(){'use strict';var l=c('Parent').byClass(c('$')('composerTourLocation'),'uiComposer'),m=c('ComposerCitySharer').getInstance(c('DOM').scry(l,'span.ComposerCitySharer')[0]);m&&m.useDefaultCity();};k.clearCity=function(){'use strict';var l=c('Parent').byClass(c('$')('composerTourLocation'),'uiComposer'),m=c('ComposerCitySharer').getInstance(c('DOM').scry(l,'span.ComposerCitySharer')[0]);m&&m.clearCity();};k.hideStartDialog=function(){'use strict';var l=c('Tour').getInstance().steps.start;l&&l.hide();};function k(){'use strict';h.apply(this,arguments);}f.exports=k;}),null);
__d('legacy:composer-tour-js',['ComposerTour'],(function a(b,c,d,e,f,g){b.ComposerTour=c('ComposerTour');}),3);