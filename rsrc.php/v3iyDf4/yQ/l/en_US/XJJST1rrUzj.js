if (self.CavalryLogger) { CavalryLogger.start_js(["\/v\/a6"]); }

__d("WorkUserAvailabilityStatusType",[],(function a(b,c,d,e,f,g){f.exports={NONE:"None",AVAILABLE:"Available",SPORADIC:"Sporadic",TENTATIVE:"Tentative",BUSY:"Busy",DO_NOT_DISTURB:"Do Not Disturb",FOCUS:"Focus"};}),null);
__d('EventReminderDispatcher',['ExplicitRegistrationDispatcher'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('ExplicitRegistrationDispatcher'))({strict:false});}),null);
__d('EventReminderActions',['EventReminderDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({DELETE_EVENT_REMINDER:null,UPDATE_EVENT_REMINDER:null}),i={Types:h,updateEventReminder:function j(k,event){c('EventReminderDispatcher').dispatch({type:i.Types.UPDATE_EVENT_REMINDER,threadID:k,event:event});},deleteEventReminder:function j(k){c('EventReminderDispatcher').dispatch({type:i.Types.DELETE_EVENT_REMINDER,threadID:k});}};f.exports=i;}),null);
__d("XEventReminderController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/ajax\/eventreminder\/",{event_reminder_id:{type:"Int",required:true}});}),null);
__d('EventReminderRequestHelper',['AsyncRequest','EventReminderActions','XEventReminderController'],(function a(b,c,d,e,f,g){'use strict';var h={fetchEventReminder:function i(j,k,l){var m=c('XEventReminderController').getURIBuilder().setInt('event_reminder_id',k);new (c('AsyncRequest'))(m.getURI()).setHandler(function(n){if(n.payload){c('EventReminderActions').updateEventReminder(j,n.payload);l();}}).send();}};f.exports=h;}),null);
__d('ChatAnimatedGifs',['URI'],(function a(b,c,d,e,f,g){var h={shouldHideBody:function i(j){if(!j.has_attachment)return false;for(var k=0;k<j.attachments.length;k++){var l=j.attachments[k];if(l.preview_url){var m=h.getRawUrlFromSafeUrl(l.preview_url);if(j.body==m)return true;}}return false;},getRawUrlFromSafeUrl:function i(j){return new (c('URI'))(j).getQueryData().url;}};f.exports=h;}),null);
__d('ChatBubble.react',['cx','DOMDimensions','EmojiOnlyMessage.react','MercuryMessageBody.react','MessagingGiftWrap.react','MessengerSupportedEmojiUtils','React','ReactDOM','joinClasses','messengerCustomColorUtils'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=2,k=c('React').createClass({displayName:'ChatBubble',_boxWidth:0,propTypes:{insideDecorators:i.arrayOf(i.object),attachments:i.node,body:i.string,customColor:i.string,customLike:i.object,isEmojiLike:i.bool,isFromViewer:i.bool,isGiftWrapped:i.bool,maxWidth:i.number.isRequired,metaRanges:i.array,onUnwrap:i.func,ranges:i.array,threadCustomColor:i.string,threadID:i.string},getInitialState:function l(){return {emojis:undefined,bubbleWidth:null};},componentDidMount:function l(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var m=this.props.body||'',n=c('MessengerSupportedEmojiUtils').getEmojiOnlyContents(m);if(n&&n.length)this.setState({emojis:n});}this._restyleBubble(this.props);},componentDidUpdate:function l(m){if(m.maxWidth!==this.props.maxWidth||m.body!==this.props.body||!m.attachments&&this.props.attachments)this._restyleBubble(m);},render:function l(){var m=this.props.body||'';return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')("_5w1r"+(!this.state.emojis?' '+"_3_om":'')+(!!this.state.emojis?' '+"_31xx":''),this.props.className),ref:'bubble',style:{maxWidth:this.props.maxWidth,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:m.length>=15?'break-word':'inherit'}}),c('React').createElement('div',{className:"_4gx_",ref:'inner'},this._renderContent(),this.props.attachments),this.props.insideDecorators,this.props.isGiftWrapped?c('React').createElement(c('MessagingGiftWrap.react'),{onUnwrap:this.props.onUnwrap}):null));},_renderContent:function l(){if(!this.props.body||this.props.isEmojiLike)return null;var m={},n=null;if(this.state.emojis){n=c('React').createElement(c('EmojiOnlyMessage.react'),{contents:this.state.emojis});}else{n=c('React').createElement(c('MercuryMessageBody.react'),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike,threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer});if(this.props.customColor)m=c('messengerCustomColorUtils').customBubbleStyle(this.props.customColor,m);}return (c('React').createElement('div',{className:"_d97"+(!!this.state.emojis?' '+"_31xy":''),ref:'contentWrapper',style:m},c('React').createElement('span',{className:"_5yl5",ref:'content'},n)));},_restyleBubble:function l(m){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var n=c('ReactDOM').findDOMNode(this.refs.bubble);if(m.maxWidth!==this.props.maxWidth||c('DOMDimensions').getElementDimensions(n).width>this.props.maxWidth){var o=this.props.maxWidth;this.setState({bubbleWidth:o},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function l(){var m=c('ReactDOM').findDOMNode(this.refs.bubble),n=c('DOMDimensions').getElementDimensions(m).width,o=c('ReactDOM').findDOMNode(this.refs.content),p=o?c('DOMDimensions').getElementDimensions(o).width+c('DOMDimensions').measureElementBox(c('ReactDOM').findDOMNode(this.refs.contentWrapper),'width',true,false,false):0,q=p+j;if(p>0&&q<this.props.maxWidth&&n-q-this.getBoxWidth()>0)this.setState({bubbleWidth:q});},contentWraps:function l(){var m=c('ReactDOM').findDOMNode(this.refs.content);if(!m)return false;var n=m.getClientRects(),o=c('DOMDimensions').getElementDimensions(m).height;return n&&n.length>1&&n[0].height<o;},getBoxWidth:function l(){if(!this._boxWidth)this._boxWidth=c('DOMDimensions').measureElementBox(c('ReactDOM').findDOMNode(this.refs.bubble),'width',true,true,false);return this._boxWidth;}});f.exports=k;}),null);
__d('ChatCodePasteUtils',['cx','BanzaiODS','ChatBubble.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i=/`{3,}/;function j(l){return !!(l&&i.test(l)&&l.split('\n').length>1);}function k(l,m,n,o,p){var q=l.split(i),r=[];for(var s=0;s<q.length;s+=2){var t=q[s].trim();if(t)r.push(c('React').createElement('div',{key:s,className:"_5wde"+(' '+"_n4o")},c('React').createElement(c('ChatBubble.react'),{body:t,customColor:p||undefined,className:"clearfix _5wdf",maxWidth:m,ranges:n||undefined,threadID:o||undefined})));if(s+1<q.length&&q[s+1]){var u=q[s+1].split('\n'),v=u[0].replace(/[^a-zA-Z]+/g,''),w=u.slice(1).join('\n');c('BanzaiODS').bumpEntityKey('chat_code_paste','render_bubble');r.push(c('React').createElement('div',{key:s+1,className:"_5wde"+(' '+"_n4o")},c('React').createElement('div',{ref:'bubble',className:"_3_om _4yng _5wdf"},c('React').createElement('div',{ref:'syntaxTarget'+s,className:'language-'+v},w))));}}return r;}f.exports={containsCodeBlock:j,getCodeAndMessageBubbles:k};}),null);
__d('ChatEmployeeAwayWarning',['MercuryIDs','MercuryParticipants','MercuryViewer'],(function a(b,c,d,e,f,g){var h={updateEmployeeAwayWarning:function i(j,k,l){c('MercuryParticipants').get(c('MercuryViewer').getID(),function(m){var n=m.employee;if(n)c('MercuryParticipants').getMulti(j.participants,function(o){var p=false,q=c('MercuryIDs').getUserIDFromThreadID(j.thread_id);if(!q)return;var r='fbid:'+q;for(var s in o)if(r==o[s].id&&o[s].is_employee_away)p=true;if(p){k();}else l();});});}};f.exports=h;}),null);
__d('ChatPrivacyActionController',['ChatVisibility','JSLogger','PresencePrivacy'],(function a(b,c,d,e,f,g){var h=function i(j,k){this._userID=j;this._logger=c('JSLogger').create('blackbird');this._getState=function(){if(c('ChatVisibility').isOnline())return c('PresencePrivacy').allows(this._userID)?i.NORMAL:i.BLOCKED;return i.OFFLINE;};this._togglePrivacy=function(){var m=this._getState();switch(this._getState()){case i.OFFLINE:if(c('ChatVisibility').isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});c('ChatVisibility').goOnline(function(){if(!c('PresencePrivacy').allows(this._userID)){if(this._getState()!==i.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case i.BLOCKED:c('PresencePrivacy').allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case i.NORMAL:c('PresencePrivacy').disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};var l=function(){k&&k(this._getState());}.bind(this);l();this._subscribeToken=c('PresencePrivacy').subscribe('privacy-changed',l);};h.OFFLINE='offline';h.BLOCKED='blocked';h.NORMAL='normal';Object.assign(h.prototype,{togglePrivacy:function i(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function i(){this._subscribeToken&&c('PresencePrivacy').unsubscribe(this._subscribeToken);}});f.exports=h;}),null);
__d('ChatTabBlinking',['cx','CSS','setIntervalAcrossTransitions'],(function a(b,c,d,e,f,g,h){'use strict';var i=600,j="highlightTitle",k={_blinkMap:{},_interval:null,_isHighlighting:false,blinkTab:function l(m,n){if(!this._blinkMap[m])this._blinkMap[m]={view:n,elem:n.getTabElem()};this.checkInterval();},unblinkTab:function l(m){if(this._blinkMap[m]){var n=this._blinkMap[m].elem;if(n)c('CSS').removeClass(n,j);delete this._blinkMap[m];}this.checkInterval();},checkInterval:function l(){var m=Object.keys(this._blinkMap).length;if(m>0){if(!this._interval)this._interval=c('setIntervalAcrossTransitions')(this._toggleBlinkHighlight.bind(this),i);}else if(this._interval){clearInterval(this._interval);this._interval=null;}},_toggleBlinkHighlight:function l(){this._isHighlighting=!this._isHighlighting;for(var m in this._blinkMap)if(Object.prototype.hasOwnProperty.call(this._blinkMap,m)){var n=this._blinkMap[m],o=n.elem,p=n.view;if(o&&o.parentNode&&!p.isFocused()&&!p.isHovered()){c('CSS').conditionClass(o,j,this._isHighlighting);}else this.unblinkTab(m);}}};f.exports=k;}),null);
__d('ChatTabLazyFocus',[],(function a(b,c,d,e,f,g){'use strict';var h={_threadID:null,set:function i(j){this._threadID=j;},get:function i(){return this._threadID;},clear:function i(){this._threadID=undefined;}};f.exports=h;}),null);
__d('ChatCollapsedLogMessageGroup.react',['cx','fbt','Link.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;j=babelHelpers.inherits(l,c('React').PureComponent);k=j&&j.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.state={collapsed:true},n;}l.prototype.render=function(){var m=i._("See more"),n=i._("See less");return (c('React').createElement('div',{className:"_5w0o"},i._("New Activities in the Room."),' ',c('React').createElement(c('Link.react'),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed});}.bind(this)},this.state.collapsed?m:n),!this.state.collapsed?c('React').createElement('div',null,c('React').createElement('div',{className:"_2zsu"}),this.props.children,c('React').createElement('div',{className:"_2zsu"})):null));};f.exports=l;}),null);
__d('ChatDateBreak.react',['cx','React','formatDate','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.shouldComponentUpdate=function(m){'use strict';return this.props.date.getTime()!==m.date.getTime();};l.prototype.render=function(){'use strict';var m=c('formatDate')(this.props.date,{today:'g:ia',withinWeek:'D g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});return (c('React').createElement('time',{className:c('joinClasses')(this.props.className,"_5w-5")},c('React').createElement('span',{className:"_5w-6"},m)));};function l(){'use strict';i.apply(this,arguments);}l.propTypes={date:k.instanceOf(Date).isRequired};f.exports=l;}),null);
__d('ChatMessage.react',['cx','fbt','BootloadedComponent.react','ChatAnimatedGifs','ChatBubble.react','EmojiLikeUtils','FluxContainer','MercuryTimestamp','CSS','immutable','ImmutableObject','JSResource','MercuryAttachment','MercuryConfig','MercuryErrorInfo','MercuryIDs','MercuryMessageCustomizations','MercuryMessageError.react','MercuryMessageInfo','MessageBorderType','MessageCustomizationType','MessagingGiftWrapChecker','MessengerDecorator','MessengerInnerDecorators.react','MessengerVideoAutoplayStore','ChatCodePasteUtils','MNCommerceMessageType','MercuryDisplayTimeFilterMessageRenderer','React','ReactDOM','TooltipData','XUISpinner.react','convertMIGColorToFIGColor','isRTL','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={isVisible:false},this.$ChatMessage1=function(){return this.setState({hovered:true});}.bind(this),this.$ChatMessage2=function(){return this.setState({hovered:false});}.bind(this),o;}m.getStores=function(){return [c('MessengerVideoAutoplayStore')];};m.calculateState=function(n,o){return {isVisible:c('MessengerVideoAutoplayStore').isVisible(o.message.thread_id,o.message.message_id)};};m.prototype.componentDidMount=function(){c('CSS').conditionClass(c('ReactDOM').findDOMNode(this),"_2cnu",this.isOneLine());};m.prototype.isOneLine=function(){var n=this.props.message;return c('MercuryMessageInfo').isInbound(n)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps();};m.prototype.shouldComponentUpdate=function(n,o){var p=n.message!==this.props.message,q=false,r=false,s=this.props.thread;if(s){q=s.custom_like_icon!==n.thread.custom_like_icon;r=s.custom_color!==n.thread.custom_color;}else if(n.thread)return true;return p||q||r||o.isVisible!==this.state.isVisible;};m.prototype.render=function(){var n=this.props.message,o=c('MercuryAttachment').get(n).length>0,p=c('MercuryMessageInfo').isInbound(n),q=c('MercuryIDs').isGroupChat(n.thread_id),r=n.body&&n.body!==''?c('isRTL')(n.body):false,s=c('MercuryErrorInfo').hasErrorStatus(n),t="_5wd4"+(p?' '+"_1nc7":'')+(!p?' '+"_1nc6":'')+(o?' '+"_2_-t":'')+(p&&q?' '+"_5ysy":'')+(s?' '+"_1zcs":'')+(r?' '+"direction_rtl":'')+(!r?' '+"direction_ltr":''),u=this.props,v=u.isFromViewer,w=u.participants,x=[],y=n;if(y)c('MessengerDecorator').getBeforeDecorators().forEach(function(z){if(z.check(y))x.push(z.render(y,v));});return c('React').createElement('div',{className:c('joinClasses')(this.props.className,t),onMouseEnter:this.$ChatMessage1,onMouseLeave:this.$ChatMessage2},c('React').createElement('div',{className:"_h8t"},x,this.$ChatMessage3()),c('React').createElement(c('MessengerInnerDecorators.react'),{message:n,isFromViewer:this.props.isFromViewer||false,hovered:this.state.hovered,messageProps:this.props}),this.$ChatMessage4(y,v),this.$ChatMessage5());};m.prototype.$ChatMessage3=function(){var n=this.props.message,o={};if(c('MercuryMessageInfo').isOutbound(n)){var p=i._("{time}",[i.param('time',c('MercuryTimestamp').getPreciseTimestamp(n.timestamp))]);Object.assign(o,c('TooltipData').propsFor(p,'right'));}if(n.is_filtered_content)return c('React').createElement('div',babelHelpers['extends']({className:"_5wd9"+(' '+"_5wdc")+(' '+"uiBoxYellow")+(' '+"clearfix"),ref:'inner'},o),c('MercuryDisplayTimeFilterMessageRenderer').renderFilteredContent(n));return c('React').createElement('div',babelHelpers['extends']({className:"_5wd9",ref:'inner'},o),this.$ChatMessage6(),this.$ChatMessage7('outside'));};m.prototype.$ChatMessage4=function(n,o){var p,q=this;if(n){var p=function(){var r=[],s=[];c('MessengerDecorator').getAfterExternalDecorators().forEach(function(u){if(n&&u.check(n)){r.push(u.render(n,o,this.props));s.push(u.getAdditionalClassNames());}}.bind(q));if(s.length===0&&r.length===0)return {v:null};var t=s.join(' ');return {v:c('React').createElement('div',{className:c('joinClasses')(t,"_5ijz"+(!o?' '+"isFromOther":''))},r)};}();if(typeof p==="object")return p.v;}return null;};m.prototype.$ChatMessage5=function(){var n=this.props.message;if(n.is_filtered_content||!c('MercuryMessageInfo').hasError(n))return null;return c('React').createElement('div',{className:"_3ry4",ref:'undertext'},c('React').createElement(c('MercuryMessageError.react'),{className:"_5wda clearfix",message:n,ref:'status'}),this.$ChatMessage8());};m.prototype.$ChatMessage8=function(){return this.props.message.is_spoof_warning?c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('span',null),bootloadLoader:c('JSResource')('MercurySpoofWarning.react').__setRef('ChatMessage.react'),authorID:this.props.message.author,className:"_5wdb"}):null;};m.prototype.$ChatMessage9=function(){return c('React').createElement('div',{style:{padding:'20px',text_align:'center'}},c('React').createElement(c('XUISpinner.react'),null));};m.prototype.$ChatMessage7=function(n){if(this.props.message.commerce_message_type===c('MNCommerceMessageType').RIDE_INTENT)return null;var o=this.props.message,p=this.props.thread?this.props.thread.custom_like_icon:null,q=n=='inside'?'attachmentsInside':'attachmentsOutside',r=c('MercuryAttachment').get(o).filter(function(v){var w=c('MercuryAttachment').isBubblePreferred(v);return w&&n==='inside'||!w&&n==='outside';}),s=this.props.thread?c('convertMIGColorToFIGColor')(this.props.thread.custom_color):'',t=[],u=[];if(o)c('MessengerDecorator').getAfterDecorators().forEach(function(v){if(v.check(o,this.props.thread)){t.push(v.render(o,this.props.isFromViewer,this.props));u.push(v.getAdditionalClassNames());}}.bind(this));if(r.length>0)return c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:this.$ChatMessage9(),bootloadLoader:c('JSResource')('MercuryAttachments.react').__setRef('ChatMessage.react'),className:c('joinClasses')((n==='outside'?"_3e7u":'')+(!!o.body?' '+"_16ys":'')+(!!s?' '+"_3al":'')+(' '+"_n4o"),u),attachments:r,customLike:p,customColor:s,hasFlowerBorder:c('MercuryConfig').WWWMessengerFlowerBorderViewer&&c('MercuryMessageCustomizations').getCustomizationValue(o,c('MessageCustomizationType').BORDER)===c('MessageBorderType').FLOWERS&&n==='outside',isChat:true,isGiftWrapped:c('MessagingGiftWrapChecker').shouldRenderWithGiftWrap(o)&&n==='outside',afterDecorators:t,isVisible:this.state.isVisible,maxWidth:this.props.maxBubbleWidth,message:o,onUnwrap:this.$ChatMessage10,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:q});return null;};m.prototype.$ChatMessage6=function(){var n=this.props,o=n.isFromViewer,p=n.message,q=n.thread,r=p.body,s=this.$ChatMessage7('inside'),t=[],u=[],v=[],w=p;if(w){c('MessengerDecorator').getAfterDecorators().forEach(function(z){if(z.check(w,q)){t.push(z.render(w,o,this.props));u.push(z.getAdditionalClassNames());}}.bind(this));c('MessengerDecorator').getInsideDecorators().forEach(function(z){if(z.check(w,q)){v.push(z.render(w,o,this.props));u.push(z.getAdditionalClassNames());}}.bind(this));c('MessengerDecorator').getBeforeDecorators().forEach(function(z){if(z.check(w,q))u.push(z.getAdditionalClassNames());});}var x=u.join(' ');if(c('ChatAnimatedGifs').shouldHideBody(p))r='';var y=p.ranges;if(p.profile_ranges&&p.profile_ranges.length)y=(y||[]).concat(p.profile_ranges.map(function(z){return babelHelpers['extends']({},z,{url:'/'+z.id});}));if(c('ChatCodePasteUtils').containsCodeBlock(r))return c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{height:22}}),bootloadLoader:c('JSResource')('ChatCodeBubble.react').__setRef('ChatMessage.react'),body:r,className:"_5wdf",maxWidth:this.props.maxBubbleWidth,ranges:y,threadID:p.thread_id,customColor:q&&o?c('convertMIGColorToFIGColor')(q.custom_color):''});if(r||s)return c('React').createElement('div',{className:c('joinClasses')(x,"_5wde"+(' '+"_n4o"))},c('React').createElement(c('ChatBubble.react'),{attachments:s,body:r,className:"_5wdf",insideDecorators:v,isEmojiLike:c('EmojiLikeUtils').isEmojiLike(p),isFromViewer:this.props.isFromViewer,metaRanges:p.meta_ranges,message:p,maxWidth:this.props.maxBubbleWidth,ranges:y,ref:'bubble',threadID:p.thread_id,customLike:p.customLike,customColor:q&&o?c('convertMIGColorToFIGColor')(q.custom_color):'',threadCustomColor:q&&c('convertMIGColorToFIGColor')(q.custom_color)}),t);return null;};m.propTypes={message:l.instanceOf(c('ImmutableObject')).isRequired,maxBubbleWidth:l.number.isRequired,onAttachmentLoad:l.func,onStickerClick:l.func,participants:l.instanceOf(c('immutable').Map).isRequired,readReceipts:l.instanceOf(c('immutable').OrderedMap).isRequired,thread:l.instanceOf(c('ImmutableObject'))};f.exports=c('FluxContainer').create(m,{withProps:true});}),null);
__d('ChatMessageGroup.react',['cx','fbt','ChatConfig','ChatDateBreak.react','ChatMessage.react','Image.react','immutable','ImmutableObject','MercuryConfig','MercuryIDs','MercuryParticipants','MercuryTimestamp','MessengerTextWithEmoticons.react','React','ReactDOM','StoreAndPropBasedStateMixin'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('immutable').OrderedMap,k=c('React').PropTypes,l=new (c('ImmutableObject'))({name:'',href:'#',image_src:''}),m=c('ChatConfig').get('chattab_rounded_profile',false),n=c('React').createClass({displayName:'ChatMessageGroup',mixins:[c('StoreAndPropBasedStateMixin')(c('MercuryParticipants'))],propTypes:{activeMessageID:k.string,author:k.string,hasDateBreak:k.bool,isCanonical:k.bool,isFromViewer:k.bool,isPageMessage:k.bool,maxBubbleWidth:k.number,messages:k.instanceOf(c('immutable').List).isRequired,readReceipts:k.instanceOf(j).isRequired,onAttachmentLoad:k.func,onStickerClick:k.func,thread:k.instanceOf(c('ImmutableObject')),threadID:k.string},statics:{calculateState:function p(q){return {participants:o(q)};}},shouldComponentUpdate:function p(q,r){return (this.props.activeMessageID!==q.activeMessageID||this.props.isFromViewer!==q.isFromViewer||!c('immutable').is(this.props.messages,q.messages)||!c('immutable').is(this.state.participants,r.participants)||!c('immutable').is(this.props.thread,q.thread));},render:function p(){return (c('React').createElement('div',{className:"_4tdt"+(this.props.isFromViewer?' '+"_ua0":'')+(!this.props.isFromViewer?' '+"_ua1":'')+(this._hasSeenHeadsAtBottom()?' '+"_3lil":'')},this._renderProfileColumn(),c('React').createElement('div',{className:"_ua2"},this._renderName(),c('React').createElement('div',{className:"_4tdv"},this._renderMessages()))));},_renderProfileColumn:function p(){if(this.props.isFromViewer)return null;var q=this.state.participants.get(this.props.author)||l,r=i._("{name} {time}",[i.param('name',q.name),i.param('time',c('MercuryTimestamp').getPreciseTimestamp(this.props.messages.last().timestamp))]),s=q.image_src?c('React').createElement(c('Image.react'),{src:q.image_src}):null;return (c('React').createElement('div',{className:"_31o4"+(m?' '+"_3njy":'')},c('React').createElement('a',{'aria-label':r,className:"_4tdw",'data-hover':'tooltip','data-tooltip-content':r,'data-tooltip-position':'left',href:q.href,ref:'link'},s)));},_renderName:function p(){if(this.props.isCanonical||this.props.isFromViewer)return null;var q=this.state.participants.get(this.props.messages.first().author);if(!q)return null;var r=q.short_name;if(this.props.thread&&this.props.thread.custom_nickname){var s=c('MercuryIDs').getUserIDFromParticipantID(q.id);if(this.props.thread.custom_nickname[s])r=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:this.props.thread.custom_nickname[s]});}return (c('React').createElement('div',{className:"_4tdx"},r));},_renderMessages:function p(){var q=this.props.messages.size,r=[];this.props.messages.forEach(function(s,t,u){var v=s.message_id===this.props.activeMessageID;if(v&&!(t===0&&this.props.hasDateBreak))r.push(c('React').createElement(c('ChatDateBreak.react'),{date:new Date(s.timestamp),key:'db:'+s.message_id}));r.push(c('React').createElement(c('ChatMessage.react'),{isFromViewer:this.props.isFromViewer,key:s.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:s,participants:this.state.participants,readReceipts:this.props.readReceipts,ref:s.message_id,nextTimestamp:this._getNextTimestamp(u,q,t),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread}));}.bind(this));return r;},_hasSeenHeadsAtBottom:function p(){var q=this.props,r=q.messages,s=q.nextTimestamp,t=q.readReceipts,u=r.last().timestamp,v=0;t.forEach(function(w){if(w>=u&&w<s)if(++v===2)return false;return null;});return v===2;},_getNextTimestamp:function p(q,r,s){return s<r-1?q.get(s+1).timestamp:this.props.nextTimestamp;},getMessageElement:function p(q){return c('ReactDOM').findDOMNode(this.refs[q]);}});function o(p){return c('immutable').Map().withMutations(function(q){p.readReceipts.forEach(function(r,s){q.set(s,c('MercuryParticipants').getOrFetch(s));});q.set(p.author,c('MercuryParticipants').getOrFetch(p.author));});}f.exports=n;}),null);
__d('MercuryMessageRendererUtils',['cx','invariant','HovercardLink','MercuryViewer','MessengerTextWithEmoticons.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j={getLinkToParticipant:function k(l,m){var n=l.fbid,o=c('HovercardLink').constructEndpoint({id:n}),p=m&&m.custom_nickname&&m.custom_nickname[n];if(p)p=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:p});var q=p?p:l.name;if(l.href)return (c('React').createElement('a',{className:"_5wzt",href:l.href,'data-hovercard':o},q));return q;},moveCurrentUserToFront:function k(){var l=arguments.length<=0||arguments[0]===undefined?[]:arguments[0];l||i(0);var m=l.indexOf(c('MercuryViewer').getID());if(m>0){var n=l.filter(function(o){return o!==c('MercuryViewer').getID();});return [c('MercuryViewer').getID()].concat(n);}return l;}};f.exports=j;}),null);
__d('MercuryLogMessageRenderer',['cx','fbt','invariant','ix','Bootloader','CSS','Image.react','MercuryAttachmentViewer','MercuryViewer','MercuryLogMessageType','MessengerAdminGroupUtils','MessengerLightweightActionUtils','MessengerTextWithEmoticons.react','MercuryParticipants','React','ReactDOM','MercuryMessageRendererUtils','MercuryThreads','TooltipLink.react','UserAgent','convertMIGColorToFIGColor'],(function a(b,c,d,e,f,g,h,i,j,k){'use strict';var l=c('MercuryThreads').get(),m={renderText:function ba(ca,da,ea,fa){da=da||l.getThreadMetaNow(ca.thread_id);if(c('MessengerLightweightActionUtils').isLWAMessage(ca)){fa(c('MessengerLightweightActionUtils').getCollapsedLWAText(ca));return;}switch(ca.log_message_type){case c('MercuryLogMessageType').SUBSCRIBE:var ga=ca.author;ca.log_message_data||j(0);var ha=ca.log_message_data.added_participants;ha||j(0);var ia=ha.length===1&&ga===ha[0];if(ia){c('Bootloader').loadModules(["MercuryJoinableMessageRenderer"],function(ka){ka.renderText(ca,da,fa);},'MercuryLogMessageRenderer');}else p(ca,fa);break;case c('MercuryLogMessageType').UNSUBSCRIBE:if(c('MessengerAdminGroupUtils').isJoinableThread(da)){v(ca,fa);}else u(ca,fa);break;case c('MercuryLogMessageType').THREAD_NAME:if(c('MessengerAdminGroupUtils').isJoinableThread(da)){w(ca,da,fa);}else x(ca,da,fa);break;case c('MercuryLogMessageType').THREAD_IMAGE:if(c('MessengerAdminGroupUtils').isJoinableThread(da)){y(ca,da,fa);}else z(ca,da,fa);break;case c('MercuryLogMessageType').WALLPAPER:aa(ca,fa);break;case c('MercuryLogMessageType').GENERIC_ADMIN_TEXT:var ja=c('convertMIGColorToFIGColor')(da&&da.custom_color);c('Bootloader').loadModules(["MercuryXMATRenderer"],function(ka){fa(ka.renderText(ja,ca,ea));},'MercuryLogMessageRenderer');break;default:c('Bootloader').loadModules(["MercurySpecialLogMessageRenderer"],function(ka){ka.renderText(ca,fa);},'MercuryLogMessageRenderer');break;}},renderIcon:function ba(ca){return (c('React').createElement(c('Image.react'),{className:n(ca.log_message_type,ca.log_message_data),src:k("99239")}));},renderLegacy:function ba(ca,da,ea,fa){n(fa.log_message_type,fa.log_message_data).split(' ').forEach(function(ga){return ga&&c('CSS').addClass(ca,ga);});this.renderText(fa,null,false,function(ga){c('ReactDOM').render(c('React').createElement('span',null,ga),da);});this.renderAttachmentLegacy(ea,fa);},renderAttachmentLegacy:function ba(ca,da){var ea;if(da.log_message_type===c('MercuryLogMessageType').THREAD_IMAGE)(function(){da.log_message_data||j(0);var fa=da.log_message_data.image;if(fa&&fa.preview_url){c('ReactDOM').render(c('React').createElement(c('Image.react'),{className:"_z6a",onClick:function ga(){return o(fa);},src:fa.preview_url}),ca);c('CSS').show(ca);}})();}};f.exports=m;function n(ba,ca){var da=!!(ca&&ca.answered);return "_5wzu"+(ba===c('MercuryLogMessageType').SUBSCRIBE?' '+"_5wzj":'')+(ba===c('MercuryLogMessageType').UNSUBSCRIBE?' '+"_5wzk":'')+(ba===c('MercuryLogMessageType').THREAD_NAME?' '+"_5wzl":'')+(ba===c('MercuryLogMessageType').THREAD_IMAGE?' '+"_5wzm":'')+(ba===c('MercuryLogMessageType').VIDEO_CALL&&da?' '+"_5wzn":'')+(ba===c('MercuryLogMessageType').VIDEO_CALL&&!da?' '+"_5wzo":'')+(ba===c('MercuryLogMessageType').PHONE_CALL&&da?' '+"_5wzp":'')+(ba===c('MercuryLogMessageType').PHONE_CALL&&!da?' '+"_5wzq":'')+(ba===c('MercuryLogMessageType').SERVER_ERROR?' '+"_5wzr":'')+(!ba?' '+"_2r5l":'');}function o(ba){c('MercuryAttachmentViewer').bootstrapWithConfig({src:ba.preview_url,endpoint:ba.url,fbid:ba.metadata.fbid,dimensions:ba.metadata.dimensions,disablePaging:true},null);}function p(ba,ca){ba.log_message_data||j(0);var da=c('MercuryMessageRendererUtils').moveCurrentUserToFront(ba.log_message_data.added_participants);da||j(0);switch(da.length){case 1:q(ba,ca,da);break;case 2:r(ba,ca,da);break;case 3:s(ba,ca,da);break;default:t(ba,ca,da);break;}}function q(ba,ca,da){var ea=[ba.author,da[0]];c('MercuryParticipants').getMulti(ea,function(fa){if(ba.author===c('MercuryViewer').getID()){ca(i._("You added {subscriber1}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]]))]));}else if(da[0]===c('MercuryViewer').getID()){ca(i._("{actor} added you.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author]))]));}else ca(i._("{actor} added {subscriber1}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]]))]));});}function r(ba,ca,da){var ea=[ba.author].concat(da);c('MercuryParticipants').getMulti(ea,function(fa){if(ba.author===c('MercuryViewer').getID()){ca(i._("You added {subscriber1} and {subscriber2}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]]))]));}else if(da[0]===c('MercuryViewer').getID()){ca(i._("{actor} added you and {subscriber2}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]]))]));}else ca(i._("{actor} added {subscriber1} and {subscriber2}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]]))]));});}function s(ba,ca,da){var ea=[ba.author].concat(da);c('MercuryParticipants').getMulti(ea,function(fa){if(ba.author===c('MercuryViewer').getID()){ca(i._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[2]]))]));}else if(da[0]===c('MercuryViewer').getID()){ca(i._("{actor} added you, {subscriber2} and {subscriber3}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[2]]))]));}else ca(i._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[0]])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[1]])),i.param('subscriber3',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[da[2]]))]));});}function t(ba,ca,da){var ea=[ba.author].concat(da);c('MercuryParticipants').getMulti(ea,function(fa){function ga(ia){var ja=c('React').createElement('div',null,ia.map(function(ka){return c('React').createElement('div',null,ka.name);}));return (c('React').createElement(c('TooltipLink.react'),{alignH:'center',position:'above',tooltip:ja},i._({"*":"{num} more"},[i.param('num',ia.length,[0])])));}var ha=da.map(function(ia){return fa[ia];});if(ba.author===c('MercuryViewer').getID()){ca(i._("You added {subscriber1}, {subscriber2} and {more_people}.",[i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ha[0])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ha[1])),i.param('more_people',ga(ha.slice(2)))]));}else if(da[0]===c('MercuryViewer').getID()){ca(i._("{actor} added you, {subscriber2} and {more_people}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ha[1])),i.param('more_people',ga(ha.slice(2)))]));}else ca(i._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(fa[ba.author])),i.param('subscriber1',c('MercuryMessageRendererUtils').getLinkToParticipant(ha[0])),i.param('subscriber2',c('MercuryMessageRendererUtils').getLinkToParticipant(ha[1])),i.param('more_people',ga(ha.slice(2)))]));});}function u(ba,ca){var da=[ba.author];ba.log_message_data||j(0);var ea=ba.log_message_data.removed_participants;ea||j(0);var fa=void 0;if(ea.length===1){fa=ea[0];da.push(fa);}c('MercuryParticipants').getMulti(da,function(ga){var ha=ga[ba.author],ia=ga[fa];if(ba.author===c('MercuryViewer').getID()){if(!fa||fa===ba.author){ca(i._("You left the conversation."));}else ca(i._("You removed {name} from the conversation.",[i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ia))]));}else if(!fa||fa===ba.author){ca(i._("{actor} left the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha))]));}else if(fa===c('MercuryViewer').getID()){ca(i._("{actor} removed you from the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha))]));}else ca(i._("{actor} removed {name} from the conversation.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha)),i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ia))]));});}function v(ba,ca){var da=[ba.author];ba.log_message_data||j(0);var ea=ba.log_message_data.removed_participants;ea||j(0);var fa=void 0;if(ea.length===1){fa=ea[0];da.push(fa);}c('MercuryParticipants').getMulti(da,function(ga){var ha=ga[ba.author],ia=ga[fa];if(ba.author===c('MercuryViewer').getID()){if(!fa||fa===ba.author){ca(i._("You left the room."));}else ca(i._("You removed {name} from the room.",[i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ia))]));}else if(!fa||fa===ba.author){ca(i._("{actor} left the room.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha))]));}else if(fa===c('MercuryViewer').getID()){ca(i._("{actor} removed you from the room.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha))]));}else ca(i._("{actor} removed {name} from the room.",[i.param('actor',c('MercuryMessageRendererUtils').getLinkToParticipant(ha)),i.param('name',c('MercuryMessageRendererUtils').getLinkToParticipant(ia))]));});}function w(ba,ca,da){ba.log_message_data||j(0);var ea=ba.log_message_data.name,fa="_5wzs"+(c('UserAgent').isBrowser('Chrome')?' '+"_4fbd":'');if(ba.author===c('MercuryViewer').getID()){if(ea){var ga=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:ea});da(i._("You named the room: {name}.",[i.param('name',c('React').createElement('span',{className:fa},ga))]));}else da(i._("You removed the room name."));}else c('MercuryParticipants').get(ba.author,function(ha){var ia=c('MercuryMessageRendererUtils').getLinkToParticipant(ha,ca);if(ea){var ja=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:ea});da(i._("{actor} named the room: {name}.",[i.param('actor',ia),i.param('name',c('React').createElement('span',{className:fa},ja))]));}else da(i._("{actor} removed the room name.",[i.param('actor',ia)]));});}function x(ba,ca,da){ba.log_message_data||j(0);var ea=ba.log_message_data.name,fa="_5wzs"+(c('UserAgent').isBrowser('Chrome')?' '+"_4fbd":'');if(ba.author===c('MercuryViewer').getID()){if(ea){var ga=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:ea});da(i._("You named the conversation: {name}.",[i.param('name',c('React').createElement('span',{className:fa},ga))]));}else da(i._("You removed the conversation name."));}else c('MercuryParticipants').get(ba.author,function(ha){var ia=c('MercuryMessageRendererUtils').getLinkToParticipant(ha,ca);if(ea){var ja=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoticons:true,renderEmoji:true,text:ea});da(i._("{actor} named the conversation: {name}.",[i.param('actor',ia),i.param('name',c('React').createElement('span',{className:fa},ja))]));}else da(i._("{actor} removed the conversation name.",[i.param('actor',ia)]));});}function y(ba,ca,da){if(ba.author===c('MercuryViewer').getID()){ba.log_message_data||j(0);if(ba.log_message_data.image){da(i._("You changed the room picture."));}else da(i._("You removed the room picture."));}else c('MercuryParticipants').get(ba.author,function(ea){var fa=c('MercuryMessageRendererUtils').getLinkToParticipant(ea,ca);ba.log_message_data||j(0);if(ba.log_message_data.image){da(i._("{actor} changed the room picture.",[i.param('actor',fa)]));}else da(i._("{actor} removed the room picture.",[i.param('actor',fa)]));});}function z(ba,ca,da){if(ba.author===c('MercuryViewer').getID()){ba.log_message_data||j(0);if(ba.log_message_data.image){da(i._("You changed the conversation picture."));}else da(i._("You removed the conversation picture."));}else c('MercuryParticipants').get(ba.author,function(ea){var fa=c('MercuryMessageRendererUtils').getLinkToParticipant(ea,ca);ba.log_message_data||j(0);if(ba.log_message_data.image){da(i._("{actor} changed the conversation picture.",[i.param('actor',fa)]));}else da(i._("{actor} removed the conversation picture.",[i.param('actor',fa)]));});}function aa(ba,ca){if(ba.author===c('MercuryViewer').getID()){ca(i._("You changed the wallpaper."));}else c('MercuryParticipants').get(ba.author,function(da){var ea=c('MercuryMessageRendererUtils').getLinkToParticipant(da);ca(i._("{actor} changed the wallpaper.",[i.param('actor',ea)]));});}}),null);
__d('MercuryLogMessage.react',['cx','fbt','DOM','DOMDimensions','Event','EventReminderRequestHelper','ImmutableObject','MercuryLogMessageRenderer','MercuryConfig','MercuryLogMessageType','MessagingGenericAdminTextType','React','cancelAnimationFrame','emptyFunction','formatDate','joinClasses','requestAnimationFrame','requireWeak'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={messageText:null,showEventReminderFlyout:false},this.$MercuryLogMessage3=function(){this.$MercuryLogMessage4();}.bind(this),this.$MercuryLogMessage8=function(){if(!this.state.showEventReminderFlyout){c('EventReminderRequestHelper').fetchEventReminder(this.props.thread.thread_id,this.props.thread.lightweight_event.oid,function(){this.setState({showEventReminderFlyout:true});}.bind(this));}else this.setState({showEventReminderFlyout:false});}.bind(this),this.$MercuryLogMessage10=function(s){if(s!==this.state.showEventReminderFlyout)this.setState({showEventReminderFlyout:s});}.bind(this),o;}m.prototype.componentDidMount=function(){this.componentWillReceiveProps(this.props);};m.prototype.componentWillUnmount=function(){if(this.$MercuryLogMessage1)c('cancelAnimationFrame')(this.$MercuryLogMessage1);};m.prototype.$MercuryLogMessage2=function(){return c('React').createElement('a',{onClick:this.$MercuryLogMessage3,role:'button',tabIndex:'0'},i._("Show previous messages."));};m.prototype.$MercuryLogMessage4=function(){var n=this.props.loadMoreMessages&&this.props.loadMoreMessages();if(n){this.setState({messageText:this.$MercuryLogMessage2()});}else{var o=i._("Couldn't find previous messages.");this.setState({messageText:o});}};m.prototype.componentWillReceiveProps=function(n){if(n.message.log_message_type===c('MercuryLogMessageType').SERVER_ERROR){!c('MercuryConfig').FantaTabView&&this.$MercuryLogMessage4();return;}c('MercuryLogMessageRenderer').renderText(n.message,n.thread,n.isLastOfType,function(o){this.setState({messageText:o});}.bind(this));};m.prototype.shouldComponentUpdate=function(n,o){return this.state.messageText!=o.messageText||n.maxWidth!==this.props.maxWidth||this.state.showEventReminderFlyout!==o.showEventReminderFlyout;};m.prototype.componentDidUpdate=function(){this.$MercuryLogMessage5();if(!this.refs.attachment)return;c('MercuryLogMessageRenderer').renderAttachmentLegacy(this.refs.attachment,this.props.message);c('DOM').scry(this.refs.wrap,'img').forEach(function(n){var o=c('Event').listen(n,'load',function(){this.$MercuryLogMessage5();o.remove();}.bind(this));}.bind(this));};m.prototype.render=function(){return c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_5ye6"),ref:'wrap',style:babelHelpers['extends']({},this.props.style,this.$MercuryLogMessage6()),title:c('formatDate')(new Date(this.props.message.timestamp),'g:ia')}),c('React').createElement('div',{className:"_5ye7"},c('MercuryLogMessageRenderer').renderIcon(this.props.message),this.state.messageText),c('React').createElement('div',{className:"_5ye8",ref:'attachment'},this.$MercuryLogMessage7()));};m.prototype.$MercuryLogMessage7=function(){if(this.props.thread&&!this.props.thread.lightweight_event||!this.props.message.log_message_data)return null;var n=void 0;c('requireWeak')('EventReminderStateStore',function(r){n=r.getEvent(this.props.thread.thread_id);}.bind(this));if(!n||!n.exists)return null;var o;c('requireWeak')('Link.react',function(r){o=r;});var p=i._("Change"),q=c('React').createElement(o,{href:'#',onClick:this.$MercuryLogMessage8,title:i._("Edit Event"),ref:'event_rem_link'},p);if(this.props.displayItems)q=null;return c('React').createElement('span',null,q,this.$MercuryLogMessage9());};m.prototype.$MercuryLogMessage9=function(){if(!this.state.showEventReminderFlyout)return null;var n={alignment:'right',position:'above',contextRef:function(){return this.refs.event_rem_link;}.bind(this),shown:this.state.showEventReminderFlyout,onToggle:this.$MercuryLogMessage10},o=void 0;c('requireWeak')('EventsActionsLogger',function(s){o=s;});var p={action_history:[{surface:o.Surface.MESSENGER_CHAT_TAB,mechanism:o.Mechanism.REMINDER_ADMIN_TEXT}]},q={threadID:this.props.thread.thread_id,useContextualDialog:true,dialogProps:n,flyoutNoSheet:true,isEditing:true,actionContext:p},r;c('requireWeak')('ChatEventReminderContainer.react',function(s){r=s;});return c('React').createElement(r,q);};m.prototype.$MercuryLogMessage6=function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;};m.prototype.$MercuryLogMessage5=function(){if(this.$MercuryLogMessage1)c('cancelAnimationFrame')(this.$MercuryLogMessage1);this.$MercuryLogMessage1=c('requestAnimationFrame')(function(){this.props.onImageLoad&&this.props.onImageLoad(c('DOMDimensions').getElementDimensions(this.refs.wrap).height);delete this.$MercuryLogMessage1;}.bind(this));};m.propTypes={loadMoreMessages:l.func,maxWidth:l.number,message:l.instanceOf(c('ImmutableObject')).isRequired,onImageLoad:l.func,thread:l.object};m.defaultProps={onImageLoad:c('emptyFunction')};f.exports=m;}),null);
__d('ChatConversation.react',['cx','invariant','ChatCollapsedLogMessageGroup.react','ChatDateBreak.react','ChatMessageGroup.react','immutable','ImmutableObject','MercuryLogMessage.react','MercuryIDs','MercuryRoger','MessageList.react','React','Set','MercuryShareAttachmentRenderLocations','cancelAnimationFrame','requestAnimationFrame'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('MercuryRoger').get(),k=c('immutable').OrderedMap,l=c('React').PropTypes,m=c('React').createClass({displayName:'ChatConversation',_raf:(undefined,Number),_onMountTimeout:(undefined,Number),propTypes:{contextBanner:l.object,isCanonical:l.bool.isRequired,loadMoreMessages:l.func,maxBubbleWidth:l.number.isRequired,messages:l.instanceOf(c('immutable').List).isRequired,onAttachmentLoad:l.func,onMount:l.func,onStickerClick:l.func,viewer:l.string.isRequired,thread:l.object,threadID:l.string.isRequired},componentDidMount:function n(){this._raf=c('requestAnimationFrame')(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount();delete this._onMountTimeout;}.bind(this),0);delete this._raf;}.bind(this));},componentWillUnmount:function n(){if(this._raf)c('cancelAnimationFrame')(this._raf);clearTimeout(this._onMountTimeout);},componentWillReceiveProps:function n(o){o.maxBubbleWidth===this.props.maxBubbleWidth||i(0);},render:function n(){return (c('React').createElement('div',null,this.props.contextBanner,c('React').createElement(c('MessageList.react'),{DateBreak:c('ChatDateBreak.react'),LogMessage:c('MercuryLogMessage.react'),MessageGroup:c('ChatMessageGroup.react'),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:c('MercuryShareAttachmentRenderLocations').CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,CollapsedLogMessageGroup:c('ChatCollapsedLogMessageGroup.react'),messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,readReceipts:this._calculateReceipts(this.props),ref:'messageList',viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID})));},_calculateReceipts:function n(o){var p=c('MercuryIDs').getParticipantIDFromUserID(o.viewer),q=j.getSeenTimestamps(o.threadID),r=new (c('Set'))(o.thread?o.thread.participants:q.keys());r['delete'](p);return q.withMutations(function(s){c('immutable').Seq(o.messages).reverse().forEach(function(t){if(r.size===0)return false;if(!r.has(t.author))return null;s.update(t.author,function(u){if(!u||u.watermark<=t.timestamp)return {watermark:t.timestamp,action:t.timestamp};return u;});r['delete'](t.author);return null;});});},getMessageList:function n(){return this.refs.messageList;}});f.exports=m;}),null);
__d('MercuryCamQuickReply.react',['cx','fbt','BootloadedComponent.react','JSResource','MercuryIDs','MercuryThreads','MessengerQuickCamOrigins','React','XUISpinner.react','convertMIGColorToFIGColor'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('MercuryThreads').get(),m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;n.prototype.componentWillUpdate=function(o,p){if(o&&this.props.lastMessage!==o.lastMessage&&this.props.camQuickReplyWillShow)this.props.camQuickReplyWillShow();};n.prototype.componentDidUpdate=function(o,p){if(o&&this.props.lastMessage!==o.lastMessage&&this.props.camQuickReplyDidShow)this.props.camQuickReplyDidShow();};n.prototype.render=function(){var o=this.props.lastMessage,p=c('MercuryIDs').getParticipantIDFromUserID(this.props.viewer);if(!(o&&o.message_source&&o.author!==p&&o.message_source==='camera'))return null;var q=l.getThreadMetaNow(this.props.threadID),r=q?c('convertMIGColorToFIGColor')(q.custom_color):null,s=c('React').createElement('div',{className:"_zdf",style:r&&{color:r}},i._("Send a photo reply"));return (c('React').createElement('div',{className:"_zdg"},c('React').createElement(c('BootloadedComponent.react'),{bootloadLoader:c('JSResource')('MessengerQuickCamButtonHTML5.react').__setRef('MercuryCamQuickReply.react'),bootloadPlaceholder:c('React').createElement(c('XUISpinner.react'),{className:"_5h-9"}),className:"_5yhk"+(' '+"_6gb"),location:c('MessengerQuickCamOrigins').CHAT_TAB,threadID:this.props.threadID,viewer:this.props.viewer,textChild:s})));};function n(){j.apply(this,arguments);}n.propTypes={camQuickReplyWillShow:m.func,camQuickReplyDidShow:m.func,lastMessage:m.object,threadID:m.string.isRequired,viewer:m.string.isRequired};f.exports=n;}),null);
__d('MercuryIndicatorController',['fbt','ArbiterMixin','DOM','MercuryActionType','MercuryDelayedRoger','MercuryIDs','MercuryMessageSourceTags','MercuryParticipants','MercuryRoger','MercurySourceType','MercuryThreads','MercuryTypingReceiver','MercuryViewer','WorkModeConfig','arrayContains','formatDate','removeFromArray'],(function a(b,c,d,e,f,g,h){var i=c('MercuryDelayedRoger').get(),j=c('MercuryRoger').get(),k=c('MercuryThreads').get(),l=c('MercuryTypingReceiver').get(),m=[];function n(o){this._threadID=o;this._canonicalUser=c('MercuryIDs').getUserIDFromThreadID(o);m.push(this);}Object.assign(n.prototype,c('ArbiterMixin'),{destroy:function o(){c('removeFromArray')(m,this);},setLastMessage:function o(p){this._lastMsg=p;this._handleStateChange();},_informStateChanged:function o(p){if(p.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&this._lastMsg.author&&c('MercuryViewer').isViewer(this._lastMsg.author))p.self_authored=true;this._currentActivity=p.activity;this.inform('state-changed',p);},_notifySentFrom:function o(){var p,q,r=this._lastMsg.source_tags||this._lastMsg.tags||[];if(c('arrayContains')(r,c('MercuryMessageSourceTags').MESSENGER)){if(!c('WorkModeConfig').is_work_user){p=c('DOM').create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},h._("Sent from Messenger"));}else p=c('DOM').create('a',{href:'https://work.fb.com/workchat/','class':'fcg',target:'_blank'},h._("Sent from Work Chat"));q='sentFromMobile';}else if(c('arrayContains')(r,c('MercuryMessageSourceTags').MOBILE)){p=c('DOM').create('a',{href:'/mobile','class':'fcg',target:'_blank'},h._("Sent from Mobile"));q='sentFromMobile';}else if(c('arrayContains')(r,c('MercuryMessageSourceTags').EMAIL)){p=h._("Sent from email");q='sentFromEmail';}else if(c('arrayContains')(r,c('MercurySourceType').MESSENGER_COMMERCE)){q='sentFromMessengerCommerce';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:q,text:p});},_notifySeenTimestamp:function o(p){var q=Date.now()*.001,r=j.getSeenTimestamp(this._threadID,p[0]),s=r.action*.001,t;if(s<q-518400){t='M j';}else if(s<q-86400){t='D g:ia';}else t='g:ia';this._informStateChanged({activity:'seen-timestamp',text:h._("Seen {timestamp}",[h.param('timestamp',c('formatDate')(s,t))])});},_nameNormalizer:function o(p){var q;c('MercuryParticipants').getMulti(p,function(r){function s(u){if(r[u]!==undefined&&r[u].short_name){return r[u].short_name.toLowerCase();}else return u;}var t=p.map(s);q=function u(v){var w=s(v),x=t.indexOf(w)!==t.lastIndexOf(w);return x?r[v].name:r[v].short_name;};});return q;},_seenByEveryone:function o(p,q,r){var s=r?r.participants.length:0,t=p.length;if(q.author!=c('MercuryViewer').getID()&&(!r||r.participants.indexOf(q.author)>-1))t++;return s>2&&t>=s-1;},_notifySeenBy:function o(p){var q=this._lastMsg,r=true;c('MercuryParticipants').getMulti(p,function(s){r=false;if(this._lastMsg!=q)return;var t=k.getThreadMetaNow(this._threadID),u=null;if(t&&t.custom_nickname)u=t.custom_nickname;var v=[];for(var w in s){var x=s[w],y=x.short_name;if(u&&u[x.fbid])y=u[x.fbid];v[w]=y;}var z,aa=false;if(this._seenByEveryone(p,q,t)){z={prefix:'Seen by everyone'};}else if(p.length==1){z={prefix:'Seen by ',names:' '+v[p[0]]};}else if(p.length==2){z={prefix:'Seen by ',names:' '+v[p[0]]+', '+v[p[1]]};}else if(p.length==3){z={prefix:'Seen by ',names:' '+v[p[0]]+', '+v[p[1]]+', '+v[p[2]]};}else if(p.length>3){z={prefix:'Seen by ',names:' '+v[p[0]]+', '+v[p[1]]+', '};aa=true;}this._informStateChanged({activity:'seen-by',text:z,seenBy:p,showTooltip:aa});}.bind(this));r&&this._informStateChanged({activity:'none'});},_handleStateChange:function o(){var p=c('MercuryActionType').LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==p){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._informStateChanged({activity:'none'});return;}if(this._canonicalUser&&this._lastMsg.author!=c('MercuryViewer').getID()){this._notifySentFrom();return;}var q=i.getSeenBy(this._threadID,true);if(q.length)if(this._canonicalUser){this._notifySeenTimestamp(q);return;}else{this._notifySeenBy(q);return;}this._informStateChanged({activity:'none'});}});l.addRetroactiveListener('state-changed',function(o){m.forEach(function(p){var q=o[p._threadID];if(q!==undefined){p._typing=q;p._handleStateChange();}});});i.subscribe('state-changed',function(o,p){m.forEach(function(q){p[q._threadID]&&q._handleStateChange();});});f.exports=n;}),null);
__d('MercuryLastMessageIndicator.react',['cx','fbt','DOM','MercuryIndicatorController','MessengerTextWithEmoticons.react','MercuryParticipants','React','ReactDOM','TooltipData','emptyFunction','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=k.constructor).call.apply(n,[this].concat(q)),this.state={data:{}},this.getRootClass=function(){var s="_510g"+(this.state.data.self_authored?' '+"_510e":''),t=this.state.data.activity,u=null;if(String(t).startsWith('seen')){u='seen';}else if(t=='typing'){u=this.props.hideTyping?null:t;}else u=t;return c('joinClasses')(s,u,this.props.className);}.bind(this),this.isVisible=function(s,t){s=s||this.props;t=t||this.state;return (t.data&&t.data.activity!='none'&&!(s.hideTyping&&t.data.activity=='typing'));}.bind(this),this.isSeenBy=function(s,t){s=s||this.props;t=t||this.state;return (t.data&&t.data.activity==='seen-by');}.bind(this),this.setText=function(){if(this.state.data.text)c('DOM').setContent(c('ReactDOM').findDOMNode(this.refs.text),this.state.data.text);}.bind(this),this.setTooltip=function(){if(this.state.data.activity==='seen-by'&&this.state.data.showTooltip)c('MercuryParticipants').getMulti(this.state.data.seenBy,function(s){var t=c('DOM').create('div',null,this.state.data.seenBy.map(function(u){return c('DOM').create('div',null,s[u].name);}));c('TooltipData').set(c('DOM').find(c('ReactDOM').findDOMNode(this),'span.more'),t,'above','center');}.bind(this));}.bind(this),this.$MercuryLastMessageIndicator4=function(s){var t=s&&s.text;if(!t)return null;if(!t.names){return i._("Seen by everyone");}else{var u=c('React').createElement(c('MessengerTextWithEmoticons.react'),{renderEmoji:true,renderEmoticons:true,text:t.names});if(!s.showTooltip){return i._("Seen by {names}",[i.param('names',u)]);}else{var v=this.$MercuryLastMessageIndicator5(s);return i._("Seen by {names}{=num more link}",[i.param('names',u),i.param('=num more link',v)]);}}}.bind(this),this.$MercuryLastMessageIndicator5=function(s){if(!s||!s.text||!s.showTooltip)return null;var t={},u=0;if(s.activity==='seen-by'){var v=null;c('MercuryParticipants').getMulti(s.seenBy,function(x){v=s.seenBy.map(function(y){return x[y].name;}).join('\r\n');u=Object.keys(x).length-2;});t=Object.assign({'data-tooltip-alignh':'center'},c('TooltipData').propsFor(v,'above'));}var w=i._({"*":"{num} more"},[i.param('num',u,[0])]);return (c('React').createElement('span',babelHelpers['extends']({className:'more'},t),w));},this.$MercuryLastMessageIndicator1=function(s){this.$MercuryLastMessageIndicator3=new (c('MercuryIndicatorController'))(s.threadID);this.$MercuryLastMessageIndicator6=this.$MercuryLastMessageIndicator3.subscribe('state-changed',function(t,u){return this.setState({data:u});}.bind(this));s.lastMessage&&this.$MercuryLastMessageIndicator3.setLastMessage(s.lastMessage);}.bind(this),this.$MercuryLastMessageIndicator2=function(){this.$MercuryLastMessageIndicator6.unsubscribe();this.$MercuryLastMessageIndicator3.destroy();}.bind(this),o;}m.prototype.componentDidMount=function(){'use strict';this.$MercuryLastMessageIndicator1(this.props);};m.prototype.componentWillReceiveProps=function(n){'use strict';if(n.threadID!=this.props.threadID){this.$MercuryLastMessageIndicator2();this.$MercuryLastMessageIndicator1(n);}else if(n.lastMessage!=this.props.lastMessage)this.$MercuryLastMessageIndicator3.setLastMessage(n.lastMessage);};m.prototype.componentWillUpdate=function(n,o){'use strict';if(this.isVisible(n,o))this.props.indicatorWillShow();};m.prototype.componentDidUpdate=function(){'use strict';if(!this.isVisible())return;if(!this.isSeenBy()){this.setText();this.setTooltip();}this.props.indicatorDidShow();};m.prototype.componentWillUnmount=function(){'use strict';this.$MercuryLastMessageIndicator2();};m.prototype.render=function(){'use strict';if(this.isSeenBy()){var n=this.$MercuryLastMessageIndicator4(this.state.data);return c('React').createElement('div',{className:this.getRootClass()},c('React').createElement('div',{className:"_510h"}),c('React').createElement('span',{className:"_510f"},n));}else return c('React').createElement('div',{className:this.getRootClass()},c('React').createElement('div',{className:"_510h"}),c('React').createElement('span',{className:"_510f",ref:'text'},'\u00A0'));};m.propTypes={hideTyping:l.bool,indicatorWillShow:l.func,indicatorDidShow:l.func,lastMessage:l.object,threadID:l.string.isRequired};m.defaultProps={indicatorWillShow:c('emptyFunction'),indicatorDidShow:c('emptyFunction')};f.exports=m;}),null);
__d('MercuryQuickReply.react',['cx','BootloadedComponent.react','JSResource','MercuryConfig','MercuryIDs','MNOmniMConstants','OmniMStore','React','XUISpinner.react','FluxContainer'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={suggestions:null,omniMPrefs:null},n;}l.getStores=function(){return [c('OmniMStore')];};l.calculateState=function(m,n){return {suggestions:c('OmniMStore').suggestionsForThread(n.threadID),omniMPrefs:c('OmniMStore').prefs()};};l.prototype.componentWillMount=function(){if(this.props.quickReplyWillShow&&this.$MercuryQuickReply1(this.state))this.props.quickReplyWillShow();};l.prototype.componentDidMount=function(){if(this.props.quickReplyDidShow&&this.$MercuryQuickReply1(this.state))this.props.quickReplyDidShow();};l.prototype.componentWillUpdate=function(m,n){if(this.props.quickReplyWillShow&&n&&this.$MercuryQuickReply1(n)&&!this.$MercuryQuickReply1(this.state))this.props.quickReplyWillShow();};l.prototype.componentDidUpdate=function(m,n){if(this.props.quickReplyDidShow&&this.$MercuryQuickReply1(this.state)&&!this.$MercuryQuickReply1(n))this.props.quickReplyDidShow();};l.prototype.render=function(){var m=this.props.lastMessage;if(!m)return null;var n=null,o=null,p=c('MercuryIDs').getParticipantIDFromUserID(this.props.viewer),q=this.state.suggestions||{},r=q.quickReplies,s=q.agentSuggestions;if(r&&r.length&&m.author!==p){n=r;o=c('MNOmniMConstants').QUICKREPLIES;}else if(s&&s.length&&c('MercuryConfig').EnableOmniM){n=s;o=c('MNOmniMConstants').OMNIM;}if(!n||!n.length||!n.filter(function(t){return !t.dismissed;}).length)return null;return (c('React').createElement('div',{className:"_419m",ref:'quickReply'},c('React').createElement(c('BootloadedComponent.react'),{bootloadLoader:c('JSResource')('MessengerBotsQuickReplyButtonList.react').__setRef('MercuryQuickReply.react'),bootloadPlaceholder:c('React').createElement(c('XUISpinner.react'),{className:"_5h-9"}),omniMPrefs:this.state.omniMPrefs,options:n,threadID:m.thread_id,source:o})));};l.prototype.$MercuryQuickReply1=function(m){var n=m.suggestions||{},o=n.quickReplies,p=n.agentSuggestions,q=o&&o.length,r=p&&p.length&&c('MercuryConfig').EnableOmniM;return !!(q||r);};l.propTypes={quickReplyWillShow:k.func,quickReplyDidShow:k.func,lastMessage:k.object,threadID:k.string.isRequired,viewer:k.string.isRequired};f.exports=c('FluxContainer').create(l,{withProps:true});}),null);
__d('MessengerContextBannerBootloader',['BootloadedComponent.react','CurrentUser','DOM','JSResource','React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';function h(k,l,m,n,o){var p=c('DOM').create('div');i(k,l,function(q){c('ReactDOM').render(q,p,m(p));},n,o);}function i(k,l,m,n,o,p){p=babelHelpers['extends']({left:0,position:'absolute',right:0,top:0},p);j({otherUserFBIDs:n&&[n],threadID:k,style:p},l,m,o);}function j(k,l,m,n){m(c('React').createElement(c('BootloadedComponent.react'),babelHelpers['extends']({bootloadPlaceholder:c('React').createElement('div',{style:{height:80}}),bootloadLoader:c('JSResource')('MessengerContextBannerContainer.react').__setRef('MessengerContextBannerBootloader'),location:l,onResize:n,viewer:c('CurrentUser').getID()},k)));}f.exports={bootload:h,getBootloadedComponent:i};}),null);
__d('ChatTabMessagesView',['Animation','Arbiter','BanzaiLogger','Bootloader','CSS','ChatConversation.react','ChatPerfInstrumentation','ChatTabViewEvents','ChatTypingIndicators.react','CurrentUser','DOM','Event','immutable','MercuryLastMessageIndicator.react','LiveTimer','MercuryAttachment','MercuryCamQuickReply.react','MercuryConfig','MercuryIDs','MercuryLogMessageType','MercuryQuickReply.react','MercuryThreadInformer','MercuryThreads','MercuryMessageStore','MessengerContextBannerBootloader','MessengerHotLikePreviewEvents','MessengerVideoAutoplayActions','MessengerVideoAutoplayStore','React','ReactComponentRenderer','ReactDOM','MercuryShareAttachmentRenderLocations','Scroll','ServerTime','StickerInterfaces','Style','SubscriptionsHandler','UserAgent_DEPRECATED','emptyFunction','getElementPosition','idx','isEventSupported','throttle'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadInformer').get(),i=c('MercuryThreads').get(),j=79,k=null,l=20;function m(o){if(k===null){var p=o.childNodes[0];c('Style').set(o,'overflow','scroll');k=p.clientWidth-j;c('Style').set(o,'overflow','');}return k;}function n(o,p,q,r,s,t,u,v,w,x,y){this.loadingIcon=s;this.threadID=o;this.sheetController=p;this.scrollContainer=q;this.conversationElem=r;this.contextBannerEligible=w;this.contextBannerElem=null;this.tabView=v;this._shouldTrackBottom=true;c('LiveTimer').restart(c('ServerTime').get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;if(this.threadID&&!i.isEmptyLocalThread(this.threadID))c('CSS').show(this.loadingIcon);function z(){this._clearScrollTimers();this._shouldTrackBottom=false;c('ChatTabViewEvents').inform('interaction-with-tab',this.threadID);}function aa(){this._checkAndSetScrolledToBottom();}function ba(){this._clearScrollTimers();setTimeout(function(){this._checkAndSetScrolledToBottom();}.bind(this),500);}this._subscriptions=new (c('SubscriptionsHandler'))();this._subscriptions.addSubscriptions(c('Arbiter').subscribe('overflow-applied-to-body',function(){return this.trackBottomIfRequired();}.bind(this)),c('Event').listen(this.scrollContainer,'mousedown',z.bind(this)),c('Event').listen(this.scrollContainer,'mouseup',aa.bind(this)));this._initOverflowObserver();var ca=c('isEventSupported')('wheel')?'wheel':c('isEventSupported')('mousewheel')?'mousewheel':'DOMMouseScroll';this._subscriptions.addSubscriptions(c('Event').listen(this.scrollContainer,ca,ba.bind(this)));this._subscriptions.addSubscriptions(c('Event').listen(this.scrollContainer,'scroll',c('throttle')(this.scrolling,50,this)));this._setupScrollInterval();var da=c('CurrentUser').getID();c('ReactDOM').render(c('React').createElement(c('ChatTypingIndicators.react'),{threadID:this.threadID,indicatorsWillShow:c('emptyFunction'),indicatorsDidShow:function(){return this.trackBottomIfRequired(true);}.bind(this),viewer:da}),u);this.lastMessageIndicatorNode=t;this.lastMessageIndicator=new (c('ReactComponentRenderer'))(c('MercuryLastMessageIndicator.react'),this.lastMessageIndicatorNode);this.lastMessageIndicator.setProps({threadID:this.threadID,hideTyping:true,indicatorWillShow:c('emptyFunction'),indicatorDidShow:function(){return this.trackBottomIfRequired(true);}.bind(this)});if(c('MercuryConfig').WebCamQuickReply){this.camQuickReplyNode=y;this.camQuickReply=new (c('ReactComponentRenderer'))(c('MercuryCamQuickReply.react'),this.camQuickReplyNode);this.camQuickReply.setProps({camQuickReplyWillShow:c('emptyFunction'),camQuickReplyDidShow:function(){return this.trackBottomIfRequired(true);}.bind(this),threadID:this.threadID,viewer:da});}if(c('MercuryConfig').EnableQuickReply){this.quickReplyNode=x;this.quickReply=new (c('ReactComponentRenderer'))(c('MercuryQuickReply.react'),this.quickReplyNode);this.quickReply.setProps({threadID:this.threadID,quickReplyWillShow:c('emptyFunction'),quickReplyDidShow:function(){return this.trackBottomIfRequired(true);}.bind(this),viewer:da});}this.initializeConversation();}Object.assign(n.prototype,{initializeConversation:function o(){this._store=new (c('MercuryMessageStore'))(this.threadID);this._conversation=new (c('ReactComponentRenderer'))(c('ChatConversation.react'),this.conversationElem);this._conversation.setProps({isCanonical:c('MercuryIDs').isCanonical(this.threadID),loadMoreMessages:this._loadMoreMessages.bind(this),maxBubbleWidth:m(this.scrollContainer),messages:c('immutable').List(),onAttachmentLoad:function(){return this.trackBottomIfRequired();}.bind(this),onMount:function(){return this.trackBottomIfRequired();}.bind(this),onStickerClick:this._onStickerClick.bind(this),viewer:c('CurrentUser').getID(),threadID:this.threadID});if(c('MercuryIDs').isCanonical(this.threadID))this._hideLoadingIconTimeout=setTimeout(function(){c('CSS').hide(this.loadingIcon);if(this.contextBannerEligible)this.renderContextBanner(this.threadID);}.bind(this),6000);i.getThreadMeta(this.threadID,function(p){this._conversation.setProps({thread:p});if(!p||p.message_count>0){c('CSS').hide(this.loadingIcon);clearTimeout(this._hideLoadingIconTimeout);}}.bind(this));if(i.isEmptyLocalThread(this.threadID)&&this.contextBannerEligible)this.renderContextBanner(this.threadID);this._subscriptions.addSubscriptions(h.subscribe('threads-updated',function(){return this._updateThreadInfo();}.bind(this)));this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').START,function(p,q){if(this.threadID!==q||!this._messages)return;this._likePreview=p;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.trackBottomIfRequired();clearInterval(this._scrollToBottomInterval);this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').STOP,function(p){if(this.threadID!==p)return;this._likePreview=null;}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').STOP_EMOJI,function(p){if(this.threadID!==p)return;this._likePreview=null;}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').FINISH_ANIMATION,function(p){clearInterval(this._scrollToBottomInterval);}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').FINISH_EMOJI_ANIMATION,function(p){clearInterval(this._scrollToBottomInterval);}.bind(this)),c('MessengerHotLikePreviewEvents').addListener(c('MessengerHotLikePreviewEvents').REMOVE,function(p){if(this.threadID!==p)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}.bind(this)));},_initOverflowObserver:function o(){if(!c('UserAgent_DEPRECATED').firefox())return;var p=function u(){return c('Style').get(document.body,'overflowX')+' '+c('Style').get(document.body,'overflowY');},q=p(),r=function u(){var v=p();if(v!==q){q=v;c('Arbiter').inform('overflow-applied-to-body');}};if('MutationObserver' in window){var s=new MutationObserver(r),t={attributes:true,attributeFilter:['class','style']};s.observe(document.documentElement,t);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))r();},false);},_checkAndSetScrolledToBottom:function o(){if(this.isScrolledToBottom(0)){this._shouldTrackBottom=true;this._setupScrollInterval();}else{this._shouldTrackBottom=false;this._clearScrollTimers();}},_setupScrollInterval:function o(){if(!c('MercuryConfig').ChatScrollInterval)return;this._clearScrollTimers();this._scrollInterval=setInterval(function(){this.trackBottomIfRequired();}.bind(this),500);},_clearScrollTimers:function o(){clearInterval(this._scrollInterval);},_updateThreadInfo:function o(){i.getThreadMeta(this.threadID,function(p){this._conversation.setProps({thread:p});this._hasMontage=p.has_montage&&c('MercuryConfig').MontageThreadViewer;this._lightweight_event=p.lightweight_event;if(this._hasMontage&&!this.sheetController.isMontageSheetOpen())this.sheetController.openMontageSheet();}.bind(this));},_updateMessageFromStore:function o(p){var q=p.eventType==c('MercuryMessageStore').MESSAGES_REORDERED,r=p.eventType==c('MercuryMessageStore').MESSAGES_RECEIVED,s=p.eventType==c('MercuryMessageStore').THREAD_IS_EMPTY;if(r&&p.allFromOthers&&!this.isScrolledToBottom()&&!!this.sheetController&&!this.sheetController.isNewMessagesSheetOpened())this.sheetController.openNewMessagesSheet();if(q)this._loadingMoreMessages=false;if(q||r||s)c('CSS').hide(this.loadingIcon);var t=this.isScrolledToBottom(),u=this._getLoadingHeight(),v=this.scrollContainer.scrollHeight,w=c('Scroll').getTop(this.scrollContainer);this._messages=p.messages;clearTimeout(this._hideLoadingIconTimeout);this._conversation.setProps({messages:this._getNormalizedMessages()},function(){if(t){this.trackBottomIfRequired();}else if(q){this.scrollToPosition(this.scrollContainer.scrollHeight-v-u+w);}else this.trackBottomIfRequired();if(!this._initialLoadFinished){this._initialLoadFinished=true;c('ChatPerfInstrumentation').logCHAT_CONVERSATION_TTI();}var x=this._getNormalizedMessages();if(this.contextBannerEligible&&(this._store.hasFetchedAll()||x.size===1&&x.first().log_message_type===c('MercuryLogMessageType').SERVER_ERROR))this.renderContextBanner(this.threadID);if(!this._store.hasFetchedAll()&&x.size===0)this._store.fetchMoreMessages();}.bind(this));i.getThreadMeta(this.threadID,function(x){return this._conversation.setProps({thread:x});}.bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(this.camQuickReply)this.camQuickReply.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(this.quickReply)this.quickReply.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(p.eventType==c('MercuryMessageStore').MESSAGES_CHANGED)this._checkToAnimateSticker();c('MessengerVideoAutoplayActions').updateStore(this.threadID,this._getVideoMessageIDs());},scrolling:function o(p){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){c('CSS').show(this.loadingIcon);this._loadingMoreMessages=true;}this._checkVideoMessageVisibility();if(this.isScrolledToBottom()){if(!!this.sheetController&&this.sheetController.isNewMessagesSheetOpened()){this.sheetController.closeNewMessagesSheet();if(this._lightweight_event)this.sheetController.openChatEventReminderTabSheet();}if(this._hasMontage&&!this._wasScrolledToBottomAtLastScroll&&!this.sheetController.isMontageSheetOpen())this.sheetController.openMontageSheet();this._wasScrolledToBottomAtLastScroll=true;}else{if(this._hasMontage&&this.sheetController.isMontageSheetOpen())this.sheetController.closeMontageSheet();this._wasScrolledToBottomAtLastScroll=false;}},getScrollTop:function o(){return this.scrollContainer&&c('Scroll').getTop(this.scrollContainer);},getThreadID:function o(){return this.threadID;},destroy:function o(){this._clearScrollTimers();c('DOM').scry(this.conversationElem,'.stickerContainer').forEach(function(p){return c('ReactDOM').unmountComponentAtNode(p);});this.unmountContextBanner();c('ReactDOM').unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();c('ReactDOM').unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;if(this.camQuickReplyNode){c('ReactDOM').unmountComponentAtNode(this.camQuickReplyNode);delete this.camQuickReply;}if(this.quickReplyNode){c('ReactDOM').unmountComponentAtNode(this.quickReplyNode);delete this.quickReply;}this._store&&this._store.destroy();c('MessengerVideoAutoplayActions').deleteThread(this.threadID);this.destroyed=true;},_getLoadingHeight:function o(){return this.loadingHeight||this.loadingIcon.clientHeight;},isScrolledToBottom:function o(p){var q=this.scrollContainer;p=p===0?0:p||l;return c('Scroll').getTop(q)+q.clientHeight>=q.scrollHeight-p;},isScrolledNearTop:function o(){return c('Scroll').getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},messageSent:function o(){this._shouldTrackBottom=true;this.scrollToBottom();},scrollToBottom:function o(p){this.scrollToPosition(this.scrollContainer.scrollHeight,p);},scrollToPosition:function o(p,q){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(q===true){this._scrollTopAnimation=new (c('Animation'))(this.scrollContainer).to('scrollTop',p).ease(c('Animation').ease.end).duration(400).go();}else c('Scroll').setTop(this.scrollContainer,p);},trackBottomIfRequired:function o(p){if(this._shouldTrackBottom){this._setupScrollInterval();this.scrollToBottom(p);}else this._clearScrollTimers();},_getVideoMessageIDs:function o(){return this._messages&&c('immutable').List(this._messages).filter(function(p){return (c('MercuryAttachment').isSingleVideoAttachment(p)||c('MercuryAttachment').isSharedVideoAttachmentMessage(p));}).reverse().map(function(p){return p.message_id;});},_checkVideoMessageVisibility:function o(){var p,q,r,s=this.scrollContainer.getBoundingClientRect(),t=(p=this._conversation)!=null?(q=p.component)!=null?(r=q.refs)!=null?r.messageList:r:q:p;if(!t||!s)return;var u=[],v=c('MessengerVideoAutoplayStore').getMessageIDs(this.threadID),w=v||this._getVideoMessageIDs()||c('immutable').List();w.map(function(x){var y=c('MercuryAttachment').getVideoElem(x,t);if(y)u.push([x,y.getBoundingClientRect()]);});if(u.length)c('MessengerVideoAutoplayActions').onScroll(this.threadID,v?null:w,c('immutable').Map(u),s);},_loadMoreMessages:function o(){return this._store.fetchMoreMessages();},_onStickerClick:function o(p,q){if(!p||!this.threadID)return;c('BanzaiLogger').log('StickersLoggerConfig',{event:'click_sticker',packid:p,stickerid:q});c('Bootloader').loadModules(["StickersPackInTray","StickersActions","StickersStoreController"],function(r,s,t){r.onIsPackInTray(p,c('StickerInterfaces').MESSAGES,function(u){if(u.in_sticker_tray){s.selectTrayPack(p);s.showStickerFlyout(this.threadID);}else t.showStore(p);}.bind(this));}.bind(this),'ChatTabMessagesView');},_checkToAnimateSticker:function o(){var p=c('getElementPosition')(this.scrollContainer);c('Arbiter').inform('chatScrolled/'+this.threadID,{scrollTop:c('Scroll').getTop(this.scrollContainer),top:p.y,viewHeight:p.height});},setNewThreadID:function o(p){this._store.setNewThreadID(p);},_getNormalizedMessages:function o(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(p){return !p.is_like_preview;});return c('immutable').List(this._messages);},renderContextBanner:function o(p,q){c('MessengerContextBannerBootloader').getBootloadedComponent(p,c('MercuryShareAttachmentRenderLocations').CHAT,function(r){c('Style').set(this.conversationElem,'padding-top','80px');this._conversation.setProps({contextBanner:r});}.bind(this),q,function(r){c('Style').set(this.conversationElem,'padding-top',r+'px');}.bind(this));},unmountContextBanner:function o(){if(this._conversation)this._conversation.setProps({contextBanner:null});}});f.exports=n;}),null);
__d('ChatNubLogger',['BanzaiLogger','MercuryIDs','MessagingThreadEventType','MessagingThreadSourceName','ScriptPath','pageID'],(function a(b,c,d,e,f,g){var h='MessagingThreadEventLoggerConfig',i=c('MessagingThreadEventType').INACTIVE,j=0,k=false;function l(o){if(i==c('MessagingThreadEventType').ACTIVE&&!k){i=c('MessagingThreadEventType').INACTIVE;m(i,o);j=0;}else if(i==c('MessagingThreadEventType').INACTIVE&&k){i=c('MessagingThreadEventType').ACTIVE;j=Date.now();m(i,o);}}function m(event,o){var p=c('BanzaiLogger').create({retry:true}),q=Date.now(),r=c('MercuryIDs').tokenize(o);p.log(h,{event:event,client_event_time_ms:q,active_time_ms:event==c('MessagingThreadEventType').INACTIVE?q-j:0,page_id:c('pageID'),script_path:c('ScriptPath').getScriptPath(),page_data:c('ScriptPath').getPageInfo()?c('ScriptPath').getPageInfo().extraData:{},thread_id:r.value,source:c('MessagingThreadSourceName').CHAT_NUB});}var n={processEvent:function o(p,q){switch(p){case 'focus':k=true;break;case 'blur':k=false;break;default:break;}l(q);}};f.exports=n;}),null);
__d('ChatContentSearchContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','LayerHideOnEscape','ReactAbstractContextualDialog','ReactLayer'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal'),c('LayerHideOnEscape')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:47,length:16}}}));f.exports=i;}),null);
__d('ChatContentSearchButton.react',['cx','fbt','BootloadOnRender.react','ChatFlyoutPlaceholder.react','ChatContentSearchContextualDialog.react','JSResource','LazyComponent.react','Link.react','ReactComponentWithPureRenderMixin','React','MercuryShareAttachmentRenderLocations','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatContentSearchButton',_clickGuard:false,mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{clicked:j.bool,ContextualDialogClass:j.func,flyoutAlignment:j.oneOf(['left','right']),getQuery:j.func.isRequired,location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),onLoad:j.func,onSelect:j.func.isRequired},getDefaultProps:function m(){return {flyoutAlignment:'left',location:c('MercuryShareAttachmentRenderLocations').CHAT};},getInitialState:function m(){return {query:'',shown:!!this.props.clicked};},componentDidMount:function m(){this.props.onLoad&&this.props.onLoad(this);},updateQuery:function m(){this.setState({query:this.props.getQuery()});},hideFlyout:function m(){this.setState(this.getInitialState());},render:function m(){return (c('React').createElement('span',null,c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:'button',title:i._("Choose a gif or sticker"),ref:'link'}),this.renderLayers()));},renderLayers:function m(){if(!this.state.shown)return null;var n=this.props.ContextualDialogClass||c('ChatContentSearchContextualDialog.react');return (c('React').createElement(n,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link;}.bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k,key:'contextualDialog'},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{location:this.props.location,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,query:this.state.query}),loader:c('JSResource')('ChatContentSearchFlyout.react').__setRef('ChatContentSearchButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)})));},_handleMouseDown:function m(n){this._clickGuard=this.state.shown;},_handleClick:function m(n){n.stopPropagation();if(this.state.shown||this._clickGuard)return;this.setState({query:this.props.getQuery(),shown:!this.state.shown});},_handleSelect:function m(n,o){this.props.onSelect(n,o);this.hideFlyout();},_handleContextualDialogToggle:function m(n){this.setState({shown:n});}});f.exports=l;}),null);
__d('ChatEmojiButton.react',['cx','fbt','BootloadOnRender.react','ChatFlyoutPlaceholder.react','JSResource','LazyComponent.react','Link.react','ReactComponentWithPureRenderMixin','React','XUIContextualDialog.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j=c('React').PropTypes,k=278,l=c('React').createClass({displayName:'ChatEmojiButton',_clickGuard:false,mixins:[c('ReactComponentWithPureRenderMixin')],propTypes:{ContextualDialogClass:j.func.isRequired,flyoutAlignment:j.oneOf(['left','right']),fromChatTab:j.bool,onMount:j.func,onSelect:j.func,sendCustomEmoji:j.func,threadID:j.string},getDefaultProps:function m(){return {ContextualDialogClass:c('XUIContextualDialog.react'),flyoutAlignment:'left'};},getInitialState:function m(){return {shown:false};},componentDidMount:function m(){this.props.onMount&&this.props.onMount(this);},hideFlyout:function m(){this.setState(this.getInitialState());this.props.getInput&&this.props.getInput().focus();},render:function m(){return (c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:'button',title:i._("Choose an emoji"),ref:'link'},this.renderLayers()));},renderLayers:function m(){if(!this.state.shown)return null;var n=this.props.ContextualDialogClass;return (c('React').createElement(n,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link;}.bind(this),offsetY:this.props.fromChatTab?-20:10,onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:k,key:'contextualDialog'},c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{onCategorySelect:this._focusInput,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,sendCustomEmoji:this.props.sendCustomEmoji,threadID:this.props.threadID,width:k}),loader:c('JSResource')('ChatEmojiFlyout.react').__setRef('ChatEmojiButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)})));},_focusInput:function m(){this.props.getInput&&this.props.getInput().focus();},_handleMouseDown:function m(){this._clickGuard=this.state.shown;},_handleClick:function m(n){n.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.setState({shown:!this.state.shown});this._focusInput();},_handleSelect:function m(n){this.props.onSelect&&this.props.onSelect(n);},_handleContextualDialogToggle:function m(n){this.setState({shown:n});}});f.exports=l;}),null);
__d('ChatEventPlanButton.react',['cx','Bootloader','BootloadOnRender.react','ChatFlyoutPlaceholder.react','EventsActionsLogger','JSResource','LazyComponent.react','Link.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('React').PureComponent);j=i&&i.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.state={showFlyout:false},this.$ChatEventPlanButton2=false,this.$ChatEventPlanButton3=function(){c('Bootloader').loadModules(["EventReminderStateStore","EventReminderRequestHelper"],function(q,r){var s=q.getEvent(this.props.threadID);if(!this.$ChatEventPlanButton2)return;if(s&&s.exists){this.$ChatEventPlanButton1=true;if(!this.state.showFlyout){r.fetchEventReminder(this.props.threadID,s.eventID,function(){if(!this.$ChatEventPlanButton2)return;this.setState({showFlyout:true});}.bind(this));}else this.setState({showFlyout:false});}else{this.$ChatEventPlanButton1=false;this.setState({showFlyout:!this.state.showFlyout});}}.bind(this),'ChatEventPlanButton.react');}.bind(this),this.onToggle=function(q){if(q!==this.state.showFlyout)this.setState({showFlyout:q});}.bind(this),m;}k.prototype.componentDidMount=function(){this.$ChatEventPlanButton2=true;};k.prototype.componentWillUnmount=function(){this.$ChatEventPlanButton2=false;};k.prototype.render=function(){var l="_6gb _3k_u";return c('React').createElement('div',null,c('React').createElement(c('Link.react'),{className:l,onClick:this.$ChatEventPlanButton3,ref:'event_plan',role:'button'},this.$ChatEventPlanButton4()));};k.prototype.$ChatEventPlanButton4=function(){if(!this.state.showFlyout)return null;var l={alignment:'right',position:'above',contextRef:function(){return this.refs.event_plan;}.bind(this),shown:this.state.showFlyout,onToggle:this.onToggle},m={action_history:[{surface:c('EventsActionsLogger').Surface.MESSENGER_CHAT_TAB,mechanism:c('EventsActionsLogger').Mechanism.MESSENGER_COMPOSER}]};return c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{actionContext:m,dialogProps:l,flyoutNoSheet:true,isEditing:this.$ChatEventPlanButton1,threadID:this.props.threadID,useContextualDialog:true}),loader:c('JSResource')('ChatEventReminderContainer.react').__setRef('ChatEventPlanButton.react'),placeholder:c('React').createElement(c('ChatFlyoutPlaceholder.react'),null)});};f.exports=k;}),null);
__d('ChatInput.react',['AbstractMentionsTextEditor.react','BootloadedComponent.react','Bootloader','CompositeDraftDecorator','ContentState','DraftEditor.react','DraftModifier','EditorState','EmojiFormat','JSResource','MercuryConfig','MessengerEmojiSpan.react','MessengerEmoticonSpan.react','MessengerMentionsEntityDecorator.react','MessengerMentionSource','React','ReactDOM','cancelAnimationFrame','clearImmediate','createMessengerMentionDraftEntity','emptyFunction','getDefaultKeyBinding','getEntityMatcher','getProfileRangesForContentState','getThreadTypeNameFromThreadType','getVisibleValueForContentStateWithMessengerEmoji','handleBeforeInputForMessengerEmoji','handleBeforeInputForMessengerEmoticon','handleSoftNewlineForMessengerEmoticon','insertEmoticonIntoEditorState','insertMentionIntoEditorState','insertMessengerEmojiIntoContentState','isSoftNewlineEvent','setImmediate','requestAnimationFrame'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('React').PropTypes,k=c('emptyFunction').thatReturnsNull,l=1,m='handled',n=8,o='not-handled';h=babelHelpers.inherits(p,c('React').Component);i=h&&h.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return r=(q=i.constructor).call.apply(q,[this].concat(t)),this.$ChatInput4=function(){var v=this.$ChatInput6(this.state.editorState.getCurrentContent());this.$ChatInput1=c('setImmediate')(function(){this.$ChatInput1=null;var w=c('EditorState').set(this.state.editorState,{decorator:v});this.setState({editorState:w});}.bind(this));}.bind(this),this.onChange=function(v){if(v!==this.state.editorState){this.setState({editorState:v});if(this.props.onTextChange)this.props.onTextChange(this.getValueFromEditorState(v));}}.bind(this),this.onReturn=function(event){if(c('isSoftNewlineEvent')(event)){this.setState(function(v){var w=v.editorState,x=c('handleSoftNewlineForMessengerEmoticon');return {editorState:x(w)};});return m;}event.persist();this.setState({},function(){this.props.inputKeyDown(event,this.getValue());}.bind(this));return m;}.bind(this),this.getValue=function(){return this.getValueFromEditorState(this.state.editorState);}.bind(this),this.$ChatInput7=function(v){this.props.onBeforeInput&&this.props.onBeforeInput();var w=this.$ChatInput8(v),x=this.$ChatInput9(v);return w||x?m:o;}.bind(this),this.$ChatInput11=function(v){return this.$ChatInput10(v);}.bind(this),this.$ChatInput12=function(v,w){return this.$ChatInput10(w);}.bind(this),this.state={editorState:this.$ChatInput5(this.props.defaultText)},this.$ChatInput15=function(){var v=(this.state.addedMentionsCount||0)+1;this.setState({addedMentionsCount:v});}.bind(this),this.$ChatInput17=function(v,w){var x=(this.state.mentionsTriggeredCount||0)+1,y={mentionsTriggeredCount:x};if(!this.state.mentionsTriggerSource)y.mentionsTriggerSource=w===l?c('MessengerMentionSource').ATSIGN:c('MessengerMentionSource').TYPEAHEAD;this.setState(y);}.bind(this),this.$ChatInput14=function(v){return c('createMessengerMentionDraftEntity')(this.state.editorState.getCurrentContent(),v);}.bind(this),this.$ChatInput16=function(v){if(!this.refs.input.isShowingMentionables())this.props.onEscape&&this.props.onEscape(v);}.bind(this),r;}p.prototype.componentDidMount=function(){this.$ChatInput2=c('ReactDOM').findDOMNode(this).getBoundingClientRect().height;this.props.resizeFn(this.$ChatInput2);this.props.initializeThingsWithInputFn(c('ReactDOM').findDOMNode(this.refs.input),this.getValue);this.setState({triggeredWord:this.props.triggeredWord});};p.prototype.componentWillUnmount=function(){if(this.$ChatInput1)c('clearImmediate')(this.$ChatInput1);if(this.$ChatInput3)c('cancelAnimationFrame')(this.$ChatInput3);this.$ChatInput3=null;};p.prototype.componentWillReceiveProps=function(q){if(this.state.triggeredWord!==q.triggeredWord)this.setState({triggeredWord:q.triggeredWord},this.$ChatInput4);if(c('MercuryConfig').Mentions&&q.participants!==this.props.participants)c('Bootloader').loadModules(["createMentionsSearchSourceFromParticipants"],function(r){var s=q.participants,t=q.viewer,u=q.thread;this.setState({mentionsSource:r(t,s,u)});}.bind(this),'ChatInput.react');};p.prototype.componentDidUpdate=function(){this.$ChatInput3=c('requestAnimationFrame')(function(){if(!this.$ChatInput3)return;this.$ChatInput3=null;var q=c('ReactDOM').findDOMNode(this).getBoundingClientRect(),r=q.height;if(this.$ChatInput2!==r)this.props.resizeFn(r);this.$ChatInput2=r;}.bind(this));};p.prototype.$ChatInput5=function(q){var r=c('ContentState').createFromText(q);return c('EditorState').createWithContent(r,this.$ChatInput6(r));};p.prototype.resetState=function(){if(this.state.typeaheadReporter){this.state.typeaheadReporter.sessionEnd();this.state.typeaheadReporter.sessionStart();}this.setState({editorState:c('EditorState').moveFocusToEnd(this.$ChatInput5('')),triggeredWord:null,addedMentionsCount:0,mentionsTriggeredCount:0,mentionsTriggerSource:null});};p.prototype.resetAfterSend=function(q){var r,s=this;if(c('MercuryConfig').Mentions)(function(){var t,u=s.getMentions();if(q&&c('MercuryConfig').Mentions&&(u&&u.length||s.state.addedMentionsCount||s.state.mentionsTriggeredCount||s.state.mentionsTriggerSource))(function(){var v=s.state,w=v.addedMentionsCount,x=v.mentionsTriggeredCount,y=v.mentionsTriggerSource,z=s.props,aa=z.thread,ba=z.participants;c('Bootloader').loadModules(["MessengerMentionsTypedLogger","MessengerMentionsLoggerEvents"],function(ca,da){new ca().setEvent(da.MENTION).setGroupSize(ba&&ba.length).setNumDelivered(u&&u.length||0).setNumSelects(w).setNumTriggers(x).setThreadid(aa&&aa.thread_id).setThreadType(c('getThreadTypeNameFromThreadType')(aa&&aa.thread_type)).setOfflineThreadid(q.offline_threading_id).updateExtraData({source:y}).log();},'ChatInput.react');})();})();this.resetState();};p.prototype.$ChatInput6=function(q){var r=[{strategy:c('getEntityMatcher')(function(s){return s.getType()==='EMOTICON';},q.getEntity),component:c('MessengerEmoticonSpan.react')}];r.push({strategy:c('getEntityMatcher')(function(s){return s.getType()==='EMOJI';},q.getEntity),component:c('MessengerEmojiSpan.react')});if(c('MercuryConfig').Mentions)r.push({strategy:c('getEntityMatcher')(function(s){return s.getType()==='MENTION';},q.getEntity),component:c('MessengerMentionsEntityDecorator.react')});return new (c('CompositeDraftDecorator'))(r);};p.prototype.getValueFromEditorState=function(q){var r=q.getCurrentContent();return c('getVisibleValueForContentStateWithMessengerEmoji')(r);};p.prototype.getMentions=function(){return c('getProfileRangesForContentState')(this.state.editorState.getCurrentContent());};p.prototype.focus=function(){this.refs.input&&this.refs.input.focus&&this.refs.input.focus();};p.prototype.$ChatInput8=function(q){var r=c('handleBeforeInputForMessengerEmoticon')(this.state.editorState,q);if(r===this.state.editorState)return false;this.setState({editorState:r});return true;};p.prototype.$ChatInput9=function(q){var r=c('handleBeforeInputForMessengerEmoji')(this.state.editorState,q);if(r===this.state.editorState)return false;this.setState({editorState:r});return true;};p.prototype.$ChatInput10=function(q){var r=/^image\//,s=q.filter(function(t){return r.test(t.type);});if(s.length){this.props.uploadPhotoFn(s[0]);return true;}return false;};p.prototype.insertEmoticon=function(q){var r=c('insertEmoticonIntoEditorState')(q,this.state.editorState);if(r!==this.state.editorState)this.setState({editorState:r});};p.prototype.insertEmoji=function(q){var r=this.state.editorState,s=c('insertMessengerEmojiIntoContentState')(c('EmojiFormat').codeArrayToCodeString(q),r.getCurrentContent(),r.getSelection(),r.getCurrentInlineStyle()),t=c('EditorState').push(r,s,'insert-characters');if(t!==this.state.editorState)this.setState({editorState:c('EditorState').forceSelection(t,s.getSelectionAfter())});};p.prototype.appendText=function(q){var r=this.state.editorState,s=r.getSelection(),t=r.getCurrentContent();t=c('DraftModifier').insertText(t,s,q);r=c('EditorState').push(r,t,'insert-characters');this.setState({editorState:r});};p.prototype.render=function(){var q=c('DraftEditor.react'),r=babelHelpers['extends']({},this.props);if(c('MercuryConfig').Mentions){r=babelHelpers['extends']({},r,this.$ChatInput13());q=c('AbstractMentionsTextEditor.react');}return c('React').createElement(q,babelHelpers['extends']({ref:'input'},r,{editorState:this.state.editorState,onChange:this.onChange,handleBeforeInput:this.$ChatInput7,handlePastedFiles:this.$ChatInput11,handleDroppedFiles:this.$ChatInput12,handleReturn:this.onReturn,spellCheck:true,stripPastedStyles:true,textAlignment:'left'}));};p.prototype.$ChatInput13=function(){return {handleContentReturn:this.onReturn,maxResults:n,mentionResultsProps:{typeaheadView:c('BootloadedComponent.react').create(c('JSResource')('ChatMentionsInputTypeaheadView.react').__setRef('ChatInput.react')),typeaheadViewProps:{},position:'above',autoflip:true},mentionResultsComponent:c('BootloadedComponent.react').create(c('JSResource')('MentionsLayer.react').__setRef('ChatInput.react')),mentionCreationFn:this.$ChatInput14,mentionsSource:this.state.mentionsSource,onAddMention:this.$ChatInput15,onEscape:this.$ChatInput16,onShowMentions:this.$ChatInput17};};p.prototype.addMention=function(q){var r=c('insertMentionIntoEditorState')(q,this.state.editorState,0,this.$ChatInput14);if(!this.state.mentionsTriggerSource)this.setState({mentionsTriggerSource:c('MessengerMentionSource').REPLY});this.onChange(r);this.$ChatInput15();};p.propTypes={blockStyleFn:j.func,initializeThingsWithInputFn:j.func,inputKeyDown:j.func,keyBindingFn:j.func,onBeforeInput:j.func,onBlur:j.func,onEscape:j.func,onFocus:j.func,onTab:j.func,resizeFn:j.func,viewer:j.string};p.defaultProps={blockStyleFn:k,keyBindingFn:c('getDefaultKeyBinding')};f.exports=p;}),null);
__d('StickerContextualDialog.react',['cx','ContextualLayerAutoFlipHorizontal','MercuryConfig','ReactAbstractContextualDialog','ReactLayer'],(function a(b,c,d,e,f,g,h){'use strict';var i=7,j=c('ReactLayer').createClass(c('ReactAbstractContextualDialog').createSpec({addedBehaviors:[c('ContextualLayerAutoFlipHorizontal')],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:i,length:16}}}));j.WIDTH={NORMAL:312,WIDE:400};f.exports=j;}),null);
__d('ChatStickerButton.react',['cx','fbt','BootloadedComponent.react','JSResource','Link.react','React','StickerContextualDialog.react','StickersActions','StickersStateStore','TimeSliceInteraction','XUISpinner.react','emptyFunction','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m=278;j=babelHelpers.inherits(n,c('React').PureComponent);k=j&&j.prototype;function n(o){k.constructor.call(this,o);this.$ChatStickerButton1=false;this.renderLayers=function(){if(!this.state.shown)return null;var p=this.props.ContextualDialogClass;return (c('React').createElement(p,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBeforeHide:this.$ChatStickerButton5,onBlur:this.$ChatStickerButton3,position:'above',shown:this.state.shown,width:this.props.flyoutWidth,key:'contextualDialog'},c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{padding:'30px',textAlign:'center'}},c('React').createElement(c('XUISpinner.react'),{size:'large'})),bootloadLoader:c('JSResource')('StickersFlyout.react').__setRef('ChatStickerButton.react'),className:this.props.flyoutClassName,onShown:function(q){if(this.props.onFlyoutShown)this.props.onFlyoutShown(q);}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this.$ChatStickerButton3,onStickerSelect:this.$ChatStickerButton6,onEmoticonSelect:this.$ChatStickerButton7,shown:this.state.shown})));}.bind(this);this.$ChatStickerButton4=function(){this.$ChatStickerButton1=this.state.shown;}.bind(this);this.showFlyout=function(p){p&&p.stopPropagation();if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return;}c('TimeSliceInteraction').createAutoclosed('chat_sticker_flyout_show');c('StickersActions').showStickerFlyout(this.props.threadID);}.bind(this);this.$ChatStickerButton5=function(){if(this.state.shown)this.$ChatStickerButton3();}.bind(this);this.$ChatStickerButton3=function(){c('StickersActions').hideStickerFlyout();};this.$ChatStickerButton6=function(p){this.props.onStickerSelect(p);}.bind(this);this.$ChatStickerButton7=function(p){this.$ChatStickerButton3();this.props.onEmoticonSelect(p);}.bind(this);this.state={shown:!!o.clicked};}n.prototype.componentDidMount=function(){this.props.onLoad&&this.props.onLoad(this);this.$ChatStickerButton2=c('StickersStateStore').addListener(function(){var o=c('StickersStateStore').getState();if(o.get('showFlyout')&&o.get('threadID')===this.props.threadID){if(this.$ChatStickerButton1||this.props.disabled){this.$ChatStickerButton1=false;return;}this.setState({shown:true});}else{var p=this.props.getInput&&this.props.getInput();p&&p.focus&&p.focus();this.setState({shown:false});}}.bind(this));};n.prototype.componentWillUnmount=function(){if(this.state.shown)this.$ChatStickerButton3();this.$ChatStickerButton2&&this.$ChatStickerButton2.remove();};n.prototype.render=function(){return c('React').createElement('span',null,c('React').createElement(c('Link.react'),{className:c('joinClasses')(this.props.className,this.state.shown?"open":''),href:'#',onClick:this.showFlyout,onMouseDown:this.$ChatStickerButton4,role:'button',title:i._("Choose a sticker"),ref:'link'}),this.renderLayers());};n.propTypes={className:l.string,clicked:l.bool,ContextualDialogClass:l.func.isRequired,disabled:l.bool,flyoutClassName:l.string,flyoutWidth:l.number,getInput:l.func,onLoad:l.func,onStickerSelect:l.func.isRequired,onEmoticonSelect:l.func.isRequired,onFlyoutShown:l.func,onFlyoutHidden:l.func,threadID:l.string};n.defaultProps={clicked:false,ContextualDialogClass:c('StickerContextualDialog.react'),disabled:false,flyoutWidth:m,onStickerSelect:c('emptyFunction'),onEmoticonSelect:c('emptyFunction')};f.exports=n;}),null);
__d('MessengerHotLikeChatSVGIcon.react',['cssVar','fbt','React','uniqueID'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes,m='transparent',n=i._("Thumbs Up Sign");j=babelHelpers.inherits(o,c('React').Component);k=j&&j.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return q=(p=k.constructor).call.apply(p,[this].concat(s)),this.state={titleId:c('uniqueID')()},q;}o.prototype.render=function(){var p=this.props.color||"#0084ff",q=this.props.renderSize,r=q?{height:q,width:q}:undefined,s={fill:p,opacity:.2},t='bounds_'+this.state.titleId;return (c('React').createElement('svg',babelHelpers['extends']({'aria-labelledby':this.state.titleId,preserveAspectRatio:'xMinYMax meet',version:'1.1',viewBox:'0 0 32 32',xmlns:'http://www.w3.org/2000/svg'},r),c('React').createElement('title',{id:this.state.titleId},n),c('React').createElement('g',null,c('React').createElement('rect',{id:t,fill:m,width:'32',height:'32'}),c('React').createElement('g',{style:s},c('React').createElement('path',{d:'M670.93,460a0.08,0.08,0,0,0,0,.15,1.75,1.75,0,0,1,1.29,1.66c0,1.45-1.2,1.66-2,1.75a0.06,0.06,0,0,0,0,.12,1.54,1.54,0,0,1,.88,1.68C671,467,669.17,467,668,467H658a5.63,5.63,0,0,1-5-2.5V455l2.19-1.59a4.39,4.39,0,0,0,1.21-1.75l1.48-5.59v-0.43l-0.41-3.81a0.45,0.45,0,0,1,.16-0.41c1.34-1,3.07-.23,4,2.6a12.83,12.83,0,0,1,0,6.33,0.55,0.55,0,0,0,.54.66c1.77,0,6.77,0,6.77,0,2,0,3.31.62,3.54,2.5a2.39,2.39,0,0,1-1.23,2.4,0.08,0.08,0,0,0,0,.14,1.87,1.87,0,0,1,1.71,2A2,2,0,0,1,670.93,460Zm-20.13-7h-5.6a0.2,0.2,0,0,0-.2.2v15.6a0.2,0.2,0,0,0,.2.2h5.6a0.2,0.2,0,0,0,.2-0.2V453.2A0.2,0.2,0,0,0,650.8,453Z',transform:'translate(-643 -439)'})),c('React').createElement('g',{style:s},c('React').createElement('rect',{x:'2',y:'14',width:'6',height:'16',rx:'0.2',ry:'0.2'})),c('React').createElement('path',{fill:p,d:'M650.8,453a0.2,0.2,0,0,1,.2.2v15.6a0.2,0.2,0,0,1-.2.2h-5.6a0.2,0.2,0,0,1-.2-0.2V453.2a0.2,0.2,0,0,1,.2-0.2h5.6m0-2h-5.6a2.2,2.2,0,0,0-2.2,2.2v15.6a2.2,2.2,0,0,0,2.2,2.2h5.6a2.2,2.2,0,0,0,2.2-2.2V453.2a2.2,2.2,0,0,0-2.2-2.2h0Z',transform:'translate(-643 -439)'}),c('React').createElement('path',{fill:p,'data-name':'stroke',d:'M658.83,441c1.06,0,2.16,1,2.83,3a12.83,12.83,0,0,1,0,6.33,0.55,0.55,0,0,0,.54.66h1.18l5.59,0c2,0,3.31.62,3.54,2.5a2.39,2.39,0,0,1-1.23,2.4,0.08,0.08,0,0,0,0,.14,1.87,1.87,0,0,1,1.71,2,2,2,0,0,1-2.07,1.91,0.08,0.08,0,0,0,0,.15,1.75,1.75,0,0,1,1.29,1.66c0,1.45-1.2,1.66-2,1.75a0.06,0.06,0,0,0,0,.12,1.54,1.54,0,0,1,.88,1.68C671,467,669.24,467,668.07,467H658a5.63,5.63,0,0,1-5-2.5V455l2.19-1.59a4.39,4.39,0,0,0,1.21-1.75l1.48-5.59v-0.43l-0.41-3.81a0.45,0.45,0,0,1,.16-0.41,2,2,0,0,1,1.17-.41m0-2h0a4,4,0,0,0-2.36.8,2.45,2.45,0,0,0-1,2.23l0.39,3.67h0v0.05l-1.41,5.32a3.64,3.64,0,0,1-.47.69l-2.19,1.59L651,454v11.15l0.36,0.52A7.58,7.58,0,0,0,658,469h10.07c3.25,0,4.95-1.21,5-3.59a4.54,4.54,0,0,0-.05-0.93,3.59,3.59,0,0,0,1.14-2.71,3.77,3.77,0,0,0-.18-1.15,3.85,3.85,0,0,0,1-2.57,4,4,0,0,0-.82-2.55,4.38,4.38,0,0,0,.31-2.25c-0.2-1.59-1.18-4.25-5.53-4.25l-5,0a12.65,12.65,0,0,0-.35-5.63c-0.91-2.75-2.67-4.38-4.73-4.38h0Z',transform:'translate(-643 -439)'}))));};o.propTypes={color:l.string,location:l.string,renderSize:l.number};f.exports=o;}),null);
__d("XMessagingQuickCamController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/messages\/quick-cam\/",{thread_id:{type:"String",required:true},__asyncDialog:{type:"Int"}});}),null);
__d('MessengerQuickCamButton.react',['fbt','AsyncRequest','ChatConfig','Link.react','React','MessagingShowNUX.react','XMessagingQuickCamController'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes,l='seen_cam_button_nux';i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(n){j.constructor.call(this,n);this.$MessengerQuickCamButton2=function(){this.setState({nuxShown:true,nuxOpen:false},function(){return this.$MessengerQuickCamButton3();}.bind(this));}.bind(this);this.$MessengerQuickCamButton1=function(){if(!this.state.nuxShown){this.setState({nuxOpen:true});}else this.$MessengerQuickCamButton3();}.bind(this);this.state={nuxOpen:false,nuxShown:!!c('ChatConfig').get(l)};}m.prototype.render=function(){return c('React').createElement('div',null,c('React').createElement(c('Link.react'),{className:this.props.className,onClick:this.$MessengerQuickCamButton1,ref:'photoButton',role:'button',title:h._("Take a picture using quick cam")}),c('React').createElement(c('MessagingShowNUX.react'),{contextRef:function(){return this.refs.photoButton;}.bind(this),settingName:l,shown:this.state.nuxOpen,onHidden:this.$MessengerQuickCamButton2,ref:'camNUX'},h._("Send photos from your computer's camera.")));};m.prototype.$MessengerQuickCamButton3=function(){var n=c('XMessagingQuickCamController').getURIBuilder().setString('thread_id',this.props.threadID).getURI();new (c('AsyncRequest'))().setMethod('GET').setURI(n).setRelativeTo(this).setReadOnly(true).send();};m.propTypes={className:k.string.isRequired,threadID:k.string.isRequired};f.exports=m;}),null);
__d('P2PAbstractSendMoneyButton.react',['cx','fbt','React','TooltipLink.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=k.constructor).call.apply(m,[this].concat(p)),this.$P2PAbstractSendMoneyButton1=false,this.$P2PAbstractSendMoneyButton3=function(){this.props.onMouseDown&&this.props.onMouseDown();this.$P2PAbstractSendMoneyButton1=this.props.isActive;}.bind(this),this.$P2PAbstractSendMoneyButton2=function(r){r.stopPropagation();if(this.$P2PAbstractSendMoneyButton1){this.$P2PAbstractSendMoneyButton1=false;return;}this.props.onClick();}.bind(this),n;}l.prototype.render=function(){return c('React').createElement(c('TooltipLink.react'),{alignH:'center',className:c('joinClasses')(this.props.className,(this.props.isActive?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(this.props.isActive?' '+"_10gz":'')+(this.props.isDisabled?' '+"_10g-":'')+(!this.props.isMessenger&&!this.props.className?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":'')),href:'#',onClick:this.$P2PAbstractSendMoneyButton2,onMouseDown:this.$P2PAbstractSendMoneyButton3,onMouseOver:this.props.onMouseOver,position:'above',role:'button',title:this.$P2PAbstractSendMoneyButton4()},this.getButton());};l.prototype.getButton=function(){if(this.props.button)return this.props.button;return c('React').createElement('i',{className:"_5s8l"});};l.prototype.$P2PAbstractSendMoneyButton4=function(){if(this.props.isDisabled)return null;return i._("Send Money");};f.exports=l;}),null);
__d('P2PSendMoneyContainerBootloader.react',['cx','Bootloader','MessengerEnvironment','DeferredComponent.react','MercuryIDs','P2PAbstractSendMoneyButton.react','P2PActions','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PSendMoneyDialogStore','React','ReactLayeredComponentMixin_DEPRECATED','XUIContextualDialog.react','emptyFunction','getPageIDFromThreadID'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('React').PropTypes,j=c('MessengerEnvironment').messengerui,k=j?282:260,l=c('React').createClass({displayName:'P2PSendMoneyContainerBootloader',propTypes:{button:i.node,className:i.string,ContextualDialog:i.func,flyoutAlignment:i.string,onTrigger:i.func,participantIDs:i.array,referrer:i.string,threadID:i.string},getInitialState:function m(){return {showPlaceholderDialog:false,shouldBootloadImmediately:c('P2PSendMoneyDialogStore').isAnyChatSendViewOpen()};},mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],_clicked:false,_onComponentLoad:c('emptyFunction'),_bootloadCalled:false,_sendMoneyDialogStoreSub:null,log:function m(n,o){c('P2PLogger').log(n,babelHelpers['extends']({www_event_referrer:this.props.referrer,www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SEND},o));},componentWillMount:function m(){if(this.state.shouldBootloadImmediately){this._bootloadComponentNow();}else this._sendMoneyDialogStoreSub=c('P2PSendMoneyDialogStore').addListener('change',this.onDialogStoreChange);},componentWillUnmount:function m(){this.removeDialogStoreSub();},onDialogStoreChange:function m(){this._bootloadComponentNow();this.removeDialogStoreSub();},removeDialogStoreSub:function m(){if(this._sendMoneyDialogStoreSub){this._sendMoneyDialogStoreSub.remove();this._sendMoneyDialogStoreSub=null;}},onPlaceholderClick:function m(){var n=this.props.threadID?c('MercuryIDs').tokenize(this.props.threadID).value:null;this._handleDialogVisibility(!this.state.showPlaceholderDialog);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_SEND_MONEY_BUTTON_PLACEHOLDER_CLICKED,{object_id:n});this._bootloadComponentNow();this._clicked=false;},_handleDialogVisibility:function m(n){if(!n){c('P2PActions').chatSendViewClosed({threadID:this.props.threadID});}else c('P2PActions').chatSendViewOpened({referrer:this.props.referrer,threadID:this.props.threadID});this.setState({showPlaceholderDialog:n});},renderLayers:function m(){var n={};if(this.state.showPlaceholderDialog){var o=this.props.ContextualDialog||c('XUIContextualDialog.react');n.placeholderDialog=c('React').createElement(o,{alignment:this.props.flyoutAlignment?this.props.flyoutAlignment:j?'right':'left',contextRef:function(){return this.refs.placeholderButton;}.bind(this),onBlur:function(){if(!this._clicked)this._handleDialogVisibility(false);this._clicked=false;}.bind(this),ref:'dialog',shown:true,width:k,position:'above'},c('React').createElement('div',{className:"_c_5"},c('React').createElement(c('P2PLoadingMask.react'),{visible:true})));}return n;},render:function m(){if(this._isPageChat())return null;return (c('React').createElement(c('DeferredComponent.react'),babelHelpers['extends']({deferredComponent:this._bootloadComponent,deferredPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function m(){return (c('React').createElement(c('P2PAbstractSendMoneyButton.react'),{button:this.props.button,className:this.props.className,isActive:false,isDisabled:false,isMessenger:j,onClick:this.onPlaceholderClick,onMouseDown:function(){this._clicked=true;}.bind(this),onMouseOver:this._bootloadComponentNow,ref:'placeholderButton'}));},_bootloadComponent:function m(n){this._onComponentLoad=n.bind(this);},_bootloadComponentNow:function m(){if(this._bootloadCalled)return;this._bootloadCalled=true;c('Bootloader').loadModules(["P2PSendMoneyContainer.react"],function(n){this.removeDialogStoreSub();this._onComponentLoad(n);this.setState({showPlaceholderDialog:false});}.bind(this),'P2PSendMoneyContainerBootloader.react');},_isPageChat:function m(){return !!this._getPageID();},_getPageID:function m(){return c('getPageIDFromThreadID')(this.props.threadID);}});f.exports=l;}),null);
__d('ChatTabComposer.react',['csx','cx','fbt','ChatConfig','ChatContentSearchButton.react','ChatEmojiButton.react','ChatEventPlanButton.react','ChatInput.react','ChatPhotoUploader.react','ChatStickerButton.react','CustomColorHighlighting.react','CSS','EventRemindersGating','FantaMessageActions','Keys','MercuryConfig','MercuryIDs','MessengerBotsMenuButton.react','MessengerConfig','MessengerGamesButton.react','MessengerGroupPollingButton.react','MessengerHotLikeButton.react','MessengerHotLikeChatSVGIcon.react','MessengerHotLikeUtils','MessengerQuickCamButton.react','MessengerQuickCamButtonHTML5.react','MessengerQuickCamOrigins','P2PSendMoneyContainerBootloader.react','React','MercuryShareAttachmentRenderLocations','StickersActions','clearImmediate','convertMIGColorToFIGColor','getPageIDFromThreadID','isWebGLEnabled','requireWeak','setImmediate'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=c('React').PropTypes,n=77,o=9,p=c('ChatConfig').get('chat_basic_input_module')||c('ChatInput.react'),q=null;c('requireWeak')('FantaAppStore',function(s){return q=s;});k=babelHelpers.inherits(r,c('React').PureComponent);l=k&&k.prototype;function r(){var s,t;for(var u=arguments.length,v=Array(u),w=0;w<u;w++)v[w]=arguments[w];return t=(s=l.constructor).call.apply(s,[this].concat(v)),this.state={inputHeight:0,stickerFlyoutShown:false},this.$ChatTabComposer2=null,this.$ChatTabComposer3=null,this.$ChatTabComposer9=function(x){var y=this.props.threadID;if(y)this.$ChatTabComposer1=c('setImmediate')(function(){this.$ChatTabComposer1=null;c('FantaMessageActions').composerTextUpdate(y,x);}.bind(this));}.bind(this),this.$ChatTabComposer7=function(x){if(x.keyCode===c('Keys').RETURN){this.refs.emojiButton&&this.refs.emojiButton.hideFlyout();this.$ChatTabComposer9('');}this.props.inputKeyDown&&this.props.inputKeyDown(x);}.bind(this),this.$ChatTabComposer4=function(x){if(c('CSS').matchesSelector(x.target,"._1d4_")||c('CSS').matchesSelector(x.target,"._552h")||c('CSS').matchesSelector(x.target,"._552n"))this.refs.input.focus();}.bind(this),this.$ChatTabComposer8=function(x){if(this.state.stickerFlyoutShown)c('StickersActions').hideStickerFlyout();this.props.onEscape&&this.props.onEscape(x);this.$ChatTabComposer9('');}.bind(this),this.$ChatTabComposer23=function(x,y){if(x.platformFBID.toString()!==c('MercuryConfig').MessengerAppID){this.uploadURL({attribution_app_id:x.platformFBID,errorDialogParams:{body:j._("There was a problem sending this GIF. Choose another one and try again."),title:j._("Couldn't Send GIF")},external_image_url:x.source.url,preview_url:x.media.preview?x.media.preview.url:x.media.thumbnail.url,source:x.source});}else this.props.stickerButtonProps&&this.props.stickerButtonProps.onStickerSelect&&this.props.stickerButtonProps.onStickerSelect(x.resultID.toString);}.bind(this),this.$ChatTabComposer24=function(x){this.refs.input&&this.refs.input.insertEmoji(x);}.bind(this),t;}r.prototype.render=function(){return c('React').createElement('div',{className:"_1d4_",onClick:this.$ChatTabComposer4,role:'presentation'},this.$ChatTabComposer5(),c('React').createElement('div',{className:"_552n"},this.$ChatTabComposer6()));};r.prototype.componentWillUnmount=function(){if(this.$ChatTabComposer1)c('clearImmediate')(this.$ChatTabComposer1);};r.prototype.resetInput=function(s){this.refs.input.resetAfterSend(s);};r.prototype.uploadURL=function(s){var t=this.$ChatTabComposer2||this.$ChatTabComposer3;if(!t)return;t.uploadURL(s);};r.prototype.isUploading=function(){return !!(this.$ChatTabComposer2&&this.$ChatTabComposer2.isUploading()||this.$ChatTabComposer3&&this.$ChatTabComposer3.isUploading());};r.prototype.getInput=function(){return this.refs.input;};r.prototype.$ChatTabComposer5=function(){var s={};if(this.state.inputHeight)s.minHeight=this.state.inputHeight;var t=null;if(this.props.showStructuredMenu)t=c('React').createElement('div',{className:"_5c6-"},c('React').createElement(c('MessengerBotsMenuButton.react'),{flyoutAlignment:'left',threadID:this.props.threadID,pageID:this.props.pageID,className:"_5c6_"}));var u='',v=this.props.threadID;if(v&&q){var w=q.getState().mercury.tabContents.get(v);u=w&&w.composerText||'';}var x=c('MercuryConfig').Mentions&&this.props.thread&&!this.props.thread.is_canonical?j._("Type a message, \u0040name..."):j._("Type a message...");return c('React').createElement('div',{className:"_552h",style:s},t,c('React').createElement('div',{className:this.props.showStructuredMenu?"_4yzj":''},c('React').createElement(c('CustomColorHighlighting.react'),{customColor:this.props.thread&&this.props.thread.custom_color},c('React').createElement(p,{defaultText:u,initializeThingsWithInputFn:this.props.initializeThingsWithInputFn,inputKeyDown:this.$ChatTabComposer7,onBeforeInput:function(){return this.refs.emojiButton&&this.refs.emojiButton.hideFlyout();}.bind(this),onBlur:this.props.onBlur,onEscape:this.$ChatTabComposer8,onFocus:this.props.onFocus,onTab:this.props.onTab,ref:'input',resizeFn:function(y){y=Math.min(y,n);this.setState({inputHeight:y});this.props.resizeFn&&this.props.resizeFn(y);}.bind(this),onTextChange:this.$ChatTabComposer9,uploadPhotoFn:function(y){this.$ChatTabComposer3&&this.$ChatTabComposer3.uploadFiles([y]);}.bind(this),participants:this.props.participants,placeholder:x,viewer:this.props.viewer}))));};r.prototype.$ChatTabComposer6=function(){var s=[this.$ChatTabComposer10(),this.$ChatTabComposer11(),this.$ChatTabComposer12(),this.$ChatTabComposer13(),this.$ChatTabComposer14(),this.$ChatTabComposer15(),this.$ChatTabComposer16(),this.$ChatTabComposer17(),this.$ChatTabComposer18()],t=s.filter(Boolean);if(t.length<o)t.push(this.$ChatTabComposer19());if(t.length<o)t.push(this.$ChatTabComposer20());return t;};r.prototype.$ChatTabComposer10=function(){var s=this.props.photoUploaderProps||{};return c('React').createElement(c('ChatPhotoUploader.react'),babelHelpers['extends']({key:'photos',onMount:function(t){return this.$ChatTabComposer3=t;}.bind(this)},s));};r.prototype.$ChatTabComposer20=function(){var s=c('convertMIGColorToFIGColor')(this.props.thread&&this.props.thread.custom_color),t=this.$ChatTabComposer21();if(c('MessengerConfig').ShowGroupPollingInterface&&t&&this.props.thread&&!this.props.thread.is_canonical)return c('React').createElement('div',{className:"_6gd",key:'group_polling'},c('React').createElement(c('MessengerGroupPollingButton.react'),{customColor:s,threadFBID:t}));return null;};r.prototype.$ChatTabComposer19=function(){var s=c('MercuryConfig').MessengerGamesGK&&c('isWebGLEnabled')(),t=this.$ChatTabComposer21();return s&&t&&!this.$ChatTabComposer22()?c('React').createElement('div',{className:"_6gd",key:'games'},c('React').createElement(c('MessengerGamesButton.react'),{threadFBID:t})):null;};r.prototype.$ChatTabComposer16=function(){return this.props.threadID&&c('EventRemindersGating').isCreateAllowed?c('React').createElement('div',{className:"_6gd",key:'eventPlan'},c('React').createElement(c('ChatEventPlanButton.react'),{threadID:this.props.threadID})):null;};r.prototype.$ChatTabComposer15=function(){if(this.props.disableFileUploads)return null;var s=this.props.fileUploaderProps||{};return c('React').createElement(c('ChatPhotoUploader.react'),babelHelpers['extends']({key:'files',onMount:function(t){return this.$ChatTabComposer2=t;}.bind(this)},s));};r.prototype.$ChatTabComposer11=function(){var s=this.props.stickerButtonProps;if(!s)return null;return c('React').createElement('div',{className:"_6gd",key:'stickers'},c('React').createElement(c('ChatStickerButton.react'),babelHelpers['extends']({},s,{onFlyoutShown:function(){this.refs.input.focus();this.setState({stickerFlyoutShown:true});}.bind(this),onFlyoutHidden:function(){this.setState({stickerFlyoutShown:false});}.bind(this)})));};r.prototype.$ChatTabComposer12=function(){if(!c('ChatConfig').get('chat_content_search'))return null;return c('React').createElement('div',{className:"_6gd",key:'contentsearch'},c('React').createElement(c('ChatContentSearchButton.react'),{className:"_6gb _6gs",getQuery:function(){return this.refs.input.getValue();}.bind(this),onSelect:this.$ChatTabComposer23}));};r.prototype.$ChatTabComposer13=function(){if(!c('ChatConfig').get('www_messenger_emoji_picker'))return null;return c('React').createElement('div',{className:"_6gd",key:'emojipicker'},c('React').createElement(c('ChatEmojiButton.react'),{className:"_6gb _3oxr",flyoutAlignment:'right',fromChatTab:true,getInput:function(){return this.refs.input;}.bind(this),onSelect:this.$ChatTabComposer24,ref:'emojiButton',sendCustomEmoji:this.props.onCustomLikeSelect,threadID:this.props.threadID}));};r.prototype.$ChatTabComposer18=function(){if(!c('ChatConfig').get('hotlike'))return null;var s=this.props.thread,t=c('convertMIGColorToFIGColor')(s&&s.custom_color)||'',u=c('MessengerHotLikeChatSVGIcon.react'),v="_6gb";return c('React').createElement('div',{className:"_6gd _5ep3",key:'like'},c('React').createElement(c('MessengerHotLikeButton.react'),{className:v,customColor:t,customLike:c('MessengerHotLikeUtils').getCustomEmojiFromThread(s)||undefined,CustomRenderer:u,location:c('MercuryShareAttachmentRenderLocations').CHAT,renderSize:16,sendSticker:this.props.stickerButtonProps&&this.props.stickerButtonProps.onStickerSelect,sendCustomLike:this.props.onCustomLikeSelect,threadID:this.props.threadID}));};r.prototype.$ChatTabComposer14=function(){if(!this.props.p2pProps||!this.props.showP2PButton||this.$ChatTabComposer22())return null;var s=this.props.p2pProps;s.threadID=this.props.threadID;if(this.props.participantIDs&&this.props.participantIDs.length)s.participantIDs=this.props.participantIDs;return c('React').createElement('div',{className:"_6gd",key:'p2p'},c('React').createElement(c('P2PSendMoneyContainerBootloader.react'),s));};r.prototype.$ChatTabComposer17=function(){if(c('MercuryIDs').isLocalThread(this.props.threadID)||!c('ChatConfig').get('messenger_www_quickcam'))return null;var s=c('React').createElement(c('MessengerQuickCamButton.react'),{className:"_6gb _5yhk",threadID:this.props.threadID});if(c('ChatConfig').get('messenger_www_html5_quickcam'))s=c('React').createElement(c('MessengerQuickCamButtonHTML5.react'),babelHelpers['extends']({location:c('MessengerQuickCamOrigins').CHAT_TAB,viewer:this.props.viewer},s.props));return c('React').createElement('div',{className:"_6gd",key:'quickcam'},s);};r.prototype.$ChatTabComposer22=function(){return !!this.$ChatTabComposer25();};r.prototype.$ChatTabComposer25=function(){return c('getPageIDFromThreadID')(this.props.threadID);};r.prototype.$ChatTabComposer21=function(){if(this.props.threadID&&!c('MercuryIDs').isLocalThread(this.props.threadID))return c('MercuryIDs').getThreadFBIDFromThreadID(this.props.threadID);if(this.props.thread&&this.props.thread.thread_fbid)return this.props.thread.thread_fbid;return null;};r.prototype.replyToMention=function(s){this.refs.input&&this.refs.input.addMention&&this.refs.input.addMention(s);};r.propTypes={disableFileUploads:m.bool,fileUploaderProps:m.object,initializeThingsWithInputFn:m.func,inputKeyDown:m.func,onBlur:m.func,onCustomLikeSelect:m.func,onEmojiSelect:m.func,onEscape:m.func,onFocus:m.func,onTab:m.func,p2pProps:m.object,pageID:m.string,participantIDs:m.arrayOf(m.string),photoUploaderProps:m.object,resizeFn:m.func,showP2PButton:m.bool,showStructuredMenu:m.bool,stickerButtonProps:m.object,thread:m.object,threadID:m.string,uploadPhotoFn:m.func,viewer:m.string};f.exports=r;}),null);
__d('ChatTabComposerContainer.react',['cx','fbt','Arbiter','ChatConfig','ChatTabComposer.react','MercuryConfig','MercuryIDs','MercuryThreads','MercuryMessageActions','MessengerBotsMenuStore','MercuryParticipants','P2PGKValues','ReactComponentWithPureRenderMixin','React','MercuryShareAttachmentRenderLocations','SearchableEntry','SimpleXUIDialog','StoreAndPropBasedStateMixin','getPageIDFromThreadID','setImmediate'],(function a(b,c,d,e,f,g,h,i){'use strict';var j='right',k=c('React').PropTypes,l=c('ChatConfig').get('www_messenger_platform_structure_menu'),m=c('React').createClass({displayName:'ChatTabComposerContainer',_arbiterToken:null,mixins:[c('ReactComponentWithPureRenderMixin'),c('StoreAndPropBasedStateMixin')(c('MercuryThreads'),c('MessengerBotsMenuStore'),c('MercuryParticipants'))],propTypes:{threadID:k.string,viewer:k.string.isRequired,onFileUploadFail:k.func,onPhotoUploadFail:k.func,onStickerSelect:k.func,onUploadCancel:k.func,onUploadComplete:k.func,onUploadSubmit:k.func},statics:{calculateState:function n(o){var p=c('MercuryThreads').getForFBID(o.viewer),q=o.threadID?p.getOrFetch(o.threadID):null,r=c('P2PGKValues').P2PVisible&&o.viewer!==c('MercuryIDs').getUserIDFromThreadID(o.threadID),s=c('getPageIDFromThreadID')(o.threadID),t=!!(l&&s&&c('MessengerBotsMenuStore').getMenuButtonVisibility(s)),u=q&&q.participants?q.participants.map(c('MercuryParticipants').getOrFetch,c('MercuryParticipants')):[];return {thread:q,participants:u,showP2PButton:r,pageID:s,showStructuredMenu:t};}},componentDidMount:function n(){this.props.onMount(this);if(c('MercuryConfig').MentionsReplyEvent)this._arbiterToken=c('Arbiter').subscribe(c('MercuryConfig').MentionsReplyEvent,this._handleReplyToMention);},componentWillReceiveProps:function n(o){if(o.threadID!==this.props.threadID)this.setState({participantIDs:[],participants:[]});},componentWillUnmount:function n(){if(this._arbiterToken)c('Arbiter').unsubscribe(this._arbiterToken);},render:function n(){return (c('React').createElement(c('ChatTabComposer.react'),babelHelpers['extends']({fileUploaderProps:this._getFileUploaderProps(),ref:'composer',thread:this.state.thread},this.props,{p2pProps:this._getP2PProps(),pageID:this.state.pageID,participantIDs:this.state.participantIDs,participants:this.state.participants,photoUploaderProps:this._getPhotoUploaderProps(),showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,stickerButtonProps:this._getStickerButtonProps()})));},onSend:function n(o){this.refs.composer.resetInput(o);},setParticipantIDs:function n(o){o=o||[];this.setState({participantIDs:o});},getInput:function n(){return this.refs.composer.getInput();},isUploading:function n(){return this.refs.composer.isUploading();},_getP2PProps:function n(){if(!this.state.showP2PButton)return {};return {button:c('React').createElement('i',{className:"hidden_elem"}),className:"_6ga _6gb",flyoutAlignment:j,referrer:c('MercuryShareAttachmentRenderLocations').CHAT,threadID:this.props.threadID,onTrigger:this.props.onP2PTrigger};},_getStickerButtonProps:function n(){var o={className:"_6gb _6gf",flyoutAlignment:j,threadID:this.props.threadID,onStickerSelect:this.props.onStickerSelect};return o;},_getPhotoUploaderProps:function n(){var o={className:"_6gd",customUI:true,imageClassName:"hidden_elem",linkClassName:"_6gb _6ge",onLastUploadCancel:this._handleUploadCancel,onAllUploadsComplete:this._handleUploadComplete,onLastUploadFail:this._handlePhotoUploadFail,onUploadError:this._handleUploadError,onSubmit:this._handleUploadSubmit};return o;},_getFileUploaderProps:function n(){var o=this._getPhotoUploaderProps();o.linkClassName="_6gb _6gg";o.imagesOnly=false;o.onLastUploadFail=this._handleFileUploadFail;return o;},_handleUploadComplete:function n(o,p){c('MercuryMessageActions').getForFBID(this.props.viewer).confirmAttachmentPlaceholder(p.upload_id,p);this.props.onUploadComplete&&this.props.onUploadComplete(p);},_handleUploadError:function n(o){var p=void 0,q=void 0;switch(o.error){case 'size-exceeded':p=i._("The file you have selected is too large");q=i._("The file you have selected is too large. The maximum size is 25MB.");break;default:p=i._("File Upload Failed");q=i._("There was a problem uploading the file.");}this._showErrorDialog(p,q);this.props.onFileUploadFail&&this.props.onFileUploadFail(o);},_handleUploadCancel:function n(o,p){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(p.upload_id,p);this.props.onUploadCancel&&this.props.onUploadCancel(p);},_handleFileUploadFail:function n(o,p){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(p.upload_id,p);var q=i._("File Upload Failed"),r=i._("There was a problem uploading the file.");if(p.errorDialogParams){q=p.errorDialogParams.title||q;r=p.errorDialogParams.body||r;}this._showErrorDialog(q,r);this.props.onFileUploadFail&&this.props.onFileUploadFail(p);},_handlePhotoUploadFail:function n(o,p){c('MercuryMessageActions').getForFBID(this.props.viewer).cancelAttachmentPlaceholder(p.upload_id,p);var q=i._("Photo Upload Failed"),r=i._("Please try again. Make sure you are uploading a valid photo.");if(p.errorDialogParams){q=p.errorDialogParams.title||q;r=p.errorDialogParams.body||r;}this._showErrorDialog(q,r);this.props.onPhotoUploadFail&&this.props.onPhotoUploadFail(p);},_handleUploadSubmit:function n(o,p){this.props.onUploadSubmit&&this.props.onUploadSubmit(p);},_showErrorDialog:function n(o,p){c('SimpleXUIDialog').show(p,o);},_handleReplyToMention:function n(o,event){if(event.threadID===this.props.threadID)c('MercuryParticipants').get(event.participantID,function(p){if(!p||!this.refs.composer)return;var q=new (c('SearchableEntry'))({uniqueID:p.fbid,title:'@'+p.name});c('setImmediate')(function(){this.refs.composer.getInput().focus();this.refs.composer.replyToMention&&this.refs.composer.replyToMention(q);}.bind(this));}.bind(this));}});f.exports=m;}),null);
__d('ChatCloseButton.react',['fbt','Link.react','React','TrackingNodes','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.render=function(){var m=c('TrackingNodes').getTrackingInfo(c('TrackingNodes').types.CLOSE_BUTTON),n=h._("Press Esc to close"),o=h._("Close tab");return (c('React').createElement(c('Link.react'),{'aria-label':this.props.active?n:o,className:c('joinClasses')(this.props.className,'close','button'),'data-ft':m,'data-hover':'tooltip','data-tooltip-content':this.props.active?n:o,'data-tooltip-position':'above',onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));};function l(){i.apply(this,arguments);}l.propTypes={onClick:k.func,onKeyUp:k.func,onMouseDown:k.func,active:k.bool};l.defaultProps={active:false};f.exports=l;}),null);
__d('ChatEditParticipantsUtils',['AsyncDialog','AsyncRequest','MercuryIDs','MercuryThreadIDMap','URI'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadIDMap').get(),i={showParticipantsModal:function j(k){if(!c('MercuryIDs').isGroupChat(k))return;h.getServerIDFromClientID(k,function(l){c('AsyncDialog').send(new (c('AsyncRequest'))(new (c('URI'))('/ajax/browser/dialog/multichat_members/').addQueryData({id:l})));});}};f.exports=i;}),null);
__d('ChatTitleLink.react',['cx','ChatEditParticipantsUtils','Link.react','MercuryThreads','MercuryThreadTitle.react','MessengerAdminGroupUtils','React','TrackingNodes','UserAgent'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('MercuryThreads').get(),j=c('React').PropTypes,k=c('React').createClass({displayName:'ChatTitleLink',propTypes:{href:j.string,thread:j.object,viewer:j.string},getDefaultProps:function m(){return {href:null};},getTitle:function m(){return this.refs.threadTitle.getTitle();},render:function m(){if(!this.props.thread)return null;var n=this.props,o=n.href,p=n.thread,q=n.viewer,r=babelHelpers.objectWithoutProperties(n,['href','thread','viewer']);return (c('React').createElement(l,babelHelpers['extends']({'aria-level':'3',className:"titlebarText"+(c('UserAgent').isBrowser('Chrome')&&!c('UserAgent').isPlatform('Windows')?' '+"fixemoji":'')+(o===null?' '+"noLink":''),'data-ft':c('TrackingNodes').getTrackingInfo(c('TrackingNodes').types.TITLE),'data-hover':'tooltip',onClick:function(s){return this._handleClick(s);}.bind(this),href:o},r),c('React').createElement(c('MercuryThreadTitle.react'),{ref:'threadTitle',isNewThread:i.isNewEmptyLocalThread(p.thread_id),thread:p,useAndSeparator:true,useShortName:!p.is_canonical,viewer:q})));},_handleClick:function m(n){if(!this.props.href)return;if(c('MessengerAdminGroupUtils').showParticipantsModal(this.props.thread.is_canonical,i.isEmptyLocalThread(this.props.thread.thread_id),this.props.thread)){c('ChatEditParticipantsUtils').showParticipantsModal(this.props.thread.thread_id);n.preventDefault();}}}),l=function m(n){return (n.href?c('React').createElement(c('Link.react'),n):c('React').createElement('span',n));};f.exports=k;}),null);
__d('ChatTabHeader.react',['cx','fbt','Promise','AutoFocusableLink.react','MercuryBootloadOnInteraction.react','BootloadOnRender.react','ChatCloseButton.react','ChatConfig','ChatTitleLink.react','JSResource','LazyComponent.react','MercuryConfig','MercuryThreadInfo','MercuryTypingAnimation.react','MessengerAdminGroupUtils','MessengerJoinableModeType','React','TooltipData','requireWeak'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k,l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').PureComponent);k=j&&j.prototype;function m(n){k.constructor.call(this,n);this.$ChatTabHeader1=false;this.$ChatTabHeader7=function(){if(!c('MercuryConfig').FantaTabView){for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];this.props.onClick.apply(null,p);}}.bind(this);this.$ChatTabHeader6=function(){if(c('MercuryConfig').FantaTabView){for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];this.props.onClick.apply(null,p);}}.bind(this);this.state={};this.$ChatTabHeader2=new (c('Promise'))(function(o,p){this.$ChatTabHeader3=o;}.bind(this));this.$ChatTabHeader4=c('JSResource')('ChatTabMenu.react').__setRef('ChatTabHeader.react');}m.prototype.componentDidMount=function(){this.$ChatTabHeader1=true;c('requireWeak')('ChatVideoCallButton.react',function(n){if(this.$ChatTabHeader1)this.setState({RTCComponent:n});}.bind(this));if(this.props.isMuted)this.getMenu();};m.prototype.componentWillUnmount=function(){this.$ChatTabHeader1=false;};m.prototype.render=function(){var n=this.$ChatTabHeader5(),o=this.props.isRaised;return c('React').createElement('div',{className:"_15p4"+(!this.props.isRaised?' '+"_15p5":'')+(o||!n?' '+"_2pis":''),onMouseUp:this.$ChatTabHeader6,onClick:this.$ChatTabHeader7,onKeyDown:this.props.onKeyDown,ref:'root',role:'button',tabIndex:'0'},c('React').createElement('div',{className:"titlebarTextWrapper _15p6"},n,this.$ChatTabHeader8()),this.props.isTyping&&!this.props.isRaised?c('React').createElement(c('MercuryTypingAnimation.react'),{className:"_15p8",color:'dark'}):null,this.$ChatTabHeader9(),c('React').createElement('div',{className:"_15p9"},c('React').createElement(c('ChatCloseButton.react'),{active:this.props.isActive,className:"_3olu _3olv",onClick:this.props.onCloseClick,onKeyUp:this.props.onCloseKeyUp,onMouseDown:this.props.onCloseMouseDown})));};m.prototype.focus=function(){this.refs.root&&this.refs.root.focus();};m.prototype.getMenu=function(){this.$ChatTabHeader4.load().done(function(n){return this.$ChatTabHeader1&&this.setState({MenuComponent:n});}.bind(this));return this.$ChatTabHeader2;};m.prototype.$ChatTabHeader9=function(){if(!this.props.isRaised)return null;var n=[this.$ChatTabHeader10(),this.$ChatTabHeader11(),this.$ChatTabHeader12(),this.$ChatTabHeader13(),this.$ChatTabHeader14()];return n.filter(function(o){return !!o;});};m.prototype.$ChatTabHeader13=function(){return this.$ChatTabHeader15({isAudio:true});};m.prototype.$ChatTabHeader12=function(){return this.$ChatTabHeader15({isAudio:false});};m.prototype.$ChatTabHeader15=function(n){if(this.props.isEmptyChat)return null;var o=this.props,p=o.isGroupChat,q=o.onRTCNuxCloseButtonClick,r=o.rtcNuxShown,s=o.thread,t=o.threadID,u=o.viewer;if(p){if(!s||s.participants.length<=1||!c('MercuryThreadInfo').canReply(s))return null;if(s.joinable_mode&&s.joinable_mode.mode===c('MessengerJoinableModeType').JOINABLE)return null;if(n.isAudio){if(!c('ChatConfig').get('rtc_conferencing_www'))return null;}else if(!c('ChatConfig').get('rtc_conferencing_www_video'))return null;}var v=babelHelpers['extends']({isGroupChat:p,onRTCNuxCloseButtonClick:q,rtcCallData:s&&s.rtc_call_data,rtcNuxShown:r&&n.isAudio,threadID:t,viewer:u},n);v.className="_3olv"+(v.isAudio?' '+"_2fpc":'')+(!v.isAudio?' '+"_2fpd":'');var w=this.state.RTCComponent;return (c('React').createElement('div',{className:"_3a61",key:'rtc'+(v.isAudio?'audio':'video')},w?c('React').createElement(w,v):c('React').createElement(c('MercuryBootloadOnInteraction.react'),{component:c('React').createElement(c('LazyComponent.react'),v),loader:c('JSResource')('ChatVideoCallButton.react').__setRef('ChatTabHeader.react'),placeholder:c('React').createElement(c('AutoFocusableLink.react'),{className:v.className,role:'button'})})));};m.prototype.$ChatTabHeader14=function(){if(this.props.isEmptyChat)return null;var n=babelHelpers['extends']({attachmentsShelf:this.props.attachmentsShelf,isGroupChat:this.props.isGroupChat,isEmptyChat:this.props.isEmptyChat,isMuted:this.props.isMuted,nameConversationFunc:this.props.nameConversationFunc,otherUserID:this.props.otherUserID,showAddFriend:this.props.showAddFriend,sheetController:this.props.sheetController,threadID:this.props.threadID,onSubmit:this.props.onFileUploaderSubmit,onFileUploaderMounted:this.props.onFileUploaderMounted,onMount:this.$ChatTabHeader3,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onUploadFinished:this.props.onUploadFinished},this.props.additionalMenuProps);n.className="_3olv _1ll-";var o=i._("Options"),p=this.state.MenuComponent;return (c('React').createElement('div',{className:"_3a61",key:'menu'},p?c('React').createElement(p,n):c('React').createElement(c('MercuryBootloadOnInteraction.react'),{component:c('React').createElement(c('LazyComponent.react'),n),loader:c('JSResource')('ChatTabMenu.react').__setRef('ChatTabHeader.react'),placeholder:c('React').createElement(c('AutoFocusableLink.react'),{className:n.className,'aria-label':o,role:'button'})})));};m.prototype.$ChatTabHeader11=function(){if(this.props.isPageChat||this.props.isEmptyChat)return null;var n={className:"_3olv _3jyj",isFBAtWork:this.props.isWorkUser,shouldAddToApprovalQueue:c('MessengerAdminGroupUtils').shouldAddToApprovalQueue(this.props.thread,this.props.viewer),shown:true,onClick:function(){return this.props.sheetController.openAddFriendsSheet();}.bind(this)},o=i._("Add");return (c('React').createElement('div',{className:"_3a61",key:'add'},c('React').createElement(c('MercuryBootloadOnInteraction.react'),{component:c('React').createElement(c('LazyComponent.react'),n),loader:c('JSResource')('ChatAddToThreadButton.react').__setRef('ChatTabHeader.react'),placeholder:c('React').createElement(c('AutoFocusableLink.react'),{'aria-label':o,className:n.className,role:'button'})})));};m.prototype.$ChatTabHeader10=function(){if(!this.props.isViewerEmployee)return null;var n=this.props.participants,o=n?n.length>0&&n.every(function(q){return !!(q&&q.employee);}):false;if(!o)return null;var p={isFBAtWork:this.props.isWorkUser,shown:true,useCSS:true};return (c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),p),key:'archiveWarning',loader:c('JSResource')('ArchiveWarning.react').__setRef('ChatTabHeader.react'),placeholder:c('React').createElement('div',null)}));};m.prototype.$ChatTabHeader16=function(){return (c('React').createElement('span',{className:"_3a61"+(!this.props.isRaised?' '+"_3-99":'')},c('React').createElement('span',{className:"_3olv _2nlt"})));};m.prototype.$ChatTabHeader8=function(){return (c('React').createElement(c('ChatTitleLink.react'),babelHelpers['extends']({href:this.props.isRaised?this.props.href:undefined,thread:this.props.thread,viewer:this.props.viewer},c('TooltipData').propsFor(this.props.tooltip,'above'))));};m.prototype.$ChatTabHeader5=function(){var n=this.props,o=n.isRaised,p=n.thread;if(!o&&p&&p.unread_count>0)return (c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{className:"_3-8_",count:p.unread_count,type:'special'}),loader:c('JSResource')('XUIBadge.react').__setRef('ChatTabHeader.react'),placeholder:c('React').createElement('span',null)}));return this.$ChatTabHeader16();};m.propTypes={additionalMenuProps:l.object,attachmentsShelf:l.object.isRequired,href:l.string,isActive:l.bool.isRequired,isEmptyChat:l.bool,isGroupChat:l.bool,isMuted:l.bool,isPageChat:l.bool,isRaised:l.bool,isTyping:l.bool,isViewerEmployee:l.bool,isWorkUser:l.bool,nameConversationFunc:l.func.isRequired,otherUserID:l.string,participants:l.arrayOf(l.object),rtcNuxShown:l.bool.isRequired,sheetController:l.object.isRequired,showAddFriend:l.func.isRequired,thread:l.object,threadID:l.string,tooltip:l.string,viewer:l.string.isRequired,onClick:l.func.isRequired,onCloseClick:l.func.isRequired,onCloseKeyUp:l.func.isRequired,onCloseMouseDown:l.func.isRequired,onFileUploaderMounted:l.func.isRequired,onFileUploaderSubmit:l.func.isRequired,onKeyDown:l.func.isRequired,onRTCNuxCloseButtonClick:l.func.isRequired,onUpdateAttachmentsShelf:l.func.isRequired,onUploadFinished:l.func.isRequired};f.exports=m;}),null);
__d('getGroupNameTooltipFromParticipantIDs',['fbt','MercuryParticipants','MercuryViewer'],(function a(b,c,d,e,f,g,h){'use strict';var i=10,j='\n';function k(m,n){var o=[],p=c('MercuryViewer').getID();m=m&&m.filter(function(s){return s!==p;});if(!m||!m.length){n(null);return;}var q=m.length,r=q-i;if(r>1)m=m.slice(0,i);c('MercuryParticipants').getMulti(m,function(s){for(var t in s){var u=s[t];o.push(u.name);}if(r>1){var v=h._("and {number of hidden chat participants} more.",[h.param('number of hidden chat participants',r)]);o.push(v);}n(o.join(j));});}function l(m){var n=[],o=c('MercuryViewer').getID();m=m&&m.filter(function(r){return r!==o;});if(!m||!m.length)return null;n=m.map(function(r){var s=c('MercuryParticipants').getOrFetch(r);return s&&s.name;}).filter(function(r){return !!r;});var p=m.length-(m.length-n.length)-i;if(p>1){n=n.slice(0,i);var q=h._("and {number of hidden chat participants} more.",[h.param('number of hidden chat participants',p)]);n.push(q);}return n.join(j);}f.exports={getGroupNameTooltipFromParticipantIDs:l,getGroupNameTooltipFromParticipantIDsAsync:k};}),null);
__d('getTitleHrefFromThreadID',['MercuryIDs','MercuryParticipants','WebMessengerThreadPermalinks'],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=c('MercuryIDs').getUserIDFromThreadID(i);if(k){c('MercuryParticipants').get(c('MercuryIDs').getParticipantIDFromUserID(k),function(l){if(l.href){j(l.href);}else j(c('WebMessengerThreadPermalinks').getThreadURIFromUserID(k));});}else c('WebMessengerThreadPermalinks').getThreadURI(i,j);}f.exports=h;}),null);
__d('ChatTabHeaderContainer.react',['ChatTabHeader.react','CurrentUser','MercuryIDs','MercuryParticipants','MercuryThreads','MercuryThreadInfo','React','SubscriptionsHandler','WorkModeConfig','getPageIDFromThreadID','getGroupNameTooltipFromParticipantIDs','getTitleHrefFromThreadID'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=c('getGroupNameTooltipFromParticipantIDs').getGroupNameTooltipFromParticipantIDs,k=c('React').PropTypes;h=babelHelpers.inherits(l,c('React').PureComponent);i=h&&h.prototype;function l(m){i.constructor.call(this,m);this.$ChatTabHeaderContainer1=new (c('SubscriptionsHandler'))();this.state=this.calculateState(m);}l.prototype.calculateState=function(m){var n=false,o=true,p=false,q=void 0,r=void 0,s=void 0,t=void 0,u=void 0;if(m.threadID){var v=c('MercuryThreads').getForFBID(m.viewer);t=v.getOrFetch(m.threadID);n=c('MercuryIDs').isGroupChat(m.threadID);o=v.isNewEmptyLocalThread(m.threadID);p=!!t&&c('MercuryThreadInfo').isMuted(t);q=c('MercuryIDs').getUserIDFromThreadID(m.threadID);r=c('getPageIDFromThreadID')(m.threadID);if(t){s=t.participants.map(c('MercuryParticipants').getOrFetch,c('MercuryParticipants'));u=j(t.participants);}}var w=this.state&&this.state.additionalMenuProps||{};if(m)w=babelHelpers['extends']({},w,m.additionalMenuProps);return {additionalMenuProps:w,isEmptyChat:o,isGroupChat:n,isMuted:p,otherUserID:q,pageID:r,participants:s,thread:t,tooltip:u};};l.prototype.componentWillMount=function(){this.$ChatTabHeaderContainer1.addSubscriptions(c('MercuryThreads').addListener('change',function(){this.setState(this.calculateState(this.props));}.bind(this)),c('MercuryParticipants').addListener('change',function(){this.setState(this.calculateState(this.props));}.bind(this)));};l.prototype.componentDidMount=function(){this.$ChatTabHeaderContainer2();this.props.onMount&&this.props.onMount(this);};l.prototype.componentWillReceiveProps=function(m){if(m.threadID!==this.props.threadID)this.$ChatTabHeaderContainer2();this.setState(this.calculateState(m));};l.prototype.componentWillUnmount=function(){this.$ChatTabHeaderContainer1.release();};l.prototype.render=function(){return (c('React').createElement(c('ChatTabHeader.react'),{additionalMenuProps:this.state.additionalMenuProps,attachmentsShelf:this.props.attachmentsShelf,href:this.state.href,isActive:this.props.isActive,isEmptyChat:this.state.isEmptyChat,isGroupChat:this.state.isGroupChat,isMuted:this.state.isMuted,isPageChat:!!this.state.pageID,isRaised:this.props.isRaised,isTyping:this.props.isTyping,isViewerEmployee:c('CurrentUser').isEmployee(),isWorkUser:c('WorkModeConfig').is_work_user,nameConversationFunc:this.props.nameConversationFunc,otherUserID:this.state.otherUserID,participants:this.state.participants,rtcNuxShown:this.props.rtcNuxShown,sheetController:this.props.sheetController,showAddFriend:this.props.showAddFriend,ref:'header',thread:this.state.thread,threadID:this.props.threadID,tooltip:this.state.tooltip,viewer:this.props.viewer,onClick:this.props.onClick,onCloseClick:this.props.onCloseClick,onCloseKeyUp:this.props.onCloseKeyUp,onCloseMouseDown:this.props.onCloseMouseDown,onFileUploaderMounted:this.props.onFileUploaderMounted,onFileUploaderSubmit:this.props.onFileUploaderSubmit,onKeyDown:this.props.onKeyDown,onRTCNuxCloseButtonClick:this.props.onRTCNuxCloseButtonClick,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onUploadFinished:this.props.onUploadFinished}));};l.prototype.focus=function(){this.refs.header.focus();};l.prototype.setAdditionalMenuProps=function(m){var n=babelHelpers['extends']({},this.state.additionalMenuProps,m);this.setState({additionalMenuProps:n});};l.prototype.getMenu=function(){return this.refs.header.getMenu();};l.prototype.$ChatTabHeaderContainer2=function(){c('getTitleHrefFromThreadID')(this.props.threadID,function(m){return this.setState({href:m});}.bind(this));};l.propTypes={additionalMenuProps:k.object,attachmentsShelf:k.object.isRequired,isActive:k.bool.isRequired,isRaised:k.bool,isTyping:k.bool,nameConversationFunc:k.func.isRequired,rtcNuxShown:k.bool.isRequired,sheetController:k.object.isRequired,showAddFriend:k.func.isRequired,threadID:k.string,viewer:k.string.isRequired,onClick:k.func.isRequired,onCloseClick:k.func.isRequired,onCloseKeyUp:k.func.isRequired,onCloseMouseDown:k.func.isRequired,onFileUploaderMounted:k.func.isRequired,onFileUploaderSubmit:k.func.isRequired,onKeyDown:k.func.isRequired,onMount:k.func,onRTCNuxCloseButtonClick:k.func.isRequired,onUpdateAttachmentsShelf:k.func.isRequired,onUploadFinished:k.func.isRequired};f.exports=l;}),null);
__d('ChatTabSheetListener',['invariant','ChatPrivacyActionController','MercuryIDs','MercuryParticipants','MercuryThreadInformer','MercuryThreads','MercuryViewer'],(function a(b,c,d,e,f,g,h){'use strict';function i(j,k){this.$ChatTabSheetListener1=k;this.$ChatTabSheetListener3=j;this.$ChatTabSheetListener4=c('MercuryIDs').getUserIDFromThreadID(this.$ChatTabSheetListener3);c('MercuryThreadInformer').get().subscribe('threads-updated',function(){return this.$ChatTabSheetListener5();}.bind(this));if(this.$ChatTabSheetListener4)this.$ChatTabSheetListener2=new (c('ChatPrivacyActionController'))(this.$ChatTabSheetListener4,function(l){return this.$ChatTabSheetListener6(l);}.bind(this));}i.prototype.destroy=function(){this.$ChatTabSheetListener2&&this.$ChatTabSheetListener2.destroy();};i.prototype.$ChatTabSheetListener5=function(){var j=c('MercuryThreads').get();j.getThreadMeta(this.$ChatTabSheetListener3,function(k){var l=c('MercuryViewer').getID(),m=k.participants.filter(function(n){return n!==l;});m.length<1&&!j.isNewEmptyLocalThread(this.$ChatTabSheetListener3)?this.$ChatTabSheetListener1.openNoRecipientsSheet():this.$ChatTabSheetListener1.closeNoRecipientsSheet();}.bind(this));};i.prototype.$ChatTabSheetListener6=function(j){switch(j){case c('ChatPrivacyActionController').OFFLINE:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.openOfflineSheet();break;case c('ChatPrivacyActionController').NORMAL:this.$ChatTabSheetListener1.closeUserBlockedSheet();this.$ChatTabSheetListener1.closeOfflineSheet();break;case c('ChatPrivacyActionController').BLOCKED:this.$ChatTabSheetListener1.closeOfflineSheet();!!this.$ChatTabSheetListener4||h(0);c('MercuryParticipants').get(c('MercuryIDs').getParticipantIDFromUserID(this.$ChatTabSheetListener4),function(k){k.is_friend?this.$ChatTabSheetListener1.openUserBlockedSheet():this.$ChatTabSheetListener1.closeUserBlockedSheet();}.bind(this));break;}};f.exports=i;}),null);
__d('MercurySheetPolicy',['MercuryConfig','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h={ChatThreadIsMutedTabSheet:{isPermanent:false,isSheetWithInput:false},ChatUserFocusSheet:{isPermanent:true,isSheetWithInput:true},ChatUserFocusBypassSheet:{isPermanent:true,isSheetWithInput:true},ChatUserTimezoneSheet:{isPermanent:true,isSheetWithInput:true},ChatUserBlockedTabSheet:{isPermanent:true,isSheetWithInput:false},ChatUploadWarningTabSheet:{isPermanent:false,isSheetWithInput:false},ChatThreadIsMessageBlockedSheet:{isPermanent:true,isSheetWithInput:false},ChatReadOnlyTabSheet:{isPermanent:false,isSheetWithInput:false},ChatReadOnlyPermanentTabSheet:{isPermanent:true,isSheetWithInput:false},ChatOfflineTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNoRecipientsTabSheet:{isPermanent:true,isSheetWithInput:false},ChatNewMessagesTabSheet:{isPermanent:true,isSheetWithInput:true},ChatNameConversationTabSheet:{isPermanent:true,isSheetWithInput:true},ChatEmployeeAwaySheet:{isPermanent:true,isSheetWithInput:false},ChatUserIsPersonalUserSheet:{isPermanent:true,isSheetWithInput:false},ChatUserIsWorkUserSheet:{isPermanent:true,isSheetWithInput:true},ChatPageResponsivenessIndicator:{isPermanent:true,isSheetWithInput:false},ChatEventReminderTabSheet:{isPermanent:true,isSheetWithInput:false},ChatAppointmentBanner:{isPermanent:true,isSheetWithInput:false},ChatMontageSheet:{isPermanent:!c('MercuryConfig').FantaTabView,isSheetWithInput:false},ChatJoinCallSheet:{isPermanent:true,isSheetWithInput:false},FantaAddFriendsSheet:{isPermanent:true,isSheetWithInput:true},FantaAddMoreFriendsSheet:{isPermanent:false,isSheetWithInput:true},ChatRoomAssociatedObjectSheet:{isPermanent:true,isSheetWithInput:false}},i={canReplaceOpenSheet:function j(k,l){var m=this.getType(l),n=this.isPermanent(l),o=this.isSheetWithInput(l),p=this.getType(k),q=this.isPermanent(k),r=this.isSheetWithInput(k);if(r)return !!(m!==p&&o);if(q&&!n)return false;if(p===this.sheets.ChatThreadIsMessageBlockedSheet)return false;return true;},getType:function j(k){var l=k.getType||k.type&&k.type.getType||function(){return k;},m=l.call(k);return m;},isPermanent:function j(k){if(typeof k==='string'&&h[k])return h[k].isPermanent;var l=k.isPermanent||k.type&&k.type.isPermanent||function(){return false;},j=l.call(k);return j;},isSheetWithInput:function j(k){if(typeof k==='string'&&h[k])return h[k].isSheetWithInput;var l=k.isSheetWithInput||k.type&&k.type.isSheetWithInput||function(){return false;},j=l.call(k);return j;},sheets:c('keyMirror')(h)};f.exports=i;}),null);
__d('ChatTabSheetController',['Bootloader','ChatTabSheetListener','Deferred','MercurySheetPolicy'],(function a(b,c,d,e,f,g){var h=function i(j,k,l,m){this._threadID=j;this._rootElement=k;this._tabElement=l;this._view=m;this._deferred=new (c('Deferred'))();this._isLoading=false;this._listener=new (c('ChatTabSheetListener'))(this._threadID,this);};Object.assign(h.prototype,{openAddFriendsSheet:function i(){this._load(function(){this._addFriendsTabSheet.open();}.bind(this));},openAppointmentBannerSheet:function i(j,k,l,m,n){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatAppointmentBanner,{pageID:j,userID:k,count:l,messageList:m,appointmentBannerDidUpdate:n});}.bind(this));},openMessageBlockedTabSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}.bind(this));},getAddFriendsParticipants:function i(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function i(j){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet,{automatic:j});}.bind(this));},openReadOnlySheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}.bind(this));},openPermanentReadOnlySheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}.bind(this));},openNewMessagesSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}.bind(this));},openUploadWarningTabSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUploadWarningTabSheet);}.bind(this));},openThreadIsMutedTabSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}.bind(this));},openEmployeeAwaySheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatEmployeeAwaySheet);}.bind(this));},openBypassFocusSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserFocusBypassSheet);}.bind(this));},openUserFocusSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserFocusSheet);}.bind(this));},openMontageSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatMontageSheet);}.bind(this));},openUserTimezoneSheet:function i(j){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserTimezoneSheet,j);}.bind(this));},openUserIsPersonalUserSheet:function i(j,k){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserIsPersonalUserSheet,{myself:j,participant:k});}.bind(this));},openUserIsWorkUserSheet:function i(j,k){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserIsWorkUserSheet,{myself:j,participant:k});}.bind(this));},openOfflineSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}.bind(this));},openUserBlockedSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);}.bind(this));},openNoRecipientsSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);}.bind(this));},openPageResponsivenessSheet:function i(j,k){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator,{description:j,threadID:k});}.bind(this));},openChatEventReminderTabSheet:function i(){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet);}.bind(this));},openChatJoinCallSheet:function i(j,k){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatJoinCallSheet,{rtcCallData:j,threadFBID:k});}.bind(this));},openChatRoomAssociatedObjectSheet:function i(j){this._load(function(){this._sheetView.open(c('MercurySheetPolicy').sheets.ChatRoomAssociatedObjectSheet,{associatedObject:j});}.bind(this));},closeAddFriendsSheet:function i(){this._lazy(function(){this._addFriendsTabSheet.close();}.bind(this));},closeAppointmentBannerSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatAppointmentBanner);}.bind(this));},closeThreadIsMutedTabSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}.bind(this));},closeUserBlockedSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);}.bind(this));},closeUserFocusSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatUserFocusSheet);}.bind(this));},closeMontageSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatMontageSheet);}.bind(this));},closeUploadWarningTabSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatUploadWarningTabSheet);}.bind(this));},closeMessageBlockedTabSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}.bind(this));},closeOfflineSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);}.bind(this));},closeNoRecipientsSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);}.bind(this));},closeNewMessagesSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}.bind(this));},closeAutomaticNameConversationSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}.bind(this));},closePageResponsivenessSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator);}.bind(this));},closeChatEventReminderTabSheet:function i(){this._lazy(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet);}.bind(this));},closePermanentReadOnlySheet:function i(){this._load(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}.bind(this));},closeChatJoinCallSheet:function i(){this._load(function(){this._sheetView.close(c('MercurySheetPolicy').sheets.ChatJoinCallSheet);}.bind(this));},isNewMessagesSheetOpened:function i(){return !!this._sheetView&&this._sheetView.isNewMessagesSheetOpened();},isMontageSheetOpen:function i(){return this._sheetView.isMontageSheetOpen();},onResize:function i(j){this._lazy(function(){this._sheetView.subscribe('resize',j);}.bind(this));},onTokensChanged:function i(j){this._lazy(function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',j);}.bind(this));},onEscape:function i(j){this._lazy(function(){this._addFriendsTabSheet.subscribe('esc-pressed',j);}.bind(this));},destroy:function i(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();},_load:function i(j){this._bootload();this._deferred.done(j);},_lazy:function i(j){this._deferred.done(j);},_bootload:function i(){if(this._isLoading)return;this._isLoading=true;c('Bootloader').loadModules(["ChatAddFriendsTabSheet","MercurySheetView"],function(j,k){this._sheetView=new k(this._threadID,this._rootElement,this._tabElement,this._view);this._addFriendsTabSheet=new j(this._threadID,this._rootElement,this._sheetView,this._view);this._deferred.resolve();}.bind(this),'ChatTabSheetController');}});f.exports=h;}),null);
__d('MoveToWorkUtils',['CurrentUser'],(function a(b,c,d,e,f,g){'use strict';function h(){return c('CurrentUser').isEmployee()&&c('CurrentUser').hasWorkUser();}f.exports={isViewerEligible:h};}),null);
__d("XPagesMercuryIndicatorController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});}),null);
__d('PagesMercuryChatTabIndicatorHandler',['AsyncRequest','AvailableListConstants','ChatPrivacyActionController','ChatVisibility','FBID','MercuryIDs','PresencePrivacy','XPagesMercuryIndicatorController'],(function a(b,c,d,e,f,g){'use strict';h.tryCreateHandler=function(i,j,k,l){var m=c('MercuryIDs').getUserIDFromThreadID(i);if(!m||c('FBID').isUser(m))return null;return new h(m,j,k,l);};function h(i,j,k,l){this.$PagesMercuryChatTabIndicatorHandler2=false;this.$PagesMercuryChatTabIndicatorHandler3=false;this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler5=j;this.$PagesMercuryChatTabIndicatorHandler6=false;this.$PagesMercuryChatTabIndicatorHandler7=i;this.$PagesMercuryChatTabIndicatorHandler10=k;this.$PagesMercuryChatTabIndicatorHandler9=l;this.$PagesMercuryChatTabIndicatorHandler8=new (c('ChatPrivacyActionController'))(i,function(m){return this.$PagesMercuryChatTabIndicatorHandler11(m);}.bind(this));}h.prototype.__getEnableTimeSwitch=function(){return this.$PagesMercuryChatTabIndicatorHandler2;};h.prototype.__getIsShown=function(){return this.$PagesMercuryChatTabIndicatorHandler4;};h.prototype.__getPageOnlineStatus=function(){return this.$PagesMercuryChatTabIndicatorHandler5;};h.prototype.__getShouldPreventFutureShown=function(){return this.$PagesMercuryChatTabIndicatorHandler6;};h.prototype.__getTargetID=function(){return this.$PagesMercuryChatTabIndicatorHandler7;};h.prototype.__getIsChecking=function(){return this.$PagesMercuryChatTabIndicatorHandler3;};h.prototype.__getResponsivenessDescription=function(){return this.$PagesMercuryChatTabIndicatorHandler1;};h.prototype.checkResponsiveness=function(){if(this.$PagesMercuryChatTabIndicatorHandler3)return;var i=c('XPagesMercuryIndicatorController').getURIBuilder().getURI();this.$PagesMercuryChatTabIndicatorHandler3=true;new (c('AsyncRequest'))().setURI(i).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler7}).setHandler(function(j){this.$PagesMercuryChatTabIndicatorHandler3=false;var k=j.payload;if(k.responsiveness)this.$PagesMercuryChatTabIndicatorHandler12(k.responsiveness,k.enableTimeSwitch);}.bind(this)).send();};h.prototype.hideIndicator=function(){this.$PagesMercuryChatTabIndicatorHandler13(false);};h.prototype.hideIndicatorAndPreventFutureShow=function(){this.$PagesMercuryChatTabIndicatorHandler13(true);};h.prototype.$PagesMercuryChatTabIndicatorHandler13=function(i){this.$PagesMercuryChatTabIndicatorHandler6=this.$PagesMercuryChatTabIndicatorHandler6||i;if(this.$PagesMercuryChatTabIndicatorHandler4){this.$PagesMercuryChatTabIndicatorHandler4=false;this.$PagesMercuryChatTabIndicatorHandler9();}};h.prototype.showIndicator=function(){if(this.$PagesMercuryChatTabIndicatorHandler4||this.$PagesMercuryChatTabIndicatorHandler5!==c('AvailableListConstants').OFFLINE||!this.$PagesMercuryChatTabIndicatorHandler1||!c('ChatVisibility').isOnline()||!c('PresencePrivacy').allows(this.$PagesMercuryChatTabIndicatorHandler7)||this.$PagesMercuryChatTabIndicatorHandler6)return;this.$PagesMercuryChatTabIndicatorHandler4=true;this.$PagesMercuryChatTabIndicatorHandler10(this.$PagesMercuryChatTabIndicatorHandler1,this.$PagesMercuryChatTabIndicatorHandler7);};h.prototype.notifyPageOnlineStatusChanged=function(i){if(this.$PagesMercuryChatTabIndicatorHandler5===i)return;this.$PagesMercuryChatTabIndicatorHandler5=i;if(!this.$PagesMercuryChatTabIndicatorHandler2)return;switch(i){case c('AvailableListConstants').ACTIVE:this.hideIndicator();break;default:this.showIndicator();break;}};h.prototype.$PagesMercuryChatTabIndicatorHandler12=function(i,j){this.$PagesMercuryChatTabIndicatorHandler1=i;this.$PagesMercuryChatTabIndicatorHandler2=j;this.showIndicator();};h.prototype.$PagesMercuryChatTabIndicatorHandler11=function(i){switch(i){case c('ChatPrivacyActionController').OFFLINE:case c('ChatPrivacyActionController').BLOCKED:this.$PagesMercuryChatTabIndicatorHandler13(true);break;}};f.exports=h;}),null);
__d("XGroupCallNuxController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/groupcall\/nux\/",{action:{type:"String",required:true}});}),null);
__d("XNativeComponentFlowBookingRequestCountController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/platform\/native-component-flow\/booking_request_count\/",{page_id:{type:"FBID",required:true},user_id:{type:"FBID",required:true}});}),null);
__d('ChatTabView',['csx','cx','fbt','Promise','AsyncRequest','AsyncSignal','AvailableListConstants','BootloadedComponent.react','Bootloader','ChatBehavior','ChatConfig','ChatNubLogger','ChatPerfInstrumentation','ChatTabBlinking','ChatTabComposerContainer.react','ChatTabHeaderContainer.react','ChatTabLazyFocus','ChatTabMessagesView','ChatTabSheetController','ChatTabViewEvents','ChatTitleLink.react','ChatVisibility','CSS','CurrentUser','Dock','DOM','DOMQuery','DragDropTarget','EmojiLikeUtils','EmojiState','Event','FantaDispatcher','FantaTabActions','FBID','JSResource','Keys','LogHistory','Map','MercuryBlockedParticipants','MercuryCanonicalGroupThreadManager','MercuryConfig','MercuryIDs','MercuryParticipants','MercuryShareAttachmentRenderLocations','MercurySourceType','MercuryThreadInfo','MercuryThreadTitle.react','MercuryTypingAnimation.react','MercuryTypingReceiver','MercuryViewer','MessageRequestUtils','MessagingTag','MessengerAdminGroupUtils','MessengerEmojiUsageUtils','MessengerJoinableModeType','MNCommercePostbackCTADataManager','MoveToWorkUtils','NubController','PagesMercuryChatTabIndicatorHandler','Parent','PhotosUploadWaterfall','PresenceStatus','React','ReactComponentRenderer','ReactDOM','Run','Scroll','ShortProfiles','SimpleXUIDialog','SiteData','Style','SubscriptionsHandler','ChatTabTemplates','TooltipData','TypingDetectorController','WaterfallIDGenerator','WorkFileUploadsGating','WorkFocusModeController','WorkModeConfig','XGroupCallNuxController','createCancelableFunction','convertMIGColorToFIGColor','emptyFunction','getActiveElement','getGroupNameTooltipFromParticipantIDs','getTitleHrefFromThreadID','getVendorPrefixedEventName','ifRequired','isEmpty','isInFocusMode','requireWeak','MercuryMessageObject','MercuryMessages','MercuryServerRequests','MercuryThreadActions','MercuryThreadIDMap','MercuryThreadInformer','MercuryThreads','MercuryMessageActions','XMNCommercePageNullStateCTAController','XNativeComponentFlowBookingRequestCountController'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k=c('MercuryTypingReceiver').get(),l=c('getGroupNameTooltipFromParticipantIDs').getGroupNameTooltipFromParticipantIDsAsync,m=c('MercuryMessageObject').get(),n=c('MercuryMessages').get(),o=c('MercuryServerRequests').get(),p=c('MercuryThreadActions').get(),q=c('MercuryThreadIDMap').get(),r=c('MercuryThreadInformer').get(),s=c('MercuryThreads').get(),t=c('MercuryMessageActions').get(),u=/^\s*$/,v=c('WorkFocusModeController').WorkFocusMode,w=new (c('Map'))(),x=960,y=/\D+/g,z=c('ChatConfig').get('chat_send_link_without_share'),aa=c('ChatConfig').get('chat_full_react_header'),ba=c('LogHistory').getInstance('chat_tab_view');c('requireWeak')('AvailableList',function(ra){ra.subscribe(c('AvailableListConstants').ON_AVAILABILITY_CHANGED,oa);});function ca(ra,sa){l(sa,function(ta){if(!ta){c('TooltipData').remove(ra);}else c('TooltipData').set(ra,ta,'above');});}function da(ra){var sa=c('MercuryIDs').tokenize(ra);switch(sa.type){case 'user':return c('ChatTabTemplates')[':fb:mercury:chat:user-tab'].build();}return c('ChatTabTemplates')[':fb:mercury:chat:multichat-tab'].build();}function ea(ra){ra.tryMarkAsRead();var sa=ra._getInputValue();c('EmojiState').updateRecentlyUsed(c('MessengerEmojiUsageUtils').findAllEmojis(sa));var ta=ra._filesUploader,ua=ta?ta.getAttachments():[];if(ja(ra))ga(ra,sa,ua,function(va){va=qa(va,ta);t.send(va,function(wa){var xa=s.getThreadMetaNow(wa);if(xa&&c('MessageRequestUtils').isMessageRequest(xa))p.movePendingToInbox(wa);if(xa&&xa.other_user_fbid&&!c('FBID').isUser(xa.other_user_fbid))c('ChatTabViewEvents').inform('chat-send-to-page',{pageID:xa.other_user_fbid});});ta&&ta.removeAttachments();if(ra._sharePreview)ra._sharePreview.setProps({share:null,uri:null});if(z&&ra._urlScraperData)delete ra._urlScraperData;ra._composer&&ra._composer.onSend(va);ra._typingDetector&&ra._typingDetector.resetState();if(ra._messagesView){ra._messagesView.messageSent();ra.tryMarkAsRead();}});}function fa(ra,sa){if(sa===0)return;la(ra,c('PhotosUploadWaterfall').POST_PUBLISHED,{count:sa});ra._waterfallID=c('WaterfallIDGenerator').generate();}function ga(ra,sa,ta,ua){s.getThreadMeta(ra._threadID,function(va){if(va&&va.is_canonical&&!c('MercuryThreadInfo').canReply(va)){ra._showMessageBlockedDialog(va);return;}var wa=c('MercurySourceType').CHAT_WEB,xa=m.constructUserGeneratedMessageObject(sa,wa,ra._threadID),ya=ra._getMentions();if(ya&&ya.length)xa.profile_ranges=xa.profile_xmd=ya;if(ta.length>0){xa.has_attachment=true;xa.raw_attachments=ta;}if(!ra.is_emoji_like&&ra._sharePreview&&ra._sharePreview.component){var za=ra._sharePreview.component.getShareData();if(za){xa.has_attachment=true;xa.shareable_attachment=za;}}if(s.isNewEmptyLocalThread(ra._threadID)){var ab=ra._sheetController.getAddFriendsParticipants();ra._sheetController.closeAddFriendsSheet();if(ab===null||ab.length===0)return;ab=ab.filter(function(db){return db!=c('MercuryViewer').getID();});if(ab.length===0){xa.thread_id=c('MercuryIDs').getThreadIDFromUserID(c('CurrentUser').getID());}else if(ab.length===1){xa.thread_id=c('MercuryIDs').getThreadIDFromParticipantID(ab[0]);}else{var bb=ra.getMessagesView().getThreadID();if(bb!=ra._threadID)xa.thread_id=bb;p.addParticipants(ra._threadID,ab);}}if(s.isEmptyLocalThread(ra._threadID)){xa.offline_threading_id=c('MercuryIDs').tokenize(ra._threadID).value;var cb=s.getThreadMetaNow(va.thread_id);xa.specific_to_list=Array.from(cb.participants);}if(xa!=undefined)xa.signatureID=ra._signatureID;xa.ui_push_phase=c('SiteData').push_phase;ua(xa);if(ra._threadID!==xa.thread_id&&!ra.isUploading()){if(v&&c('isInFocusMode')()&&!c('isInFocusMode')(ra._threadID))v.addBypassFocusModeForThread(xa.thread_id);c('FantaTabActions').replaceTab(ra._threadID,xa.thread_id);}});}function ha(ra){ra._blocked=true;ra._sheetController.openUploadWarningTabSheet();}function ia(ra){return ra.isUploading();}function ja(ra){var sa=ra._getInputValue();if(!u.test(sa))return true;var ta=ra._filesUploader;if(ta&&(ta.getAttachments().length>0||ta.getImageFiles().length>0||ta.getAnimatedImageFiles().length>0||ta.getVideoFiles().length>0||ta.getAudioFiles().length>0||ta.getFiles().length>0))return true;if(ra._sharePreview&&ra._sharePreview.component.getShareData())return true;return false;}function ka(ra){ra._nubController.flyoutContentChanged();var sa=ra._getNode('attachmentShelf');c('Scroll').setTop(sa,sa.scrollHeight);}function la(ra,sa,ta){c('PhotosUploadWaterfall').sendSignal(babelHelpers['extends']({qn:ra._waterfallID,step:sa,uploader:c('PhotosUploadWaterfall').APP_CHAT},ta||{}));}function ma(ra,sa,ta,ua,va,wa){if(sa)o.ensureThreadIsFetched(sa);this._threadID=ra;this._signatureID=ta;this._isLastTab=wa;this._rtcNuxShown=false;this._eventListeners=[];this._onlineStatus=c('AvailableListConstants').OFFLINE;this._tabTemplate=da(ra);this._tabElem=this._tabTemplate.getRoot();if(va&&va.getTabElem()){this.insertBefore(va);}else this.appendTo(ua);this._messagesView=null;this._customColor=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._nubButton=c('DOMQuery').scry(this._tabElem,".fbNubButton")[0];this._originalBodyHeight=0;this._waterfallID=c('WaterfallIDGenerator').generate();this._subscriptionsHandler=new (c('SubscriptionsHandler'))();this._canonicalGroupSearchSubscriptionID=null;this._headerPromise=new (c('Promise'))(function(eb){this._headerPromiseResolve=eb;}.bind(this));this._initializeSheetController();var xa=[c('emptyFunction'),this._initializeDockUIListeners.bind(this),this.updateAvailableStatus.bind(this),this.updateTab.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this)],ya=this._initializeHeader.bind(this);this._flyoutInitializers=[this._initializeUIListeners.bind(this),this._initializeTitleHREF.bind(this),this._initializeInput.bind(this),this._initializeDragDropTarget.bind(this),this._initializeUnloadListeners.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializePagesGreeting.bind(this)];if(aa){xa.push(ya);}else this._flyoutInitializers.unshift(ya);for(var za=xa,ab=Array.isArray(za),bb=0,za=ab?za:za[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var cb;if(ab){if(bb>=za.length)break;cb=za[bb++];}else{bb=za.next();if(bb.done)break;cb=bb.value;}var db=cb;db();}w.set(ra,this);this._logOpenTab();}function na(ra){if(ra._photoUploader&&ra._photoUploader.isUploading())la(ra,c('PhotosUploadWaterfall').CANCEL_DURING_UPLOAD);}function oa(){for(var ra=w.values(),sa=Array.isArray(ra),ta=0,ra=sa?ra:ra[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ua;if(sa){if(ta>=ra.length)break;ua=ra[ta++];}else{ta=ra.next();if(ta.done)break;ua=ta.value;}var va=ua;va.updateAvailableStatus();va.updateTitlebarTooltip();}}c('ChatBehavior').subscribe(c('ChatBehavior').ON_CHANGED,function(){for(var ra=w.keys(),sa=Array.isArray(ra),ta=0,ra=sa?ra:ra[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ua;if(sa){if(ta>=ra.length)break;ua=ra[ta++];}else{ta=ra.next();if(ta.done)break;ua=ta.value;}var va=ua;s.getThreadMeta(va,function(wa){w.get(va)._updateUnreadCount(wa);});}});k.addRetroactiveListener('state-changed',function(ra){for(var sa in ra){var ta=ra[sa]&&ra[sa].length,ua=w.get(sa);ua&&ua.showTypingIndicator(ta);}});r.subscribe('threads-updated',function(ra,sa){for(var ta=w.keys(),ua=Array.isArray(ta),va=0,ta=ua?ta:ta[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var wa;if(ua){if(va>=ta.length)break;wa=ta[va++];}else{va=ta.next();if(va.done)break;wa=va.value;}var xa=wa,ya=w.get(xa);sa[xa]&&ya.updateTab();if(ya._newThreadIDFromPhotoUpload&&!ya.isUploading()&&sa[ya._newThreadIDFromPhotoUpload]){c('FantaTabActions').replaceTab(ya._threadID,ya._newThreadIDFromPhotoUpload);ya._newThreadIDFromPhotoUpload=null;}}});r.subscribe('threads-deleted',function(ra,sa){for(var ta=w.keys(),ua=Array.isArray(ta),va=0,ta=ua?ta:ta[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var wa;if(ua){if(va>=ta.length)break;wa=ta[va++];}else{va=ta.next();if(va.done)break;wa=va.value;}var xa=wa;if(sa[xa])c('FantaTabActions').closeTab(xa);if(s.isNewEmptyLocalThread(xa)){var ya=w.get(xa);ya.ensureValidCanonicalGroup(sa);}}});Object.assign(ma.prototype,{getThreadID:function ra(){return this._threadID;},getTabElem:function ra(){return this._tabElem;},showAddFriend:function ra(){setTimeout(function(){this._sheetController.openAddFriendsSheet();}.bind(this),0);},showNameConversation:function ra(sa){setTimeout(function(){this._sheetController.openNameConversationSheet(sa);}.bind(this),0);},hideAutomaticNameConversation:function ra(){setTimeout(function(){this._sheetController.closeAutomaticNameConversationSheet();}.bind(this),0);},isVisible:function ra(){return this._isVisible===undefined?c('CSS').shown(this._tabElem):this._isVisible;},isUploading:function ra(){return !!(this._composer&&this._composer.isUploading()||this._filesUploader&&this._filesUploader.isUploading()||!z&&this._sharePreview&&this._sharePreview.component.isLoading());},setVisibleState:function ra(sa,ta){this._isVisible=sa;this._isRaised=ta;if(ta)this._initFlyout();this._setHeaderProps({isRaised:ta});if(sa&&!ta)c('ChatPerfInstrumentation').logDisplayDone();var ua=c('CSS').shown(this._tabElem),va=c('CSS').hasClass(this._tabElem,'opened');c('CSS').conditionShow(this._tabElem,sa);c('CSS').conditionClass(this._tabElem,'minimized',!ta&&sa);c('CSS').conditionClass(this._tabElem,'opened',ta);if(!(ua&&va)&&sa&&ta){if(!this._messagesView)this._propagateUpdatedThreadID(this._threadID);this._nubController.flyoutContentChanged();this._messagesView.trackBottomIfRequired();this.setP2PChatThreadBannerContainerVisibility();}},newMessageClicked:function ra(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();},_propagateUpdatedThreadID:function ra(sa){if(this._messagesView&&this._messagesView.getThreadID()===sa)return;var ta=c('MercuryIDs').tokenize(sa);this._messagesView&&this._messagesView.destroy();this._messagesView=new (c('ChatTabMessagesView'))(sa,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,c('MercuryConfig').ShowContextBanner&&ta.type==='user',this._getNode('quickReply'),this._getNode('camQuickReply'));this._composerContainer.setProps({threadID:sa});},focus:function ra(){this._focusComposerIfPossible();c('FantaTabActions').focusTab(this._threadID);},_focusComposerIfPossible:function ra(){if(this.isChatViewable()){try{this._focusInput();}catch(sa){}}else if(aa){this._nubTitle&&this._nubTitle.component.focus();}else this._getNode('dockButton').focus();},isFocused:function ra(){var sa=c('getActiveElement')();return c('Parent').bySelector(sa,"._50mz")===this._tabElem;},hover:function ra(){c('CSS').addClass(this._tabElem,'hovered');},resetHover:function ra(){c('CSS').removeClass(this._tabElem,'hovered');},isHovered:function ra(){return c('CSS').hasClass(this._tabElem,'hovered');},hasEmptyInput:function ra(){return u.test(this._getInputValue());},getInputElem:function ra(){return this._composer&&c('ReactDOM').findDOMNode(this._composer.getInput());},getMessagesView:function ra(){return this._messagesView;},loadShareFromParams:function ra(sa,ta){this._getSharePreview().done(function(ua){ua.setProps({share:{params:ta,type:sa},uri:null});});},_linkDropped:function ra(sa){this._getSharePreview().done(function(ta){ta.setProps({share:null,uri:sa});});},_filesDropped:function ra(sa){this._loadReactMenu().then(function(ta){var ua=aa?ta.getFileUploaderPromise():ta.component.getFileUploaderPromise();if(ua)ua.done(function(va){setTimeout(function(){va.addDroppedFiles(sa);},0);});});},insertBefore:function ra(sa){c('DOM').insertBefore(sa.getTabElem(),this._tabElem);},appendTo:function ra(sa){c('DOM').appendContent(sa,this._tabElem);},nextTabIs:function ra(sa){var ta=sa&&sa.getTabElem();return this._tabElem.nextSibling==ta;},getScrollTop:function ra(){return c('Scroll').getTop(c('DOM').find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function ra(sa){c('Scroll').setTop(c('DOM').find(this._tabElem,'.fbNubFlyoutBody.scrollable'),sa);},destroy:function ra(){this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();c('ReactDOM').unmountComponentAtNode(this._getNode('animationContainer'));c('ReactDOM').unmountComponentAtNode(this._getNode('menuContainer'));if(this._addToThreadButton){this._addToThreadButton.unmount();this._addToThreadButton=null;}if(this._archiveWarning){this._archiveWarning.unmount();this._archiveWarning=null;}if(this._videoCallButton){this._videoCallButton.unmount();this._videoCallButton=null;}if(this._voiceCallButton){this._voiceCallButton.unmount();this._voiceCallButton=null;}if(this._closeButton){this._closeButton.unmount();this._closeButton=null;}if(this._title){this._title.unmount();this._title=null;}if(this._sharePreview){this._sharePreview.unmount();this._sharePreview=null;}this._subscriptionsHandler&&this._subscriptionsHandler.release();c('ReactDOM').unmountComponentAtNode(this._getNode('name'));c('ReactDOM').unmountComponentAtNode(this._getNode('footer'));c('DOM').remove(this._tabElem);w['delete'](this._threadID);c('Dock').unregisterNubController(this._nubController);},updateAvailableStatus:function ra(){s.getThreadMeta(this._threadID,function(sa){var ta=c('AvailableListConstants').OFFLINE,ua=this._getCanonicalUserID(),va=null;if(ua){ta=c('PresenceStatus').get(ua);va=c('ShortProfiles').getNow(ua);}else{var wa=sa.participants.map(function(xa){return c('MercuryIDs').getUserIDFromParticipantID(xa);});ta=c('PresenceStatus').getGroup(wa);}if(!c('ChatVisibility').isOnline())ta=c('AvailableListConstants').OFFLINE;c('CSS').conditionClass(this._tabElem,"_4-0b",ta===c('AvailableListConstants').ACTIVE&&(va===undefined||va===null||!va.is_messenger_only));this._onlineStatus=ta;this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.notifyPageOnlineStatusChanged(ta);}.bind(this));},updateTab:function ra(){s.getThreadMeta(this._threadID,function(sa){this.updateTitlebar(sa);this._updateControls(sa);this._updateMessageBlockSettings(sa);this._updateMessageManageSettings(sa);this._updateMutingSettings(sa);this._updateUnreadCount(sa);this._updateArchiveWarning(sa);this._updateEmployeeAwayWarning(sa);this._updateUserInFocusWarning(sa);this._updateOfficeStatus(sa);this._updateUserTimezoneWarning(sa);this._updatePersonalUserWarning(sa);this._updateWorkUserWarning(sa);this._updateNewThread(sa);this._updateNameConversationSheet(sa);this._updateEventReminderSheet(sa);this._updateReadOnlySheet(sa);this._updateSwitchToWork(sa);this._updateAppointmentBanner(sa);this._updateJoinCallSheet(sa);this._updateNullState(sa);this._updateAssociatedObjectSheet(sa);}.bind(this));},_updateNullState:function ra(sa){if(sa.message_count>0)if(this._composerNullState&&!c('MessageRequestUtils').isMessageRequest(sa)){c('DOM').remove(this._composerNullState);delete this._composerNullState;}},_updateEventReminderSheet:function ra(sa){c('Bootloader').loadModules(["EventReminderStateStore","EventReminderActions"],function(ta,ua){var event=sa.lightweight_event,va=sa.thread_id;if(event){ua.updateEventReminder(va,event);this._sheetController.openChatEventReminderTabSheet();}else{var wa=ta.getEvent(va);if(wa&&wa.exists)ua.deleteEventReminder(va);this._sheetController.closeChatEventReminderTabSheet();}}.bind(this),'ChatTabView');},_updateNameConversationSheet:function ra(sa){this.hideAutomaticNameConversation();},_updateReadOnlySheet:function ra(sa){var ta=c('MercuryThreadInfo').showComposer(sa),ua=c('MercuryThreadInfo').canReply(sa),va=s.isEmptyLocalThread(sa.thread_id);if(c('MercuryConfig').ColdOpenBlock&&c('MercuryThreadInfo').isColdOpen(sa)){this._sheetController.openPermanentReadOnlySheet();}else this._sheetController.closePermanentReadOnlySheet();if(c('MercuryConfig').ViewerIsReadOnly){this._sheetController.openPermanentReadOnlySheet();}else if(!ua&&!ta&&!va)this._sheetController.openReadOnlySheet();},_updateJoinCallSheet:function ra(sa){var ta=sa.rtc_call_data,ua=sa.thread_fbid;if(ta&&ta.call_state!=='NO_ONGOING_CALL'&&ua){this._sheetController.openChatJoinCallSheet(ta,ua);}else this._sheetController.closeChatJoinCallSheet();},_updateAssociatedObjectSheet:function ra(sa){var ta=sa.associated_object;ta&&this._sheetController.openChatRoomAssociatedObjectSheet(ta);},_updateMessageManageSettings:function ra(sa){var ta=c('MercuryIDs').getParticipantIDFromFromThreadID(sa.thread_id),ua=ta?c('MercuryParticipants').getNow(ta):null;this._updateMenuPropsSafe({isBusinessEnabled:ua&&ua.is_business_enabled});},updateSignatureID:function ra(sa){this._signatureID=sa;},updateIsLastTab:function ra(sa){this._isLastTab=sa;this._rtcNuxShown=sa&&this._rtcNuxShown;this._voiceCallButton&&this._voiceCallButton.setProps({rtcNuxShown:this._rtcNuxShown});this._header&&this._header.setProps({rtcNuxShown:this._rtcNuxShown});},_updateMessageBlockSettings:function ra(sa){this._updateMenuPropsSafe({hasMessageBlocked:c('MercuryBlockedParticipants').get().isMessageBlocked(sa),isEmptyConversation:sa&&sa.message_count==0});},_updateMutingSettings:function ra(sa){var ta=!!sa&&c('MercuryThreadInfo').isMuted(sa);ta&&!this._reactChatTabMenu&&this._loadReactMenu();this._updateMenuPropsSafe({isMuted:ta});},_updateMenuPropsSafe:function ra(sa){if(aa){this._header&&this._header.component.setAdditionalMenuProps(sa);return;}if(this._menuPromise)this._menuPromise.then(function(ta){ta&&ta.component&&ta.component.isMounted()&&ta.setProps(sa);});},_updateArchiveWarning:function ra(sa){if(c('CurrentUser').isEmployee())c('MercuryParticipants').getMulti(sa.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function ra(sa){if(!c('CurrentUser').isEmployee())return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatEmployeeAwayWarning"],function(ta){ta.updateEmployeeAwayWarning(sa,function(){this._sheetController.openEmployeeAwaySheet();}.bind(this),c('emptyFunction'));}.bind(this),'ChatTabView');}.bind(this));},_updateUserInFocusWarning:function ra(sa){c('ifRequired')('ChatUserFocusWarning',function(ta){ta.updateUserFocusWarning(sa,function(ua){ua?this._sheetController.openBypassFocusSheet():this._sheetController.openUserFocusSheet();}.bind(this),function(){this._sheetController.closeUserFocusSheet();}.bind(this));}.bind(this));},_getTimezoneWarning:function ra(){if(!this._timezoneModulePromise)this._timezoneModulePromise=new (c('Promise'))(function(sa){c('requireWeak')('ChatTimezoneWarning',sa);});return this._timezoneModulePromise;},_updateUserTimezoneWarning:function ra(sa){this._getTimezoneWarning().done(function(ta){ta.updateUserTimezoneWarning(sa,function(ua){this._sheetController.openUserTimezoneSheet(ua);}.bind(this),c('emptyFunction'));}.bind(this));},_getPersonalUserWarning:function ra(){if(!this._personalUserWarningModulePromise)this._personalUserWarningModulePromise=new (c('Promise'))(function(sa){c('requireWeak')('ChatUserPersonalUserWarning',sa);});return this._personalUserWarningModulePromise;},_updatePersonalUserWarning:function ra(sa){this._getPersonalUserWarning().done(function(ta){ta.updateEmployeePersonalUserWarning(sa,function(ua,va){this._sheetController.openUserIsPersonalUserSheet(ua,va);}.bind(this),c('emptyFunction'));}.bind(this));},_getWorkUserWarning:function ra(){if(!this._workUserWarningModulePromise)this._workUserWarningModulePromise=new (c('Promise'))(function(sa){c('requireWeak')('ChatUserWorkUserWarning',sa);});return this._workUserWarningModulePromise;},_updateWorkUserWarning:function ra(sa){this._getWorkUserWarning().done(function(ta){ta.updateEmployeeWorkUserWarning(sa,function(ua,va){this._sheetController.openUserIsWorkUserSheet(ua,va);}.bind(this),c('emptyFunction'));}.bind(this));},_updateOfficeStatus:function ra(sa){var ta=this._getNode('officeStatus');if(!ta||c('MercuryIDs').isGroupChat(sa.thread_id))return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatTabOfficeStatus"],function(ua){var va=c('MercuryIDs').getParticipantIDFromUserID(sa.other_user_fbid);c('MercuryParticipants').get(va,function(wa){ua.update(ta,wa);});},'ChatTabView');});},_updateSwitchToWork:function ra(sa){if(c('MoveToWorkUtils').isViewerEligible()&&c('MercuryIDs').isGroupChat(sa.thread_id)){c('MercuryParticipants').getMulti(sa.participants,function(ta){var ua=this._isEmployeesOnly(ta);this._updateMenuPropsSafe({hasSwitchToWork:ua});}.bind(this));}else this._updateMenuPropsSafe({hasSwitchToWork:false});},_updateControls:function ra(sa,ta,ua){var va=this._isPageChat(),wa=c('MercuryThreadInfo').showComposer(sa)&&(!c('isEmpty')(sa.participants)||!!ta)&&!this._composerNullState&&!c('MercuryConfig').ViewerIsReadOnly&&!(c('MercuryConfig').ColdOpenBlock&&(c('MercuryThreadInfo').isColdOpen(sa)||c('MercuryThreadInfo').isEmptyLocalThread(sa))),xa=this._getNode('footer');c('CSS').conditionShow(xa,wa);c('CSS').conditionShow(this._getNode('menuContainer'),wa);var ya={isEmptyChat:s.isNewEmptyLocalThread(sa.thread_id),show:wa};if(va)ya.showAddFriend=null;this._updateMenuPropsSafe(ya);var za=wa&&!va;this._addToThreadButton&&this._addToThreadButton.setProps({shown:za});var ab=sa.joinable_mode&&sa.joinable_mode.mode===c('MessengerJoinableModeType').JOINABLE,bb=sa.participants.length>1&&!ab&&c('MercuryThreadInfo').canReply(sa)&&!s.isNewEmptyLocalThread(this._threadID);this._voiceCallButton&&this._voiceCallButton.setProps({shown:bb});this._videoCallButton&&this._videoCallButton.setProps({shown:bb});if(c('MercuryIDs').isGroupChat(this._threadID)&&sa.rtc_call_data){this._voiceCallButton&&this._voiceCallButton.setProps({rtcCallData:sa.rtc_call_data});this._videoCallButton&&this._videoCallButton.setProps({rtcCallData:sa.rtc_call_data});}if(ua&&ua.length===1&&c('MercuryConfig').ShowContextBanner){this._messagesView&&this._messagesView.renderContextBanner(null,ua[0].info&&ua[0].info.uid);}else this._messagesView&&this._messagesView.unmountContextBanner();},_updateNewThread:function ra(sa){if(s.isNewEmptyLocalThread(sa.thread_id))this.showAddFriend();},_isEmployeesOnly:function ra(sa){for(var ta in sa)if(!sa[ta].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function ra(sa){var ta=this._isEmployeesOnly(sa)&&Object.keys(sa).length>1,ua=this._getNode('archiveContainer');if(ua){if(this._titlebarTooltipAnchor)c('CSS').conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',ta);c('CSS').conditionShow(ua,ta);this._archiveWarning&&this._archiveWarning.setProps({shown:ta});}},updateTitlebarTooltip:function ra(){if(!this._title)return;s.getThreadMeta(this._threadID,function(sa){var ta=c('ReactDOM').findDOMNode(this._title.component);if(!ta)return;ca(ta,sa.participants);}.bind(this));},_getNode:function ra(sa){return this._tabTemplate.getNode(sa);},_getCanonicalUserID:function ra(){return c('MercuryIDs').getUserIDFromThreadID(this._threadID);},_listen:function ra(sa,event,ta,ua){var va=this._getNode(sa);if(va){this._eventListeners.push(c('Event').listen(va,event,ta.bind(this)));}else if(!ua)throw new Error('Could not find node "'+sa+'"');},_closePreClicked:function ra(sa){this._closeMouseDown=true;},_closeClicked:function ra(sa){this._cleanClose();if(typeof sa.kill==='function'){sa.kill();}else sa.preventDefault();},_cleanClose:function ra(){this._dismissRTCNux();na(this);var sa=function(){c('FantaTabActions').closeTab(this._threadID);v&&v.removeBypassFocusModeForThread(this._threadID);}.bind(this);if(this.hasEmptyInput()){this.animateClose(sa);}else{var ta=j._("Are you sure you want to close this chat window?"),ua=j._("You haven't sent your message.");c('SimpleXUIDialog').showConfirm(ta,ua,function(va){if(va){this.animateClose(sa);}else this.focus();}.bind(this),{autofocusConfirm:true,useReactFocusBehavior:true});}},animateClose:function ra(sa){this._animationendFailsafeTimeout=setTimeout(sa,1.2*c('ifRequired')('cssVar',function(ua){return "200ms".replace(y,'');},function(){return 200;}));var ta=c('Event').listen(this._tabElem,c('getVendorPrefixedEventName')('animationend'),function(ua){if(ua.animationName==='closeChatTab'){sa();clearTimeout(this._animationendFailsafeTimeout);}}.bind(this));this._subscriptionsHandler&&this._subscriptionsHandler.addSubscriptions(ta);c('CSS').addClass(this._tabElem,"_2suj");},_closeEnter:function ra(sa){if(sa.keyCode===c('Keys').RETURN)this._closeClicked(sa);},_nubClicked:function ra(sa){if(this._isRaised)return;if(this._closeMouseDown)return;if(typeof sa.kill==='function'){sa.kill();}else sa.preventDefault();this._isRaised=true;this._initFlyout();this.resetHover();c('FantaTabActions').unminimizeTab(this._threadID);this.focusTab();},_nubHovered:function ra(){var sa=c('CSS').hasClass(this._tabElem,'highlightTab');if(sa)this.hover();},_dockKeyDown:function ra(sa){if(sa.keyCode===c('Keys').RETURN||sa.keyCode===c('Keys').SPACE){c('FantaTabActions').unminimizeTab(this._threadID);if(typeof sa.kill==='function'){sa.kill();}else sa.preventDefault();}else this._handleHotkeyPressed(sa);},_handleHotkeyPressed:function ra(sa){if(sa.keyCode===c('Keys').ESC){this._handleEscape();if(typeof sa.kill==='function'){sa.kill();}else sa.preventDefault();}else if(sa.keyCode===c('Keys').TAB)this._handleTabPressed(sa);},_handleTabPressed:function ra(event){if(!event.ctrlKey)if(event.shiftKey){c('FantaTabActions').focusPreviousTab(event);}else c('FantaTabActions').focusNextTab(event);},_handleEscape:function ra(){this._cleanClose();},_titleClicked:function ra(event){this._dismissRTCNux();var sa=event.getTarget();if(!c('Parent').byClass(sa,'titlebarText')&&!c('Parent').byClass(sa,'uiSelector')&&(!c('Parent').bySelector(sa,"._3olv")||c('Parent').bySelector(sa,"._14lt"))&&!c('Parent').byClass(sa,'close')){event.kill();this._isRaised=false;c('FantaTabActions').minimizeTab(this._threadID);this.focus();this.resetHover();}},_titleHovered:function ra(){var sa=c('CSS').hasClass(this._tabElem,'highlightTab');if(sa)this.hover();},_addFriendLinkClicked:function ra(){this.showAddFriend();},_focusInput:function ra(){c('ChatNubLogger').processEvent('focus',this._threadID);this._composer?this._composer.getInput().focus():this._focusOnComposerMount=true;},_focusTab:function ra(){if(!c('FantaDispatcher').isDispatching())c('FantaTabActions').focusTab(this._threadID);this.focusTab();},focusTab:function ra(){c('CSS').addClass(this._tabElem,'focusedTab');if(this._isRaised)this.tryMarkAsRead();this._closeMouseDown=false;if(aa){this._setHeaderProps({isActive:true});}else this._setCloseTooltip(true);this._focusComposerIfPossible();},blurTab:function ra(){c('ChatNubLogger').processEvent('blur',this._threadID);c('CSS').removeClass(this._tabElem,'focusedTab');if(aa){!this._closeMouseDown&&this._setHeaderProps({isActive:false});}else !this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function ra(sa){if(this._closeButton){this._closeButton.setProps({active:sa});return;}var ta=this._getNode('titlebarCloseButton');if(!ta)return;var ua=sa?j._("Press Esc to close"):j._("Close tab");c('TooltipData').set(ta,ua,'above');},_initFlyout:function ra(event){this._initFlyout=c('emptyFunction');for(var sa=this._flyoutInitializers,ta=Array.isArray(sa),ua=0,sa=ta?sa:sa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var va;if(ta){if(ua>=sa.length)break;va=sa[ua++];}else{ua=sa.next();if(ua.done)break;va=ua.value;}var wa=va;wa();}},_inputKeyDown:function ra(event){this.tryMarkAsRead();if(event.keyCode===c('Keys').RETURN&&!event.shiftKey){if(ia(this)){ha(this);event.kill&&event.kill();return;}ea(this);event.kill?event.kill():event.preventDefault();return;}if(event.keyCode===c('Keys').DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();c('FantaTabActions').minimizeTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function ra(sa){var ta=this._getCanonicalUserID();if(!ta)return;var ua='fbid:'+ta;c('MercuryParticipants').get(ua,function(va){c('Bootloader').loadModules(["MessageBlockedDialog"],function(wa){wa.show(sa.thread_id,sa.can_reply,c('MercuryBlockedParticipants').get().isMessageBlocked(sa),va.short_name);},'ChatTabView');});},_initializeInput:function ra(){this._composerContainer=new (c('ReactComponentRenderer'))(c('ChatTabComposerContainer.react'),this._getNode('footer'));this._composerContainer.setProps({disableFileUploads:!c('WorkFileUploadsGating').canUploadFiles,initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onMount:function(sa){this._composer=sa;var ta=false;if(this._focusOnComposerMount){ta=true;this._focusOnComposerMount=false;}if(c('ChatTabLazyFocus').get()===this._threadID){ta=true;c('ChatTabLazyFocus').clear();}if(ta)setTimeout(function(){this._composer.getInput().focus();}.bind(this),0);}.bind(this),onBlur:this.blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),resizeFn:function(){this._nubController.flyoutContentChanged();}.bind(this),onCustomLikeSelect:this._customLikeSelected.bind(this),onFileUploadFail:this._handleFileLastUploadFailed.bind(this),onP2PTrigger:this._p2pTriggered.bind(this),onPhotoUploadFail:this._handlePULastUploadFailed.bind(this),onStickerSelect:this._stickerSelected.bind(this),onUploadCancel:this._handlePULastUploadCanceled.bind(this),onUploadComplete:this._handlePUAllUploadsCompleted.bind(this),onUploadSubmit:this._handleUploadSubmit.bind(this),threadID:this._threadID,viewer:c('CurrentUser').getID()});},_initializeSharePreview:function ra(sa,ta){c('Event').listen(sa,'keyup',function(){var ua=ta?ta():sa.value;if(!ua.length)if(this._urlScraper){this._urlScraper.reset();delete this._urlScraperData;}}.bind(this));c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["URLScraper"],function(ua){this._urlScraper=new ua(sa,ta);this._urlScraper.subscribe('match',function(va,wa){this._urlScraperData=wa;this._getSharePreview().done(function(xa){var ya=this._urlScraperData;xa.setProps({share:null,uri:ya&&ya.url});}.bind(this));}.bind(this));}.bind(this),'ChatTabView');}.bind(this));},_getSharePreview:function ra(){if(!this._sharePreview&&!this._sharePreviewPromise)this._sharePreviewPromise=new (c('Promise'))(function(sa){c('Bootloader').loadModules(["MercurySharePreview.react"],function(ta){this._sharePreview=new (c('ReactComponentRenderer'))(ta,this._getNode('shareAttachmentShelf'));this._sharePreview.setProps({imageSize:{width:x,height:x},location:c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:function(){ka(this);this._unblockSend();}.bind(this)});sa(this._sharePreview);}.bind(this),'ChatTabView');}.bind(this));return this._sharePreviewPromise;},_initializeThingsWithInputFn:function ra(sa,ta){this._getValueFromReactComposer=ta;this._initializeSharePreview(sa,ta);s.getThreadMeta(this._threadID,function(ua){var va,wa=this;if(ua){if(c('MessageRequestUtils').isMessageRequest(ua))(function(){var ab=c('DOM').create('div');c('DOM').appendContent(wa._getNode('chatConv'),ab);wa._composerNullState=ab;var bb=c('MessageRequestUtils').isFiltered(ua);c('ReactDOM').render(c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{height:27}}),bootloadLoader:c('JSResource')('ChatPendingActions.react').__setRef('ChatTabView'),isFiltered:bb,onDeleteClick:function(cb){if(bb){c('Bootloader').loadModules(["WebMessengerDeleteThreadDialog"],function(db){db.show(this._threadID);}.bind(this),'ChatTabView');}else{p.changeFolder(this._threadID,c('MessagingTag').OTHER);c('FantaTabActions').closeTab(this._threadID);}}.bind(wa),onReplyClick:function(cb){p.changeFolder(this._threadID,c('MessagingTag').INBOX);c('DOM').remove(ab);delete this._composerNullState;this._updateControls(ua);this._nubController.flyoutContentChanged();}.bind(wa)}),ab);})();var xa=ua.message_count===0;if(this._isPageChat()&&xa){var ya=this._getPageID(),za=c('XMNCommercePageNullStateCTAController').getURIBuilder();new (c('AsyncRequest'))().setURI(za.getURI()).setMethod('POST').setData({page_id:ya}).setHandler(function(ab){var bb,cb=this;if(ab&&ab.payload)(function(){var db=c('DOM').create('div');cb._composerNullState=db;var eb=ab.payload;c('DOM').appendContent(cb._getNode('chatConv'),db);cb._composerNullState=db;c('ReactDOM').render(c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',{style:{height:27}}),bootloadLoader:c('JSResource')('ChatPageComposerNullState.react').__setRef('ChatTabView'),title:eb.title,onClick:function(fb){c('MNCommercePostbackCTADataManager').sendAndConfirm(eb.id,eb.title,this._threadID);c('DOM').remove(db);delete this._composerNullState;this._updateControls(ua);this._nubController.flyoutContentChanged();}.bind(cb)}),db);cb._updateControls(ua);cb._nubController.flyoutContentChanged();})();}.bind(this)).send();}}q.getServerIDFromClientID(this._threadID,function(ab){this._typingDetector=new (c('TypingDetectorController'))(this._getCanonicalUserID(),sa,'mercury-chat',null,ab,ta);}.bind(this));}.bind(this));},_getInputValue:function ra(){if(this._getValueFromReactComposer)return this._getValueFromReactComposer();if(!this._chatInput||!this._chatInput.component.isMounted())return '';return this._chatInput.component.getValue()||'';},_getMentions:function ra(){if(!c('MercuryConfig').Mentions||!this._composer)return null;return this._composer.getInput().getMentions();},appendTextToInput:function ra(sa){this._composer&&this._composer.getInput().appendText(sa);},_hasUnfinishedPost:function ra(){return ja(this)||this.isUploading();},tryMarkAsRead:function ra(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){p.markRead(this._threadID);p.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function ra(sa){this.tryMarkAsRead();if(c('Parent').byTag(sa.getTarget(),'a')||c('DOM').getSelection())return;this.focus();},_inputContainerClicked:function ra(sa){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function ra(){this._pagesMessageIndicatorHandler=c('PagesMercuryChatTabIndicatorHandler').tryCreateHandler(this._threadID,this._onlineStatus,this._sheetController.openPageResponsivenessSheet.bind(this._sheetController),this._sheetController.closePageResponsivenessSheet.bind(this._sheetController));this._pagesMessageIndicatorHandler&&this._pagesMessageIndicatorHandler.checkResponsiveness();},_initializePagesGreeting:function ra(){var sa=c('DOMQuery').scry(this._tabElem,"._av1"),ta=this._threadID,ua=c('MercuryIDs').getUserIDFromThreadID(ta);if(!sa||sa.length===0||!ua)return;if(c('FBID').isUser(ua)){c('CSS').hide(sa[0]);return;}var va=c('React').createElement(c('BootloadedComponent.react'),{bootloadPlaceholder:c('React').createElement('div',null),bootloadLoader:c('JSResource')('MercuryChatTabPagesGreetingContainer.react').__setRef('ChatTabView'),threadID:ta});c('ReactDOM').render(va,sa[0]);},showTypingIndicator:function ra(sa){if(aa){this._setHeaderProps({isTyping:!!sa});return;}this._renderTypingIndicator();c('CSS').conditionClass(this._tabElem,"_54m8",sa);},_renderTypingIndicator:function ra(){var sa=c('CSS').hasClass(this._tabElem,'highlightTab')?'light':'dark';c('ReactDOM').render(c('React').createElement(c('MercuryTypingAnimation.react'),{color:sa}),this._getNode('animationContainer'));},_updateUnreadCount:function ra(sa){var ta=sa.unread_count;if(v&&v.currentViewerInFocusMode(sa.id))return;if(ta!=undefined){var ua=!!ta&&(!c('ChatBehavior').showsTabUnreadUI||c('ChatBehavior').showsTabUnreadUI()),va=this._getNode('numMessages');c('CSS').conditionShow(va,ua);c('CSS').conditionClass(this._tabElem,'highlightTab',ua);this._renderTypingIndicator();if(ua){c('ChatTabBlinking').blinkTab(this._threadID,this);}else c('ChatTabBlinking').unblinkTab(this._threadID);c('DOM').setContent(va,ta);}},ensureValidCanonicalGroup:function ra(sa){if(this._messagesView&&this._messagesView.getThreadID()===this._threadID)return;if(sa[this._messagesView.getThreadID()])this._propagateUpdatedThreadID(this._threadID);},_initializeSheetController:function ra(){this._sheetController=new (c('ChatTabSheetController'))(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onTokensChanged(function(sa,ta){this._handleSheetControllerTokensChanged(ta);}.bind(this));this._nubController=new (c('NubController'))().init(this._tabElem);this._sheetController.onResize(function(){this._nubController.flyoutContentChanged();}.bind(this));},_handleSheetControllerTokensChanged:function ra(sa){this._updateComposerParticipants(sa.tokens);s.getThreadMeta(this._threadID,function(ta){this._updateControls(ta,sa.token_count,sa.tokens);}.bind(this));this._updateMessagesViewIfNecessary(sa);},_updateMessagesViewIfNecessary:function ra(sa){if(!s.isEmptyLocalThread(this._threadID))return;var ta=c('MercuryCanonicalGroupThreadManager').get();ta.unsubscribe(this._canonicalGroupSearchSubscriptionID);if(sa.token_count===1){var ua=sa.tokens[0].info&&sa.tokens[0].info.uid;this._updateMercuryMessagesViewCanonical(c('MercuryIDs').getThreadIDFromUserID(ua));return;}this._updateMercuryMessagesViewCanonical(this._threadID);if(sa.token_count>1){var va=sa.tokens.map(function(wa){return wa.info.uid;});this._canonicalGroupSearchSubscriptionID=ta.getCanonicalGroupThreadIDForParticipants(Array.from(va),this._updateMercuryMessagesViewCanonical.bind(this));}},_updateMercuryMessagesViewCanonical:function ra(sa){if(sa){this._propagateUpdatedThreadID(sa);this._messagesView.trackBottomIfRequired();}},_updateComposerParticipants:function ra(sa){var ta=void 0;if(sa&&sa.length===1&&sa[0].info&&sa[0].info.uid)ta=[c('MercuryIDs').getParticipantIDFromUserID(sa[0].info.uid)];this._composer&&this._composer.setParticipantIDs(ta);},_initializeHeader:function ra(){if(aa){if(this._nubButton.nodeName.toLowerCase()==='a'){var sa=document.createElement('div');sa.className="fbNubButton";var ta=this._nubButton.parentNode;ta.insertBefore(sa,this._nubButton);ta.removeChild(this._nubButton);this._nubButton=sa;}this._header=new (c('ReactComponentRenderer'))(c('ChatTabHeaderContainer.react'),this._getNode('nubFlyoutTitlebar'));this._nubTitle=new (c('ReactComponentRenderer'))(c('ChatTabHeaderContainer.react'),this._nubButton);this._setHeaderProps({attachmentsShelf:this._getNode('fileAttachmentShelf'),isActive:false,nameConversationFunc:this.showNameConversation.bind(this),raised:this._isRaised,rtcNuxShown:false,sheetController:this._sheetController,showAddFriend:this._sheetController.openAddFriendsSheet.bind(this._sheetController),threadID:this._threadID,viewer:c('CurrentUser').getID(),onClick:this._isRaised?this._titleClicked.bind(this):this._nubClicked.bind(this),onCloseClick:this._closeClicked.bind(this),onCloseKeyUp:this._closeEnter.bind(this),onCloseMouseDown:this._closePreClicked.bind(this),onFileUploaderMounted:this.setFilesUploader.bind(this),onFileUploaderSubmit:this._focusInput.bind(this),onKeyDown:this._dockKeyDown.bind(this),onMount:this._headerPromiseResolve,onRTCNuxCloseButtonClick:this._dismissRTCNux.bind(this),onUpdateAttachmentsShelf:ka.bind(null,this),onUploadFinished:this._unblockSend.bind(this)});this._shouldShowRTCNux(function(ua){var va=ua.payload.shouldShow,wa=c('MercuryIDs').isGroupChat(this._threadID);this._rtcNuxShown=this._isLastTab&&wa&&va;this._header.setProps({rtcNuxShown:this._rtcNuxShown});}.bind(this));return;}this._initializeTitle();this._initializeCloseButton();this._initializeReactMenu();this._initializeAddToThreadButton();this._initializeRTC();this._initializeArchiveWarning();this._setCloseTooltip(false);},_setHeaderProps:function ra(sa){this._header&&this._header.setProps(sa);this._nubTitle&&this._nubTitle.setProps(sa);},_loadReactMenu:function ra(){if(aa)return new (c('Promise'))(function(va){this._headerPromise.done(function(wa){va(wa.getMenu());});}.bind(this));var sa=c('MercuryIDs').isGroupChat(this._threadID),ta=s.isNewEmptyLocalThread(this._threadID),ua=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(!this._menuPromise){this._initializeReactMenu();this._menuPromise=new (c('Promise'))(function(va){this._menuPromiseResolve=va;}.bind(this));}c('JSResource')('ChatTabMenu.react').__setRef('ChatTabView').load().done(function(va){this._reactChatTabMenu=new (c('ReactComponentRenderer'))(va,this._getNode('menuContainer'));this._reactChatTabMenu.setProps({sheetController:this._sheetController,onFileUploaderMounted:this.setFilesUploader.bind(this),nameConversationFunc:function(){return this.showNameConversation();}.bind(this),isGroupChat:sa,isEmptyChat:ta,showAddFriend:ua,threadID:this._threadID,otherUserID:this._getCanonicalUserID(),attachmentsShelf:this._getNode('fileAttachmentShelf'),onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:function(){return ka(this);}.bind(this),onSubmit:this._focusInput.bind(this)},function(){this._menuPromiseResolve&&this._menuPromiseResolve(this._reactChatTabMenu);}.bind(this));}.bind(this));return this._menuPromise;},_initializeReactMenu:function ra(){this._listen('menuButton','click',function(sa){sa.preventDefault();this._loadReactMenu().then(function(ta){ta.component.open();});}.bind(this));},_initializeArchiveWarning:function ra(){var sa=this._getNode('archiveContainer');if(!sa)return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ArchiveWarning.react"],function(ta){this._archiveWarning=new (c('ReactComponentRenderer'))(ta,sa);this._archiveWarning.setProps({isFBAtWork:c('WorkModeConfig').is_work_user,shown:false,useCSS:true});var ua=s.getThreadMetaNow(this._threadID);if(ua)this._updateArchiveWarning(ua);}.bind(this),'ChatTabView');}.bind(this));},_initializeAddToThreadButton:function ra(){if(aa)return null;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatAddToThreadButton.react"],function(sa){this._addToThreadButton=new (c('ReactComponentRenderer'))(sa,this._getNode('addToThreadContainer'));var ta=s.getThreadMetaNow(this._threadID);this._addToThreadButton.setProps({isFBAtWork:c('WorkModeConfig').is_work_user,onClick:this._addFriendLinkClicked.bind(this),shown:false,isMessengerRoom:c('MessengerAdminGroupUtils').isJoinableThread(ta)});if(ta)this._updateControls(ta);}.bind(this),'ChatTabView');}.bind(this));},_initializeRTC:function ra(){if(aa)return;var sa=c('MercuryIDs').isGroupChat(this._threadID);if(sa&&!c('ChatConfig').get('rtc_conferencing_www'))return;c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatVideoCallButton.react"],function(ta){var ua=c('CurrentUser').getID();if(!sa||c('ChatConfig').get('rtc_conferencing_www_video')){this._videoCallButton=new (c('ReactComponentRenderer'))(ta,this._getNode('videoCallButtonContainer'));this._videoCallButton.setProps({isAudio:false,isGroupChat:sa,onRTCNuxCloseButtonClick:function(){return this._dismissRTCNux();}.bind(this),rtcNuxShown:false,threadID:this._threadID,viewer:ua,shown:false});}this._voiceCallButton=new (c('ReactComponentRenderer'))(ta,this._getNode('voiceCallButtonContainer'));this._voiceCallButton.setProps({isAudio:true,isGroupChat:sa,onRTCNuxCloseButtonClick:function(){return this._dismissRTCNux();}.bind(this),rtcNuxShown:false,threadID:this._threadID,viewer:ua,shown:false});s.getThreadMeta(this._threadID,function(va){return this._updateControls(va);}.bind(this));this._shouldShowRTCNux(function(va){var wa=va.payload.shouldShow;this._rtcNuxShown=this._isLastTab&&sa&&wa;this._voiceCallButton&&this._voiceCallButton.setProps({rtcNuxShown:this._rtcNuxShown});}.bind(this));}.bind(this),'ChatTabView');}.bind(this));},_initializeCloseButton:function ra(){this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["ChatCloseButton.react"],function(sa){this._closeButton=new (c('ReactComponentRenderer'))(sa,this._getNode('titlebarCloseButtonContainer'));this._closeButton.setProps({active:this.isFocused(),className:"_3olu _3olv",onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)});}.bind(this),'ChatTabView');}.bind(this));},_initializeTitle:function ra(){var sa=s.getThreadMetaNow(this._threadID);this._title=new (c('ReactComponentRenderer'))(c('ChatTitleLink.react'),this._getNode('titleContainer'));this._title.setProps({thread:sa,viewer:c('CurrentUser').getID()});},_initializeTitleHREF:function ra(){c('getTitleHrefFromThreadID')(this._threadID,this._setTitleHref.bind(this));this._titlebarTooltipAnchor=this._getNode('titlebarText');},_dismissRTCNux:function ra(){if(this._rtcNuxShown){this._rtcNuxShown=false;this._voiceCallButton&&this._voiceCallButton.setProps({rtcNuxShown:false});this._header&&this._header.setProps({rtcNuxShown:false});var sa=c('XGroupCallNuxController').getURIBuilder().setString('action','dismiss').getURI();new (c('AsyncRequest'))(sa).send();}},_shouldShowRTCNux:function ra(sa){var ta=c('XGroupCallNuxController').getURIBuilder().setString('action','should_show').getURI();new (c('AsyncRequest'))(ta).setHandler(sa).send();},_updateAppointmentBanner:function ra(sa){var ta=this,ua=sa.thread_id,va=sa.other_user_fbid,wa=n.getCurrentlyLoadedMessages(ua);if(va&&!c('FBID').isUser(va)&&c('MercuryConfig').ShowAppointmentBanner){var xa=c('XNativeComponentFlowBookingRequestCountController').getURIBuilder().setFBID('page_id',va).setFBID('user_id',c('CurrentUser').getID()).getURI();new (c('AsyncRequest'))().setURI(xa).setHandler(function(ya){var za=ya&&ya.getPayload();if(!this._hasBookingRequest(za))return;this._sheetController.openAppointmentBannerSheet(va,c('CurrentUser').getID(),100,wa,function(){ta._nubController.flyoutContentChanged();});}.bind(this)).setErrorHandler(function(){this._sheetController.closeAppointmentBannerSheet();}.bind(this)).send();}else this._sheetController.closeAppointmentBannerSheet();},_hasBookingRequest:function ra(sa){if(!sa)return false;return sa.confirmed+sa.pending>0;},_initializeDockUIListeners:function ra(){if(aa)return;this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','mouseenter',this._nubHovered);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('closeButton','click',this._closeClicked);},_initializeUIListeners:function ra(){this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('nubFlyoutTitlebar','mouseenter',this._titleHovered);this._listen('chatConv','click',this._chatConvClicked);if(this._getNode('inputContainer'))this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===c('Keys').TAB){this._focusInput();event.kill();}if(event.keyCode===c('Keys').ESC)this._handleEscape();}.bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFilesUploader:function ra(sa){this._filesUploader=sa;},_initializeDragDropTarget:function ra(){if(c('WorkFileUploadsGating').canUploadFiles){var sa=c('DOMQuery').scry(this._tabElem,"._1ia");if(sa&&sa.length>0){this._dropTarget=new (c('DragDropTarget'))(sa[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}}},_initializeP2PChatThreadBannerContainer:function ra(){var sa=c('DOMQuery').scry(this._tabElem,"._2hc2");if(sa&&sa.length>0){this._p2pChatThreadBannerContainerEl=sa[0];c('Run').onAfterLoad(function(){c('Bootloader').loadModules(["P2PChatThreadBannerContainer.react"],function(ta){this._p2pChatThreadBannerContainer=new (c('ReactComponentRenderer'))(ta,this._p2pChatThreadBannerContainerEl);this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable(),otherUserID:c('MercuryIDs').getUserIDFromThreadID(this._threadID),threadID:this._threadID});}.bind(this),'ChatTabView');}.bind(this));}},setP2PChatThreadBannerContainerVisibility:function ra(){if(this._p2pChatThreadBannerContainer)this._p2pChatThreadBannerContainer.setProps({isVisible:this.isChatViewable()});},isChatViewable:function ra(){return !!(this._tabElem&&this._isVisible&&this._isRaised);},_initializeUnloadListeners:function ra(){this._checkUnsentMessages=c('createCancelableFunction')(function(){if(this._hasUnfinishedPost())return j._("You haven't sent your message yet. Do you want to leave without sending?");if(n.getNumberLocalMessages(this._threadID))return j._("Your message is still being sent. Are you sure you want to leave?");return null;}.bind(this));c('Run').onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=c('createCancelableFunction')(na.bind(null,this));c('Run').onUnload(this._logUnsentPhotos);},_handleUploadSubmit:function ra(sa){la(this,c('PhotosUploadWaterfall').UPLOAD_START,sa);ga(this,'',[],function(ta){if(this._threadID!==ta.thread_id){this._newThreadIDFromPhotoUpload=ta.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(ta.thread_id);}ta.content_attachment=null;t.addAttachmentPlaceholder(ta,sa.upload_id,sa);}.bind(this));pa('submit',sa);this._focusInput();},_handleFileLastUploadFailed:function ra(sa){la(this,c('PhotosUploadWaterfall').CLIENT_ERROR,sa);pa('failed',sa);},_handlePULastUploadFailed:function ra(sa){la(this,c('PhotosUploadWaterfall').CLIENT_ERROR,sa);pa('failed',sa);},_handlePULastUploadCanceled:function ra(sa){la(this,c('PhotosUploadWaterfall').CANCEL_DURING_UPLOAD,sa);pa('canceled',sa);},_handlePUAllUploadsCompleted:function ra(sa){la(this,c('PhotosUploadWaterfall').ALL_UPLOADS_DONE,sa);pa('completed',sa);var ta=sa.image_ids.length||sa.attachments.length;fa(this,ta);},_stickerSelected:function ra(sa){ga(this,'',[],function(ta){ta.has_attachment=true;ta.sticker_id=sa;t.send(ta);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_customLikeSelected:function ra(sa,ta,ua){this.is_emoji_like=true;ga(this,sa.emoji,[],function(va){va.has_attachment=false;t.send(function(){c('EmojiLikeUtils').setEmojiSize(va,ta);return c('EmojiLikeUtils').setEmojiSource(va,ua);}());this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_p2pTriggered:function ra(){ga(this,'',[],function(sa){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_setTitleHref:function ra(sa){this._title&&this._title.setProps({href:sa});},_unblockSend:function ra(){if(!this._blocked||ia(this))return;this._blocked=false;ea(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function ra(){new (c('AsyncSignal'))('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();},_setCustomColor:function ra(sa,ta){if(!sa)return;if(ta){c('Style').apply(sa,{color:ta});}else if(sa.style)sa.style.color='';c('CSS').conditionClass(sa,"_1m34",!!ta);},_isPageChat:function ra(){if(this._threadID){var sa=c('MercuryIDs').tokenize(this._threadID);if(sa.type==='user')return !c('FBID').isUser(sa.value);}return false;},_getPageID:function ra(){if(this._threadID){var sa=c('MercuryIDs').tokenize(this._threadID);if(sa.type==='user'&&!c('FBID').isUser(sa.value))return sa.value;}return null;},getCustomColor:function ra(){return this._customColor;},updateTitlebar:function ra(sa){if(!sa)return;this._customColor=c('convertMIGColorToFIGColor')(sa.custom_color);if(this._titlebar&&!sa.ephemeral_ttl_mode)this._setCustomColor(this._titlebar,this._customColor);if(this._title)this._title.setProps({thread:sa},function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.component.getTitle());}.bind(this));if(!aa)c('ReactDOM').render(c('React').createElement(c('MercuryThreadTitle.react'),{isNewThread:s.isNewEmptyLocalThread(this._threadID),thread:sa,useAndSeparator:true,useShortName:!sa.is_canonical,viewer:c('CurrentUser').getID()}),this._getNode('name'));this.updateTitlebarTooltip();}});function pa(ra,sa){ba.debug('photo_uploader:'+ra,'{}');}function qa(ra,sa){if(!sa)return ra;var ta=sa.getImageFiles();if(ta.length>0){ra.image_ids=ta;ra.has_attachment=true;}var ua=sa.getAnimatedImageFiles();if(ua.length>0){ra.gif_ids=ua;ra.has_attachment=true;}var va=sa.getVideoFiles();if(va.length>0){ra.video_ids=va;ra.has_attachment=true;}var wa=sa.getAudioFiles();if(wa.length>0){ra.audio_ids=wa;ra.has_attachment=true;}var xa=sa.getFiles();if(xa.length>0){ra.file_ids=xa;ra.has_attachment=true;}return ra;}f.exports=ma;}),null);
__d('ChatUserFocusWarning',['MercuryParticipants','MercuryViewer','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';var h=void 0,i=void 0,j=function m(n){if(!h)c('ifRequired')('ChatUserFocusLogging',function(o){return h=o;},c('emptyFunction'));if(h&&h.registerThreadID)h.registerThreadID(n);},k=function m(n,o,p){if(!i)c('ifRequired')('ChatSubscribeToFocusModeChanges',function(q){i=q;},c('emptyFunction'));if(i&&i.subscribe)i.subscribe(n,o,p);},l={updateUserFocusWarning:function m(n,o,p){c('MercuryParticipants').get(c('MercuryViewer').getID(),function(q){var r=q.employee;if(r)c('MercuryParticipants').getMulti(n.participants,function(s){var t=false;for(var u in s){if(q.id!==s[u].id&&s[u].is_user_focusing)t=true;if(s[u].employee&&q.fbid)k(q.fbid,n.thread_id,s[u]);}if(t){j(n.thread_id);var v=n&&n.bypass_focus_mode_until&&n.bypass_focus_mode_until>Date.now()/1000;o(v);}else p();});});}};f.exports=l;}),null);
__d('FantaGetMessageActions',['FantaDispatcher','MercuryCanonicalGroupThreadManager','MercuryIDs','MercuryTypeaheadConstants','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ADD_PARTICIPANTS:null,CLEAR_PARTICIPANTS:null,FETCH_MORE_MESSAGES:null,ON_BOOTLOAD_TYPEAHEAD:null,ON_GET_THREAD_PREVIEW_RESPONSE:null,ON_GET_THREAD_RESPONSE:null,ON_MESSAGE_STORE_RESPONSE:null,ON_PAGE_NULL_RESPONSE:null,ON_PRIVACY_STATE_CHANGE:null,ON_SHOW_CONTEXT_BANNER_TIMER:null,REFRESH_THREAD:null,THREADS_UPDATED:null}),i={Types:h,addParticipants:function j(k,l){var m,n=l.length===1&&l[0].getInfo().render_type===c('MercuryTypeaheadConstants').THREAD_TYPE,o=void 0;if(n){var p=l[0].getInfo().mercury_thread;if(p)o=c('MercuryIDs').getThreadIDFromThreadFBID(p.thread_fbid);}else if(l.length===1){var q=l[0].info&&l[0].info.uid;if(q)o=c('MercuryIDs').getThreadIDFromUserID(q);}else if(l.length===0){c('FantaDispatcher').dispatch({type:h.CLEAR_PARTICIPANTS,tabID:k});return;}else (function(){var r=c('MercuryCanonicalGroupThreadManager').get(),s=l.map(function(u){return u.info.uid;}),t=r.getCanonicalGroupThreadIDForParticipants(Array.from(s),function(u){r.unsubscribe(t);if(u)c('FantaDispatcher').dispatch({type:h.ADD_PARTICIPANTS,previewTabID:u,tabID:k,tokens:l});});})();if(o)c('FantaDispatcher').dispatch({type:h.ADD_PARTICIPANTS,previewTabID:o,tabID:k,tokens:l});},onBootloadTypeahead:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_BOOTLOAD_TYPEAHEAD,tabID:k,thread:l});},fetchMoreMessages:function j(k){c('FantaDispatcher').dispatch({type:h.FETCH_MORE_MESSAGES,threadID:k});},refreshThread:function j(k){c('FantaDispatcher').dispatch({type:h.REFRESH_THREAD,threadID:k});},onGetThreadResponse:function j(k){c('FantaDispatcher').dispatch({type:h.ON_GET_THREAD_RESPONSE,thread:k});},onGetThreadPreviewResponse:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_GET_THREAD_PREVIEW_RESPONSE,tabID:k,thread:l});},onShowContextBannerTimer:function j(k){c('FantaDispatcher').dispatch({type:h.ON_SHOW_CONTEXT_BANNER_TIMER,threadID:k});},onMessageStoreResponse:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_MESSAGE_STORE_RESPONSE,messages:k,tabID:l});},threadsUpdated:function j(k){c('FantaDispatcher').dispatch({type:h.THREADS_UPDATED,threads:k});},onPrivacyStateChange:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_PRIVACY_STATE_CHANGE,threadID:k,privacyState:l});},onPageNullResponse:function j(k,l,m){c('FantaDispatcher').dispatch({type:h.ON_PAGE_NULL_RESPONSE,threadID:k,nullPageTitle:l,nullPageID:m});}};f.exports=i;}),null);
__d('FantaTypeFileUploaderFile',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={file:{},id:'',startTime:0,type:null,uploadedID:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeFileUploader',['FantaTypeFileUploaderFile','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={ANIMATED_IMAGE:'animated_image',AUDIO:'audio',FILE:'file',GENERIC_ATTACHMENT:'generic_attachment',IMAGE:'image',VIDEO:'video'},k={uploadedFiles:c('immutable').Map(),uploadingFiles:c('immutable').Map()};h=babelHelpers.inherits(l,c('immutable').Record(k));i=h&&h.prototype;l.prototype.getTypeIDs=function(m){return this.uploadedFiles.reduce(function(n,o){if(o.type===m&&o.uploadedID)n=n.concat(o.uploadedID);return n;},[]);};function l(){h.apply(this,arguments);}l.fileTypes=j;f.exports=l;}),null);
__d('FantaTypeSharePreview',['immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={isLoading:false,params:null,type:null,uri:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeTabContents',['ChatPrivacyActionController','FantaGetMessageActions','FantaTypeFileUploader','FantaTypeSharePreview','immutable','MercuryConfig','MercuryIDs','MercuryMessageStore','emptyFunction','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={composerText:'',fileUploader:new (c('FantaTypeFileUploader'))(),hasFetchedAll:false,id:'',isScrolledToBottom:true,messages:c('immutable').List(),messageStore:null,nullPageID:null,nullPageTitle:null,openSheet:null,pageIndicator:null,pageIndicatorDescription:null,privacyController:null,sharePreview:new (c('FantaTypeSharePreview'))(),showContextBanner:false,showUnseenMessages:c('emptyFunction'),signatureID:null,thread:null,threadPreviewID:null,timezoneInfo:null,typeahead:null};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(l){var m=void 0;if(c('MercuryConfig').FantaTabView){var n=c('MercuryIDs').getUserIDFromThreadID(l.id);if(n)m=new (c('ChatPrivacyActionController'))(n,function(o){c('setImmediate')(function(){c('FantaGetMessageActions').onPrivacyStateChange(l.id,o);});});}i.constructor.call(this,babelHelpers['extends']({privacyController:m},l));}f.exports=k;}),null);
__d('FantaTypeMercuryState',['FantaTypeTabContents','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={blurCallbacks:c('immutable').Map({}),focusCallbacks:c('immutable').Map({}),tabContents:c('immutable').Map({})};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTypeAppState',['FantaTypeMercuryState','FantaTypeTabGroup','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i,j={tabGroup:new (c('FantaTypeTabGroup'))(),mercury:new (c('FantaTypeMercuryState'))()};h=babelHelpers.inherits(k,c('immutable').Record(j));i=h&&h.prototype;function k(){h.apply(this,arguments);}f.exports=k;}),null);
__d('FantaReducersCookie',['FantaMessageActions','FantaTabActions','FantaTypeAppState'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types;function j(m,n){switch(n.type){case h.RECEIVED_NEW_MESSAGE:case i.BLUR_TAB:case i.CLOSE_ALL_TABS:case i.CLOSE_AND_TAB_NEXT:case i.CLOSE_TAB:case i.FOCUS_TAB:case i.MINIMIZE_ALL_TABS:case i.MINIMIZE_TAB:case i.OPEN_TAB:case i.REPLACE_TAB:case i.UNMINIMIZE_TAB:return l(m);}return m;}function k(m,n){switch(n.type){case i.LOAD_FROM_DATA:return m.mergeIn(['tabGroup'],{updatedTime:n.tabData.updatedTime});}return m;}function l(m){return m.mergeIn(['tabGroup'],{updatedTime:Date.now()});}f.exports={updateCookie:j,loadFromData:k};}),null);
__d('FantaReducersDockCalculator',['Arbiter','FantaTabActions','FantaMessageActions','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaTabActions').Types,i=c('FantaMessageActions').Types,j=null;function k(n){j=n;c('setImmediate')(function(){c('Arbiter').inform('FantaReducersDockCalculator/shouldRecalculate');});}function l(n){if(!j||n.size!==j.size){k(n);}else{var o=false;n.forEach(function(p){var q=j&&j.get(p.id);if(!q||p.isMinimized!==q.isMinimized)o=true;});if(o)k(n);}}function m(n,o){var p=n.tabGroup.tabs;switch(o.type){case h.CLOSE_ALL_TABS:case h.CLOSE_AND_TAB_NEXT:case h.CLOSE_TAB:case h.MINIMIZE_ALL_TABS:case h.MINIMIZE_TAB:case h.OPEN_TAB:case h.UNMINIMIZE_TAB:k(p);break;case h.LOAD_FROM_DATA:case i.RECEIVED_NEW_MESSAGE:l(p);break;}return n;}f.exports={recalculateDock:m};}),null);
__d('FantaTabSheetActions',['FantaDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CLOSE_ADD_FRIENDS_SHEET:null,CLOSE_ADD_MORE_FRIENDS_SHEET:null,CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:null,CLOSE_EMPLOYEE_WORK_USER_SHEET:null,CLOSE_NAME_CONVERSATION_TAB_SHEET:null,CLOSE_PAGE_INDICATOR_SHEET:null,CLOSE_READ_ONLY_PERMANENT_SHEET:null,CLOSE_READ_ONLY_SHEET:null,CLOSE_USER_FOCUS_AND_BYPASS_SHEET:null,CLOSE_USER_TIMEZONE_SHEET:null,ON_BOOTLOAD_EVENT_REMINDER:null,ON_IS_PAGE_TAB:null,OPEN_ADD_MORE_FRIENDS_SHEET:null,OPEN_APPOINTMENT_SHEET:null,OPEN_BYPASS_FOCUS_SHEET:null,OPEN_EMPLOYEE_AWAY_SHEET:null,OPEN_EMPLOYEE_PERSONAL_USER_SHEET:null,OPEN_EMPLOYEE_WORK_USER_SHEET:null,OPEN_NAME_CONVERSATION_TAB_SHEET:null,OPEN_PAGE_INDICATOR_SHEET:null,OPEN_READ_ONLY_PERMANENT_SHEET:null,OPEN_READ_ONLY_SHEET:null,OPEN_USER_FOCUS_SHEET:null,OPEN_USER_TIMEZONE_SHEET:null}),i={Types:h,openUserFocusSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_USER_FOCUS_SHEET,tabID:k});},openBypassFocusSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_BYPASS_FOCUS_SHEET,tabID:k});},closeUserFocusAndBypassSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_USER_FOCUS_AND_BYPASS_SHEET,tabID:k});},openUserTimezoneSheet:function j(k,l){c('FantaDispatcher').dispatch({type:h.OPEN_USER_TIMEZONE_SHEET,tabID:k,timezoneInfo:l});},closeUserTimezoneSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_USER_TIMEZONE_SHEET,tabID:k});},openAddMoreFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_ADD_MORE_FRIENDS_SHEET,tabID:k});},closeAddMoreFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_ADD_MORE_FRIENDS_SHEET,tabID:k});},closeAddFriendsSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_ADD_FRIENDS_SHEET,tabID:k});},openNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_NAME_CONVERSATION_TAB_SHEET,tabID:k});},closeNameConversationSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_NAME_CONVERSATION_TAB_SHEET,tabID:k});},openReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_SHEET,tabID:k});},closeReadOnlySheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_SHEET,tabID:k});},openReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_READ_ONLY_PERMANENT_SHEET,tabID:k});},closeReadOnlyPermanentSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_READ_ONLY_PERMANENT_SHEET,tabID:k});},openEmployeeAwaySheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_AWAY_SHEET,tabID:k});},openEmployeePersonalUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_PERSONAL_USER_SHEET,tabID:k});},closeEmployeePersonalUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET,tabID:k});},openEmployeeWorkUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_EMPLOYEE_WORK_USER_SHEET,tabID:k});},closeEmployeeWorkUserSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_EMPLOYEE_WORK_USER_SHEET,tabID:k});},openPageIndicatorSheet:function j(k,l){c('FantaDispatcher').dispatch({type:h.OPEN_PAGE_INDICATOR_SHEET,description:l,tabID:k});},closePageIndicatorSheet:function j(k){c('FantaDispatcher').dispatch({type:h.CLOSE_PAGE_INDICATOR_SHEET,tabID:k});},onIsPageTab:function j(k,l){c('FantaDispatcher').dispatch({type:h.ON_IS_PAGE_TAB,pageIndicator:l,tabID:k});},onBootloadEventReminder:function j(k){c('FantaDispatcher').dispatch({type:h.ON_BOOTLOAD_EVENT_REMINDER,tabID:k});},openAppointmentBannerSheet:function j(k){c('FantaDispatcher').dispatch({type:h.OPEN_APPOINTMENT_SHEET,tabID:k});}};f.exports=i;}),null);
__d('WorkFocusMode',['WorkModeConfig','WorkUserAvailabilityStatusType','emptyFunction','ifRequired'],(function a(b,c,d,e,f,g){'use strict';var h={},i={status:'AVAILABLE',end_date:0};if(c('WorkModeConfig').availability){i.status=c('WorkModeConfig').availability.status;i.end_date=c('WorkModeConfig').availability.end_date;}f.exports={updateAvailability:function j(k,l){k=Object.keys(c('WorkUserAvailabilityStatusType')).find(function(m){return c('WorkUserAvailabilityStatusType')[m]===k;});i.status=k;i.end_date=l;},currentViewerInFocusMode:function j(k){if(!c('WorkModeConfig').focus_messaging_enabled)return false;if(k){if(h[k])return false;var l=null;c('ifRequired')('MercuryThreads',function(n){l=n.get().getThreadMetaNow(k);},c('emptyFunction'));if(l&&l.bypass_focus_mode_until&&l.bypass_focus_mode_until>Date.now()/1000)return false;}var m=c('WorkUserAvailabilityStatusType')[i.status];if(m===c('WorkUserAvailabilityStatusType').FOCUS&&i.end_date*1000>Date.now())return true;return false;},addBypassFocusModeForThread:function j(k){h[k]=true;},removeBypassFocusModeForThread:function j(k){h[k]=false;}};}),null);
__d('FantaReducersMercury',['Arbiter','AvailableList','AvailableListConstants','Bootloader','FantaGetMessageActions','FantaMessageActions','FantaTabActions','FantaTabSheetActions','FantaTypeAppState','FantaTypeTabContents','JSLogger','MercuryConfig','MercuryIDs','MercuryThreadIDMap','WorkFocusMode','getPageIDFromThreadID','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryThreadIDMap').get(),i=c('JSLogger').create('FantaReducersMercury'),j=c('FantaMessageActions').Types,k=c('FantaTabActions').Types,l=c('FantaGetMessageActions').Types;function m(){return Math.floor(Math.random()*2147483648).toString(16);}function n(ka,la){switch(la.type){case k.OPEN_TAB:var ma=la.tabID;if(c('MercuryConfig').FantaTabView){c('ifRequired')('FantaTabsReactApp',function(oa){if(!c('MercuryIDs').isValidThreadID(ma)){ka=ka.deleteIn(['tabGroup','tabs',ma]);w(ma);}else{ga(ma);ha(ma);}},function(){return ka=o(ka,la.tabID);});}else c('ifRequired')('FantaTabsApp',function(oa){if(!c('MercuryIDs').isValidThreadID(ma)){ka=ka.deleteIn(['tabGroup','tabs',ma]);w(ma);}else{ga(ma);ha(ma);}},function(){return ka=o(ka,la.tabID);});ka=r(ka,ma);var na=m();ka=ka.mergeIn(['mercury','tabContents',ma],{signatureID:na});ka=q(ka,ma);c('Arbiter').inform('jewel/hide');return ka;}return ka;}function o(ka,la){c('ifRequired')('FantaTabsSlimApp',function(ma){if(!c('MercuryIDs').isValidThreadID(la)){ka=ka.deleteIn(['tabGroup','tabs',la]);w(la);}else{ga(la);ha(la);}},function(){ga(la);ha(la);});return ka;}function p(ka,la){switch(la.type){case j.RECEIVED_NEW_MESSAGE:ka=r(ka,la.tabID);}return ka;}function q(ka,la){var ma=ka.mercury.get('focusCallbacks'),na=ka.tabGroup.tabs.get(la);if(ma&&!!ma.get(la)&&!na.focusOnMountDEPRECATED)ka=z(ka,la);return ka;}function r(ka,la){var ma,na=ka.mercury.tabContents.get(la);if(!na)return ka.setIn(['mercury','tabContents',la],new (c('FantaTypeTabContents'))({id:la}));if(c('MercuryConfig').FantaTabView)(function(){var oa=c('getPageIDFromThreadID')(la);if(oa)c('Bootloader').loadModules(["PagesMercuryChatTabIndicatorHandler"],function(pa){var qa=new pa(oa,c('AvailableListConstants').NORMAL,function(ra){c('setImmediate')(function(){c('FantaTabSheetActions').openPageIndicatorSheet(la,ra);});},function(){return c('FantaTabSheetActions').closePageIndicatorSheet(la);});c('setImmediate')(function(){c('FantaTabSheetActions').onIsPageTab(la,qa);});},'FantaReducersMercury');})();return ka;}function s(ka,la){switch(la.type){case k.REPLACE_TAB:ka=v(ka,la.newTabID);ka=r(ka,la.newTabID);return ka;}return ka;}function t(ka,la){switch(la.type){case l.ADD_PARTICIPANTS:var ma=la.tabID,na=la.previewTabID;if(!ka.mercury.tabContents.get(ma))return ka;ka=ka.mergeIn(['mercury','tabContents',ma],{threadPreviewID:na});return ka;}return ka;}function u(ka,la){switch(la.type){case l.CLEAR_PARTICIPANTS:var ma=la.tabID;ka=ka.setIn(['mercury','tabContents',ma],new (c('FantaTypeTabContents'))({id:ma}));}return ka;}function v(ka,la){c('ifRequired')('FantaTabsApp',function(ma){if(!c('MercuryIDs').isValidThreadID(la)){ka=ka.deleteIn(['tabGroup','tabs',la]);w(la);}},function(){c('ifRequired')('FantaTabsSlimApp',function(ma){if(!c('MercuryIDs').isValidThreadID(la)){ka=ka.deleteIn(['tabGroup','tabs',la]);w(la);}});});return ka;}function w(ka){h.getClientIDFromServerID(ka,function(la){return c('setImmediate')(function(){if(c('MercuryIDs').isValidThreadID(la)){c('FantaTabActions').openTab(la);}else i.error('invalid id',ka);});});}function x(ka,la){switch(la.type){case k.MERCURY_REGISTER_TAB_FOCUS_DEPRECATED:ka=aa(ka,la);ka=ba(ka,la);var ma=ka.tabGroup.tabs.get(la.tabID);if(ma&&ma.focusOnMountDEPRECATED)return z(ka,la.tabID);}return ka;}function y(ka,la){switch(la.type){case k.FOCUS_TAB:ga(la.tabID);var ma=ka.tabGroup.tabs.get(la.tabID);if(ma&&!ma.focusOnMountDEPRECATED)return z(ka,la.tabID);}return ka;}function z(ka,la){var ma=ka.mercury.get('focusCallbacks'),na=ka.mercury.get('blurCallbacks'),oa=ma.get(la);for(var pa=na.values(),qa=Array.isArray(pa),ra=0,pa=qa?pa:pa[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var sa;if(qa){if(ra>=pa.length)break;sa=pa[ra++];}else{ra=pa.next();if(ra.done)break;sa=ra.value;}var ta=sa;ta();}if(oa)oa();ka=ka.mergeIn(['tabGroup','tabs',la],{focusOnMountDEPRECATED:false});return ka;}function aa(ka,la){var ma=la.tabID,na=la.focusCallback;return ka.setIn(['mercury','focusCallbacks',ma],na);}function ba(ka,la){var ma=la.tabID,na=la.blurCallback;return ka.setIn(['mercury','blurCallbacks',ma],na);}function ca(ka,la){switch(la.type){case k.CLOSE_TAB:var ma=la.tabID;c('ifRequired')('MessengerVideoAutoplayActions',function(na){na.deleteThread(ma);});c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ma);return ka.deleteIn(['mercury','focusCallbacks',ma]).deleteIn(['mercury','blurCallbacks',ma]);}return ka;}function da(ka,la){switch(la.type){case k.CLOSE_ALL_TABS:var ma=ka.mercury.get('focusCallbacks'),na=ka.mercury.get('blurCallbacks');c('ifRequired')('MessengerVideoAutoplayActions',function(oa){oa.deleteAllThreads();});return ka.setIn(['mercury','focusCallbacks'],ma.clear()).setIn(['mercury','blurCallbacks'],na.clear());}return ka;}function ea(ka,la){switch(la.type){case k.FOCUS_NEXT_TAB:case k.FOCUS_PREVIOUS_TAB:case k.CLOSE_AND_TAB_NEXT:var ma=ka.tabGroup.focusedTabID;if(ma){z(ka,ma);ga(ma);}}return ka;}function fa(ka,la){switch(la.type){case k.CLOSE_AND_TAB_NEXT:var ma=la.tabID;c('WorkFocusMode')&&c('WorkFocusMode').removeBypassFocusModeForThread(ma);}return ka;}function ga(ka){var la=c('MercuryIDs').getUserIDFromThreadID(ka);if(la)c('AvailableList').updateForID(la);}function ha(ka){if(!c('MercuryIDs').isValidThreadID(ka))return;c('Bootloader').loadModules(["GroupChatMessageBlockAlert","MercuryBlockedParticipants","MercuryThreadActions","MercuryThreads"],function(la,ma,na,oa){var pa=na.get(),qa=oa.get(),ra=ma.get();qa.getThreadMeta(ka,function(sa){if(ra.isPresentInGroupThread(sa))la.show(ra.inGroupThread(sa),function(){c('FantaTabActions').focusTab(ka);},function(){c('FantaTabActions').closeTab(ka);pa.leaveGroup(ka);});});},'FantaReducersMercury');}function ia(ka,la){switch(la.type){case k.UNMINIMIZE_TAB:ga(la.tabID);}return ka;}function ja(ka,la){switch(la.type){case k.LOAD_FROM_DATA:for(var ma=ka.tabGroup.tabs.keys(),na=Array.isArray(ma),oa=0,ma=na?ma:ma[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var pa;if(na){if(oa>=ma.length)break;pa=ma[oa++];}else{oa=ma.next();if(oa.done)break;pa=oa.value;}var qa=pa;ka=r(ka,qa);}}return ka;}f.exports={addParticipants:t,clearParticipants:u,closeAllTabs:da,closeAndTabNext:fa,closeTab:ca,focusTab:y,focusTabEvents:ea,loadFromData:ja,openTab:n,receivedNewMessage:p,registerTabFocusDeprecated:x,replaceTab:s,unminimizeTab:ia};}),null);
__d('FantaReducersMessages',['FantaMessageActions','FantaTabActions','FantaTypeAppState','MercuryBrowserAlerts'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types;function j(p,q){switch(q.type){case h.RECEIVED_NEW_MESSAGE:var r=q.message;c('MercuryBrowserAlerts').messageReceived(r);return p;}return p;}function k(p,q){switch(q.type){case h.COMPOSER_TEXT_UPDATE:var r=q.message,s=q.threadID;if(!p.mercury.tabContents.get(s))return p;return p.mergeIn(['mercury','tabContents',s],{composerText:r});}return p;}function l(p,q){switch(q.type){case i.CLOSE_TAB:if(!p.mercury.tabContents.get(q.tabID))return p;return p.mergeIn(['mercury','tabContents',q.tabID],{composerText:''});}return p;}function m(p,q){switch(q.type){case i.CLOSE_ALL_TABS:var r=p.mercury.tabContents;r.forEach(function(s){var t=s.id;p=p.setIn(['mercury','tabContents',t],s.set('composerText',''));});return p;}return p;}function n(p,q){switch(q.type){case i.SCROLL_BOTTOM_CHANGED:var r=q.tabID,s=q.isScrolledToBottom,t=q.showUnseenMessages;if(!p.mercury.tabContents.get(r))return p;p=p.mergeIn(['mercury','tabContents',r],{isScrolledToBottom:s,showUnseenMessages:t});}return p;}function o(p,q){switch(q.type){case i.SHOW_UNSEEN_MESSAGES:var r=q.tabID,s=p.mercury.tabContents.get(r);if(s)s.showUnseenMessages();}return p;}f.exports={closeAllTabs:m,closeTab:l,composerTextUpdate:k,receivedNewMessage:j,scrollBottomChanged:n,showUnseenMessages:o};}),null);
__d('FantaReducersTabSheets',['AsyncRequest','Bootloader','ChatEmployeeAwayWarning','ChatPrivacyActionController','ChatTimezoneWarning','ChatUserFocusWarning','ChatUserPersonalUserWarning','ChatUserWorkUserWarning','CurrentUser','FantaGetMessageActions','FantaMessageActions','FantaTabActions','FantaTabSheetActions','FantaTypeAppState','FBID','ImmutableObject','MercuryBlockedParticipants','MercuryConfig','MercuryDataSourceWrapper','MercuryIDs','MercuryParticipants','MercurySheetPolicy','MercuryThreadInfo','MercuryThreads','MercuryTypeaheadConstants','MercuryViewer','XNativeComponentFlowBookingRequestCountController','emptyFunction','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('MercuryBlockedParticipants').get(),i=c('MercuryThreads').get(),j=c('FantaTabActions').Types,k=c('FantaGetMessageActions').Types,l=c('FantaMessageActions').Types,m=c('FantaTabSheetActions').Types;function n(ub,vb){switch(vb.type){case j.CLOSE_TAB:case j.CLOSE_AND_TAB_NEXT:var wb=vb.tabID;if(!ub.mercury.tabContents.get(wb))return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{typeahead:null});return o(ub,wb);}return ub;}function o(ub,vb,wb){var xb=ub.mercury.tabContents.get(vb);if(!xb)return ub;if(wb&&xb.openSheet!==wb)return ub;ub=ub.mergeIn(['mercury','tabContents',vb],{openSheet:null});if(xb.thread)ub=mb(ub,vb,xb.thread);return ub;}function p(ub,vb){switch(vb.type){case j.CLOSE_ALL_TABS:for(var wb=ub.mercury.tabContents.keys(),xb=Array.isArray(wb),yb=0,wb=xb?wb:wb[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var zb;if(xb){if(yb>=wb.length)break;zb=wb[yb++];}else{yb=wb.next();if(yb.done)break;zb=yb.value;}var ac=zb;ub=ub.mergeIn(['mercury','tabContents',ac],{typeahead:null});ub=o(ub,ac);}}return ub;}function q(ub,vb){switch(vb.type){case k.ON_GET_THREAD_RESPONSE:case k.ON_GET_THREAD_PREVIEW_RESPONSE:var wb=vb.thread,xb=vb.tabID||wb.thread_id;ub=r(ub,wb,xb);}return ub;}function r(ub,vb,wb){var xb=c('MercuryViewer').getID(),yb=vb.participants.filter(function(zb){return zb!==xb;});if(yb.length<1&&!i.isNewEmptyLocalThread(wb)){ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);}else ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);if(vb.participants.length===0){ub=x(ub,wb,vb);ub=z(ub,wb,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet);}else ub=mb(ub,wb,vb);return ub;}function s(ub,vb){switch(vb.type){case k.THREADS_UPDATED:vb.threads.forEach(function(wb){ub=r(ub,new (c('ImmutableObject'))(wb),wb.thread_id);});}return ub;}function t(ub,vb){switch(vb.type){case j.OPEN_TAB:case j.REPLACE_TAB:var wb=vb.tabID,xb=ub.mercury.tabContents.get(wb).thread;if(xb)ub=mb(ub,wb,xb);}return ub;}function u(ub,vb,wb){if(c('MercuryThreadInfo').isMuted(wb)){return z(ub,vb,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}else return o(ub,vb,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}function v(ub,vb,wb){if(h.isMessageBlocked(wb)){return z(ub,vb,c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}else return o(ub,vb,c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}function w(ub,vb){switch(vb.type){case k.ON_BOOTLOAD_TYPEAHEAD:var wb=vb.thread,xb=wb.thread_id;ub=x(ub,xb,wb);}return ub;}function x(ub,vb,wb){if(ub.mercury.tabContents.get(vb).typeahead)return ub;c('ifRequired')('ChatTabTypeaheadRenderer',function(xb){c('ifRequired')('ContextualTypeaheadView',function(yb){c('ifRequired')('MercuryTypeahead',function(zb){if(!ub.mercury.tabContents.get(vb))return;var ac=!!(wb&&wb.participants&&wb.participants.length===0),bc=ac?c('MercuryDataSourceWrapper').chat_typeahead_source:c('MercuryDataSourceWrapper').chat_add_people_source;bc.setShowThreads(ac);var cc=new zb(bc,yb);cc.setViewOption('renderer',xb);cc.setExcludedParticipantsFromThreadMeta(wb);ub=ub.mergeIn(['mercury','tabContents',vb],{typeahead:cc});},function(){return y(vb,wb);});},function(){return y(vb,wb);});},function(){return y(vb,wb);});return ub;}function y(ub,vb){c('Bootloader').loadModules(["ChatTabTypeaheadRenderer","ContextualTypeaheadView","MercuryTypeahead"],function(wb,xb,yb){c('FantaGetMessageActions').onBootloadTypeahead(ub,vb);},'FantaReducersTabSheets');}function z(ub,vb,wb){var xb=ub.mercury.tabContents.get(vb),yb=ub.tabGroup.tabs.get(vb);if(!yb||!xb)return ub;var zb=xb.openSheet;if(zb&&!c('MercurySheetPolicy').canReplaceOpenSheet(zb,wb))return ub;ub=ub.mergeIn(['mercury','tabContents',vb],{openSheet:wb});return ub;}function aa(ub,vb){switch(vb.type){case k.ADD_PARTICIPANTS:var wb=vb.tokens,xb=vb.tabID,yb=wb.length===1&&wb[0].getInfo().render_type===c('MercuryTypeaheadConstants').THREAD_TYPE;if(!yb)return z(ub,xb,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet);}return ub;}function ba(ub,vb){return ub;}function ca(ub,vb){switch(vb.type){case m.OPEN_APPOINTMENT_SHEET:var wb=vb.tabID;return z(ub,wb,c('MercurySheetPolicy').sheets.ChatAppointmentBanner);}return ub;}function da(ub,vb){switch(vb.type){case m.OPEN_USER_FOCUS_SHEET:var wb=vb.tabID;return z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserFocusSheet);}return ub;}function ea(ub,vb){switch(vb.type){case m.CLOSE_USER_FOCUS_AND_BYPASS_SHEET:var wb=vb.tabID;ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserFocusSheet);ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserFocusBypassSheet);}return ub;}function fa(ub,vb,wb){c('ChatUserFocusWarning').updateUserFocusWarning(wb,function(xb){xb?c('setImmediate')(function(){c('FantaTabSheetActions').openBypassFocusSheet(vb);}):c('setImmediate')(function(){c('FantaTabSheetActions').openUserFocusSheet(vb);});},function(){c('setImmediate')(function(){c('FantaTabSheetActions').closeUserFocusAndBypassSheet(vb);});});return ub;}function ga(ub,vb){switch(vb.type){case m.OPEN_BYPASS_FOCUS_SHEET:var wb=vb.tabID;return z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserFocusBypassSheet);}return ub;}function ha(ub,vb){switch(vb.type){case m.OPEN_USER_TIMEZONE_SHEET:var wb=vb.tabID,xb=vb.timezoneInfo;if(!ub.mercury.tabContents.get(wb))return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{timezoneInfo:xb});return z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserTimezoneSheet);}return ub;}function ia(ub,vb){switch(vb.type){case m.CLOSE_USER_TIMEZONE_SHEET:var wb=vb.tabID;if(!ub.mercury.tabContents.get(wb))return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{timezoneInfo:null});ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserTimezoneSheet);}return ub;}function ja(ub,vb,wb){c('ChatTimezoneWarning').updateUserTimezoneWarning(wb,function(xb){c('setImmediate')(function(){c('FantaTabSheetActions').openUserTimezoneSheet(vb,xb);});},function(){c('setImmediate')(function(){c('FantaTabSheetActions').closeUserTimezoneSheet(vb);});});return ub;}function ka(ub,vb,wb){c('ChatEmployeeAwayWarning').updateEmployeeAwayWarning(wb,function(){return c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeeAwaySheet(vb);});},c('emptyFunction'));return ub;}function la(ub,vb){switch(vb.type){case m.OPEN_EMPLOYEE_AWAY_SHEET:var wb=vb.tabID;ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatEmployeeAwaySheet);}return ub;}function ma(ub,vb,wb){c('ChatUserPersonalUserWarning').updateEmployeePersonalUserWarning(wb,function(xb,yb){c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeePersonalUserSheet(vb);});},c('emptyFunction'));return ub;}function na(ub,vb){switch(vb.type){case m.OPEN_EMPLOYEE_PERSONAL_USER_SHEET:var wb=vb.tabID;ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserIsPersonalUserSheet);}return ub;}function oa(ub,vb){switch(vb.type){case m.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:var wb=vb.tabID;ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserIsPersonalUserSheet);}return ub;}function pa(ub,vb){switch(vb.type){case m.OPEN_EMPLOYEE_WORK_USER_SHEET:var wb=vb.tabID;ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserIsWorkUserSheet);}return ub;}function qa(ub,vb){switch(vb.type){case m.CLOSE_EMPLOYEE_WORK_USER_SHEET:var wb=vb.tabID;ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserIsWorkUserSheet);}return ub;}function ra(ub,vb,wb){c('ChatUserWorkUserWarning').updateEmployeeWorkUserWarning(wb,function(xb,yb){c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeeWorkUserSheet(vb);});},c('emptyFunction'));return ub;}function sa(ub,vb){switch(vb.type){case m.OPEN_NAME_CONVERSATION_TAB_SHEET:return z(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return ub;}function ta(ub,vb){switch(vb.type){case m.CLOSE_NAME_CONVERSATION_TAB_SHEET:return o(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return ub;}function ua(ub,vb){return ub;}function va(ub,vb){switch(vb.type){case m.OPEN_READ_ONLY_PERMANENT_SHEET:return z(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return ub;}function wa(ub,vb){switch(vb.type){case m.CLOSE_READ_ONLY_PERMANENT_SHEET:return o(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return ub;}function xa(ub,vb){switch(vb.type){case m.OPEN_READ_ONLY_SHEET:return z(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return ub;}function ya(ub,vb){switch(vb.type){case m.CLOSE_READ_ONLY_SHEET:return o(ub,vb.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return ub;}function za(ub,vb){return ub;}function ab(ub,vb){return ub;}function bb(ub,vb){return ub;}function cb(ub,vb){switch(vb.type){case m.CLOSE_ADD_FRIENDS_SHEET:var wb=vb.tabID;if(!ub.mercury.tabContents.get(wb))return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{typeahead:null});return o(ub,wb,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet);}return ub;}function db(ub,vb){switch(vb.type){case m.OPEN_ADD_MORE_FRIENDS_SHEET:var wb=vb.tabID,xb=ub.mercury.tabContents.get(wb).thread;if(xb){ub=x(ub,wb,xb);return z(ub,vb.tabID,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet);}}return ub;}function eb(ub,vb){switch(vb.type){case m.CLOSE_ADD_MORE_FRIENDS_SHEET:var wb=vb.tabID;if(!ub.mercury.tabContents.get(wb))return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{typeahead:null});return o(ub,wb,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet);}return ub;}function fb(ub,vb){switch(vb.type){case l.SEND_GROUP_MESSAGE:var wb=vb.tabID||vb.threadID;return o(ub,wb,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet);}return ub;}function gb(ub,vb){switch(vb.type){case l.RECEIVED_NEW_MESSAGE:var wb=vb.tabID,xb=ub.mercury.tabContents.get(wb);if(xb&&!xb.isScrolledToBottom){ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}else ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}return ub;}function hb(ub,vb){switch(vb.type){case j.SCROLL_BOTTOM_CHANGED:var wb=vb.tabID,xb=vb.isScrolledToBottom;if(xb)ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);var yb=ub.mercury.tabContents.get(wb);if(yb&&yb.thread)ub=ob(ub,wb,yb.thread);}return ub;}function ib(ub,vb){switch(vb.type){case k.ON_PRIVACY_STATE_CHANGE:var wb=vb.threadID,xb=vb.privacyState;switch(xb){case c('ChatPrivacyActionController').OFFLINE:ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);break;case c('ChatPrivacyActionController').NORMAL:ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);break;case c('ChatPrivacyActionController').BLOCKED:ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);var yb=c('MercuryIDs').getUserIDFromThreadID(wb);if(yb){var zb=c('MercuryParticipants').getNow(c('MercuryIDs').getParticipantIDFromUserID(yb));zb&&zb.is_friend?ub=z(ub,wb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet):ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);}break;}}return ub;}function jb(ub,vb){switch(vb.type){case m.OPEN_PAGE_INDICATOR_SHEET:var wb=vb.tabID,xb=vb.description;if(xb&&ub.mercury.tabContents.get(wb)){ub=ub.mergeIn(['mercury','tabContents',wb],{pageIndicatorDescription:xb});return z(ub,wb,c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator);}}return ub;}function kb(ub,vb){switch(vb.type){case m.CLOSE_PAGE_INDICATOR_SHEET:var wb=vb.tabID;ub=o(ub,wb,c('MercurySheetPolicy').sheets.ChatPageResponsivenessIndicator);}return ub;}function lb(ub,vb){switch(vb.type){case m.ON_IS_PAGE_TAB:var wb=vb.tabID,xb=vb.pageIndicator,yb=ub.mercury.tabContents.get(wb);if(!yb)return ub;ub=ub.mergeIn(['mercury','tabContents',wb],{pageIndicator:xb});}return ub;}function mb(ub,vb,wb){ub=fa(ub,vb,wb);ub=ja(ub,vb,wb);ub=v(ub,vb,wb);ub=u(ub,vb,wb);ub=ka(ub,vb,wb);ub=ma(ub,vb,wb);ub=ra(ub,vb,wb);ub=pb(ub,vb,wb);ub=sb(ub,vb,wb);ub=ob(ub,vb,wb);ub=nb(ub,vb,wb);ub=tb(ub,vb,wb);return ub;}function nb(ub,vb,wb){var xb=wb.rtc_call_data,yb=wb.thread_fbid,zb=xb&&xb.call_state!=='NO_ONGOING_CALL'&&yb;if(zb){ub=z(ub,vb,c('MercurySheetPolicy').sheets.ChatJoinCallSheet);}else ub=o(ub,vb,c('MercurySheetPolicy').sheets.ChatJoinCallSheet);return ub;}function ob(ub,vb,wb){var xb=wb.has_montage&&c('MercuryConfig').MontageThreadViewer,yb=ub.mercury.tabContents.get(vb),zb=!!(yb&&yb.isScrolledToBottom);if(zb&&xb){ub=z(ub,vb,c('MercurySheetPolicy').sheets.ChatMontageSheet);}else ub=o(ub,vb,c('MercurySheetPolicy').sheets.ChatMontageSheet);return ub;}function pb(ub,vb,wb){if(wb.lightweight_event){c('ifRequired')('EventReminderStateStore',function(xb){c('ifRequired')('EventReminderActions',function(yb){var event=wb.lightweight_event;if(event){yb.updateEventReminder(vb,event);ub=z(ub,vb,c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet);}else{var zb=xb.getEvent(vb);if(zb&&zb.exists)yb.deleteEventReminder(vb);ub=o(ub,vb,c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet);}},function(){return qb(vb);});},function(){return qb(vb);});}else ub=o(ub,vb,c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet);return ub;}function qb(ub){c('Bootloader').loadModules(["EventReminderActions","EventReminderStateStore"],function(vb,wb){c('setImmediate')(function(){c('FantaTabSheetActions').onBootloadEventReminder(ub);});},'FantaReducersTabSheets');}function rb(ub,vb){switch(vb.type){case m.ON_BOOTLOAD_EVENT_REMINDER:var wb=vb.tabID,xb=ub.mercury.tabContents.get(wb);if(!xb)return ub;var yb=xb.thread;if(yb)ub=pb(ub,wb,yb);}return ub;}function sb(ub,vb,wb){var xb=wb.other_user_fbid;if(xb&&!c('FBID').isUser(xb)&&c('MercuryConfig').ShowAppointmentBanner){var yb=c('XNativeComponentFlowBookingRequestCountController').getURIBuilder().setFBID('page_id',xb).setFBID('user_id',c('CurrentUser').getID()).getURI();new (c('AsyncRequest'))().setURI(yb).setHandler(function(zb){var ac=zb&&zb.getPayload();if(ac&&ac.confirmed+ac.pending>0)c('FantaTabSheetActions').openAppointmentBannerSheet(vb);}).send();}else ub=o(ub,vb,c('MercurySheetPolicy').sheets.ChatAppointmentBanner);return ub;}function tb(ub,vb,wb){var xb=wb.associated_object;if(xb)ub=z(ub,vb,c('MercurySheetPolicy').sheets.ChatRoomAssociatedObjectSheet);return ub;}f.exports={addParticipants:aa,closeAddFriends:cb,closeAddMoreFriends:eb,closeAllTabs:p,closeEmployeePersonalUserSheet:oa,closeEmployeeWorkUserSheet:qa,closeFocusUserSheet:ea,closeNameConversationSheet:ta,closePageIndicatorSheet:kb,closePermanentReadOnlySheet:wa,closeReadOnlySheet:ya,closeTab:n,closeUserTimezoneSheet:ia,onBootloadEventReminder:rb,onBootloadTypeahead:w,onGetThreadResponse:q,onIsPageTab:lb,onPrivacyStateChange:ib,openAddFriendsSheet:ba,openAddMoreFriends:db,openAppointmentBannerSheet:ca,openBypassFocusSheet:ga,openEmployeeAwaySheet:la,openEmployeePersonalUserSheet:na,openEmployeeWorkUserSheet:pa,openFocusUserSheet:da,openNameConversationSheet:sa,openNewMessagesSheet:ua,openPageIndicatorSheet:jb,openPermanentReadOnlySheet:va,openReadOnlySheet:xa,openTab:t,openUploadWarningTabSheet:za,openUserFocusSheet:ab,openUserIsPersonalUserSheet:bb,openUserTimezoneSheet:ha,receivedNewMessage:gb,scrollBottomChanged:hb,sendGroupMessage:fb,threadsUpdated:s};}),null);
__d('FantaReducersTabs',['FantaConst','FantaMessageActions','FantaTabActions','FantaTypeAppState','FantaTypeTab','FantaTypeTabGroup','PinnedConversationNubsConfig','URI','isWebMessengerURI'],(function a(b,c,d,e,f,g){'use strict';var h=c('FantaMessageActions').Types,i=c('FantaTabActions').Types,j='tab_',k=1,l=1,m=1;function n(ja,ka){switch(ka.type){case i.OPEN_TAB:return u(ja,ka.tabID||j+m++,true);}return ja;}function o(ja,ka){switch(ka.type){case i.REPLACE_TAB:var la=ka.tabID,ma=ka.newTabID,na=ja.tabGroup,oa=na.tabs,pa=oa.get(la);if(pa){var qa=pa.id===ja.tabGroup.focusedTabID;ja=ja.setIn(['tabGroup','tabs',ma],pa.merge({id:ma,focusOnMountDEPRECATED:qa})).deleteIn(['tabGroup','tabs',la]);return u(ja,ma,qa,true);}return u(ja,ma);}return ja;}function p(ja,ka){switch(ka.type){case i.MINIMIZE_TAB:return v(ja,ka.tabID,true);}return ja;}function q(ja,ka){switch(ka.type){case i.UNMINIMIZE_TAB:ja=ja.mergeIn(['tabGroup','tabs',ka.tabID],{focusOnMountDEPRECATED:true});return v(ja,ka.tabID,false);}return ja;}function r(ja,ka){switch(ka.type){case i.FOCUS_TAB:var la=ka.tabID;return ba(ja,la);}return ja;}function s(ja,ka){switch(ka.type){case i.BLUR_TAB:return ca(ja,ka.tabID);}return ja;}function t(ja,ka){switch(ka.type){case h.RECEIVED_NEW_MESSAGE:var la=ka.tabID,ma=ja.tabGroup.tabs.get(la);if(!ma){var na=ja.tabGroup.focusedTabID;ja=u(ja,la,false);var oa=c('URI').getNextURI();if(c('isWebMessengerURI')(oa)){return ja=v(ja,la,true);}else if(na)return ba(ja,na);}}return ja;}function u(ja,ka,la,ma){var na=ja.tabGroup,oa=na.tabs,pa=oa.get(ka),qa=!!na.getRaisedandUnraisedTabs().raisedTabs.get(ka);if(!pa){pa=new (c('FantaTypeTab'))({id:ka,focusCounter:k,openCounter:l++,focusOnMountDEPRECATED:la});ja=ja.setIn(['tabGroup','tabs',ka],pa);}else if(pa.isMinimized&&la)ja=v(ja,ka,false);var ra=la&&ma||la&&!qa;ja=ja.mergeIn(['tabGroup','tabs',ka],{focusOnMountDEPRECATED:ra});if(la)return ba(ja,ka);return ja;}function v(ja,ka,la){var ma=ja.tabGroup,na=ma.tabs.get(ka);if(na)ja=ja.mergeIn(['tabGroup','tabs',ka],{isMinimized:la});return ja;}function w(ja,ka){switch(ka.type){case i.MINIMIZE_ALL_TABS:for(var la=ja.tabGroup.tabs.keys(),ma=Array.isArray(la),na=0,la=ma?la:la[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var oa;if(ma){if(na>=la.length)break;oa=la[na++];}else{na=la.next();if(na.done)break;oa=na.value;}var pa=oa;ja=v(ja,pa,true);}return ja;}return ja;}function x(ja,ka){switch(ka.type){case i.CLOSE_TAB:var la=ka.tabID;return y(ja,la);}return ja;}function y(ja,ka){ja=ca(ja,ka);return ja.deleteIn(['tabGroup','tabs',ka]);}function z(ja,ka){switch(ka.type){case i.CLOSE_ALL_TABS:ja=ca(ja,ja.tabGroup.focusedTabID);return ja.setIn(['tabGroup','tabs'],ja.tabGroup.tabs.clear());}return ja;}function aa(ja,ka){switch(ka.type){case i.CLOSE_AND_TAB_NEXT:ja=y(ja,ka.tabID);return ha(ja);}return ja;}function ba(ja,ka){var la=ja.tabGroup,ma=la.tabs.get(ka);if(ma)ja=ja.mergeIn(['tabGroup','tabs',ka],{focusCounter:k++});ja=ja.mergeIn(['tabGroup'],{focusedTabID:ka});return ja;}function ca(ja,ka){if(ja.tabGroup.focusedTabID===ka)return ja.mergeIn(['tabGroup'],{focusedTabID:null});return ja;}function da(ja,ka){switch(ka.type){case i.SET_ALLOWED_RAISED_TABS:return ea(ja,ka.allowedRaisedTabs);}return ja;}function ea(ja){var ka=arguments.length<=1||arguments[1]===undefined?c('FantaConst').DEFAULT_ALLOWED_RAISED_TABS:arguments[1];if(ka===ja.tabGroup.allowedRaisedTabs)return ja;if(!c('PinnedConversationNubsConfig').chatTabTypingPriority)ka=Math.max(1,ka);return ja.mergeIn(['tabGroup'],{allowedRaisedTabs:ka});}function fa(ja,ka){switch(ka.type){case i.LOAD_FROM_DATA:var la=ja.tabGroup,ma=ka.tabData;if(la.updatedTime>=ma.updatedTime||ma.updatedTime===undefined)return ja;ja=ea(ja.set('tabGroup',new (c('FantaTypeTabGroup'))()),la.allowedRaisedTabs);ma.tabs.sort(function(na,oa){return na.openCounter-oa.openCounter;}).forEach(function(na){ja=u(ja,na.id,false);if(na.isMinimized)ja=v(ja,na.id,na.isMinimized);});ma.tabs.sort(function(na,oa){return na.focusCounter-oa.focusCounter;}).forEach(function(na){ja=ba(ja,na.id,true);});ja=ma.focusedTabID?ba(ja,ma.focusedTabID,true):ca(ja);}return ja;}function ga(ja,ka){switch(ka.type){case i.FOCUS_NEXT_TAB:return ha(ja,ka.event);}return ja;}function ha(ja,event){var ka=ja.tabGroup.focusedTabID,la=ja.tabGroup.getRaisedandUnraisedTabs(),ma=la.raisedTabs,na=ma.count();if(na===0){return ja;}else if(ma.count()===1)return ba(ja,ma.first().id);if(event)event.preventDefault();var oa=ma.skipUntil(function(pa){return pa.id===ka;}).rest();if(oa.count()===0){return ba(ja,ma.first().id);}else return ba(ja,oa.first().id);}function ia(ja,ka){switch(ka.type){case i.FOCUS_PREVIOUS_TAB:var la=ja.tabGroup.focusedTabID,ma=ja.tabGroup.getRaisedandUnraisedTabs(),na=ma.raisedTabs;if(na.count()<2)return ja;var event=ka.event;if(event)event.preventDefault();var oa=na.reverse().skipUntil(function(pa){return pa.id===la;}).rest();if(oa.count()===0){return ba(ja,na.last().id);}else return ba(ja,oa.first().id);}return ja;}f.exports={blurTab:s,closeAllTabs:z,closeAndTabNext:aa,closeTab:x,focusNextTab:ga,focusPreviousTab:ia,focusTab:r,loadFromData:fa,minimizAllTabs:w,minimizeTab:p,openTab:n,receivedNewMessage:t,replaceTab:o,setAllowedRaisedTabs:da,unminimizeTab:q};}),null);
__d('FantaAppStore',['FantaDispatcher','FantaReducersCookie','FantaReducersDockCalculator','FantaReducersMercury','FantaReducersMessages','FantaReducersTabs','FantaReducersTabSheets','FantaTypeAppState','FluxReduceStore'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=[].concat(Object.values(c('FantaReducersTabs')),Object.values(c('FantaReducersMercury')),Object.values(c('FantaReducersMessages')),Object.values(c('FantaReducersTabSheets')),Object.values(c('FantaReducersDockCalculator')),Object.values(c('FantaReducersCookie')));h=babelHelpers.inherits(k,c('FluxReduceStore'));i=h&&h.prototype;k.prototype.getInitialState=function(){return new (c('FantaTypeAppState'))();};k.prototype.ignoreReducer=function(l){var m=Object.values(l);j=j.filter(function(n){return !m.find(function(o){return o===n;});});};k.prototype.addReducers=function(l){this.ignoreReducer(l);j=j.concat(Object.values(l));};k.prototype.reduce=function(l,m){return j.reduce(function(n,o){return o(n,m);},l);};function k(){h.apply(this,arguments);}f.exports=new k(c('FantaDispatcher'));}),null);
__d('FantaMercuryTabBody.react',['Bootloader','FantaTabActions','FantaTypeTab','FantaTypeTabContents','React','ReactDOM','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.componentDidMount=function(){var k=this.props,l=k.isLastTab,m=k.tab,n=k.tabContent,o='',p=n&&n.signatureID,q=c('ReactDOM').findDOMNode(this.refs.root),r=m.id,s=m.focusOnMountDEPRECATED;c('Bootloader').loadModules(["ChatTabView"],function(t){this.$FantaMercuryTabBody1=new t(r,o,p,q,null,l);this.$FantaMercuryTabBody1.setVisibleState(true,!m.isMinimized);c('setImmediate')(function(){c('FantaTabActions').registerTabFocusDeprecated(r,function(){return this.$FantaMercuryTabBody1.focusTab();}.bind(this),function(){return this.$FantaMercuryTabBody1.blurTab();}.bind(this),s);}.bind(this));}.bind(this),'FantaMercuryTabBody.react');};j.prototype.componentWillReceiveProps=function(k){var l=k.isLastTab;if(this.$FantaMercuryTabBody1)this.$FantaMercuryTabBody1.updateIsLastTab(l);};j.prototype.render=function(){return c('React').createElement('div',{ref:'root'});};j.prototype.componentWillUnmount=function(){if(this.$FantaMercuryTabBody1)this.$FantaMercuryTabBody1.destroy();};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('FantaMercuryTabOverflowBootloader.react',['BootloadOnRender.react','FantaTypeTab','immutable','JSResource','LazyComponent.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.render=function(){return (c('React').createElement(c('BootloadOnRender.react'),{component:c('React').createElement(c('LazyComponent.react'),{items:this.props.items}),loader:c('JSResource')('FantaMercuryTabOverflow.react').__setRef('FantaMercuryTabOverflowBootloader.react'),placeholder:c('React').createElement('div',null)}));};function j(){h.apply(this,arguments);}f.exports=j;}),null);
__d('FantaTab.react',['cx','FantaTypeTab','FantaTypeTabContents','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){var l=this.props,m=l.MainComponent,n=l.MinimizedComponent,o=l.isFocused,p=l.isLastTab,q=l.isLastTabOfType,r=l.tab,s=l.tabContent,t=r.isMinimized?n:m,u=r.id+(r.isMinimized?'-minimized':'-maximized');return (c('React').createElement('div',{className:"_5qi9"+(' '+"_5qib")+(this.props.isFocused?' '+"_5qic":'')+(r.isMinimized?' '+"_3001":'')},c('React').createElement(t,{key:u,tab:r,tabContent:s,isFocused:o,isLastTab:p,isLastTabOfType:q})));};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('FantaTabGroup.react',['cx','FantaTab.react','FantaTypeTab','FantaTypeTabContents','FantaTypeTabGroup','immutable','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=c('immutable').OrderedMap,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.shouldComponentUpdate=function(n){return !this.props.tabGroup.equals(n.tabGroup)||!!(!this.props.tabContents&&n.tabContents)||!!(this.props.tabContents&&n.tabContents&&!this.props.tabContents.equals(n.tabContents));};m.prototype.render=function(){var n=this.props,o=n.isLastOfTypeChecker,p=n.MainComponent,q=n.MinimizedComponent,r=n.OverflowComponent,s=n.tabContents,t=n.tabGroup,u=t.focusedTabID,v=t.getRaisedandUnraisedTabs(),w=v.raisedTabs,x=v.unraisedTabs,y=void 0;if(o)y=w.findLastKey(function(aa){return o(aa)&&aa.id;});var z=t.allowedRaisedTabs===0?null:this.$FantaTabGroup1(x,r);return (c('React').createElement('div',{className:"_59v1"},z,w.map(function(aa){return (c('React').createElement(c('FantaTab.react'),{key:aa.id,tab:aa,isFocused:aa.id===u,isLastTab:aa===w.last(),isLastTabOfType:aa.id===y,MainComponent:p,MinimizedComponent:q,tabContent:s&&s.get(aa.id)}));}).toArray()));};m.prototype.$FantaTabGroup1=function(n,o){if(!n.isEmpty())return (c('React').createElement('div',{className:"_1kws"},c('React').createElement(o,{items:n})));return null;};function m(){i.apply(this,arguments);}m.propTypes={MainComponent:l.func.isRequired,MinimizedComponent:l.func.isRequired,OverflowComponent:l.func.isRequired,tabContents:l.object,tabGroup:l.object.isRequired};f.exports=m;}),null);
__d('FantaMercuryTabs.react',['FantaAppStore','FantaCookieUtil','FantaMercuryTabBody.react','FantaMercuryTabOverflowBootloader.react','FantaTabActions','FantaTabGroup.react','FantaTypeTabContents','FantaTypeTabGroup','FluxContainer','PresenceState','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.getStores=function(){return [c('FantaAppStore')];};j.calculateState=function(){return {tabContents:c('FantaAppStore').getState().mercury.tabContents,tabGroup:c('FantaAppStore').getState().tabGroup};};j.prototype.componentWillMount=function(){if(this.props.loadDataOnMount)c('FantaTabActions').loadFromData(c('FantaCookieUtil').convertCookieData(c('PresenceState').get()));};j.prototype.render=function(){return (c('React').createElement(c('FantaTabGroup.react'),{MainComponent:c('FantaMercuryTabBody.react'),MinimizedComponent:c('FantaMercuryTabBody.react'),OverflowComponent:c('FantaMercuryTabOverflowBootloader.react'),tabContents:this.state.tabContents,tabGroup:this.state.tabGroup}));};function j(){h.apply(this,arguments);}f.exports=c('FluxContainer').create(j);}),null);
__d('FantaTabsApp',['ChatPerfInstrumentation','FantaMercuryTabs.react','FantaTabsAppBase','React','ReactDOM'],(function a(b,c,d,e,f,g){'use strict';var h,i,j=void 0;h=babelHelpers.inherits(k,c('FantaTabsAppBase'));i=h&&h.prototype;k.prototype.initializeFantaData=function(l){e(['FantaAppStore','FantaCookieUtil','FantaGetMessageActions','FantaTabActions','MercuryDispatcher','MercuryServerPayloadPreprocessor','PresenceState'],function(m,n,o,p,q,r,s){p.loadFromData(n.convertCookieData(s.get()));s.registerStateLoader(function(t){return p.loadFromData(n.convertCookieData(t,m.getState().tabGroup));});s.registerStateStorer(function(t){var u=m.getState().tabGroup;if(!j||j&&!j.equals(u)){j=u;return n.createCookieData(u,t);}else return t;});m.addListener(function(){return s.doSync();});r.get().handleUpdate(l);c('ChatPerfInstrumentation').logInitData();});};k.prototype.initializeFantaUI=function(){e(['FantaAppStore','FantaMercuryThreadEventsBootloaded','FantaMessageActions','FantaTabActions','FantaTabViewportManager','FBRTCMessageHandler','MercuryBrowserAlerts'],function(l,m,n,o,p,q,r){q.init();r.init();c('ReactDOM').render(this.getViewComponent(),this.tabsElem);m.onMessagesReceived(function(t,u){n.receivedNewMessage(t,u);});p.init(this.tabsElem);c('ChatPerfInstrumentation').logInitUI();var s=l.getState().tabGroup.tabs;if(s.toArray().length===0)c('ChatPerfInstrumentation').logDisplayDone();}.bind(this));};k.prototype.getViewComponent=function(){return c('React').createElement(c('FantaMercuryTabs.react'),{loadDataOnMount:false});};function k(){h.apply(this,arguments);}f.exports=new k();}),null);